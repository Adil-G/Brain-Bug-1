Testing for threshold effects
in regression models
Sokbae Lee
Myung Hwan Seo
DEMO Shin
The Institute for Fiscal Studies
Department of Economics, UCL
cemmap DEMO paper CWP36/10
TESTING FOR THRESHOLD EFFECTS IN REGRESSION MODELS
SOKBAE LEE, MYUNG HWAN SEO, AND YOUNGKI SHIN
Abstract. In this article, we develop a general DEMO for testing threshold eﬀects in
regression models, using sup-likelihood-ratio (LR)-type statistics. Although the sup-LR-
type test statistic has been considered in the DEMO, our method for establishing the
asymptotic null distribution is new and DEMO The standard approach in the lit-
erature for obtaining the asymptotic null distribution requires that there exist a certain
quadratic approximation to the objective DEMO The article provides an alternative,
novel method that can be used to establish the asymptotic null distribution, even when
the usual quadratic approximation is intractable. We illustrate the usefulness of our ap-
proach in the DEMO of the maximum score estimation, maximum likelihood estimation,
quantile regression, and maximum rank correlation estimation. We establish consistency
and local power properties DEMO the test. We provide some simulation results and also an
empirical application to tipping in racial segregation. This article has supplementary ma-
terials online.
DEMO words. Davies problem, empirical process, maximum score estimation, maximum
rank DEMO estimation, U-process, threshold model.
AMS Subject Classification. 62F03, 62F05.
Date: 17 November 2010.
We would like to thank Jesse Rothstein for providing DEMO data used in the article and also thank two referees
and an associate editor for their helpful comments. Lee thanks the Economic and Social DEMO Council
for the ESRC Centre for Microdata Methods and Practice (RES-589-28-0001) and the European Research
Council for the research grant (ERC-2009-StG-240910-ROMETA). Shin thanks the Social Sciences and
Humanities Research Council of Canada (410-2010-0345) DEMO the research grant.
1
2
LEE, SEO, AND SHIN
1. Introduction
This article develops general DEMO for threshold eﬀects in a variety of regression models,
including mean, median and quantile regression, binary response, censored or truncated
regression, DEMO proportional hazards models as special cases. To illustrate our testing
problem, DEMO a binary regression model as an example. In this model, an DEMO
binary outcome Y is modeled typically as Y = 1(Y
∗
≥ 0), where 1(A) denotes the indicator
function, i.e., 1(A) = 1 if A is true and zero otherwise, DEMO Y
∗
is a latent continuous variable
that determines the binary outcome Y (see e.g. Manski, 1988). Suppose that Y
∗
has DEMO
following form:
(1.1)
(1.2)
Y
∗
= g (W,θ0 ,γ0 ) + U,
g (w,θ,γ) = x0 β + z0 α1 {t > γ} ,
where DEMO is a vector of regressors that consist of distinct elements of (DEMO, Z,T ), U is an
unobserved random variable, and DEMO
:= (β 0 ,α0 )0
0 0
and γ0 are unknown true parameter values
and belong to Θ := B × A and Γ, respectively, which are subsets of ﬁnite-dimensional
Euclidean spaces. Without DEMO of generality, assume that the vector Z is a subset of DEMO
such that Z = R0 X for some known matrix R and that T might be an element of X. The
random variable T DEMO the threshold variable and γ0 is the unknown threshold parameter.
Note that we specify the threshold eﬀect as a change-point due to an unknown DEMO
in a particular covariate.
Threshold models have a large number of applications in empirical research. In econom-
ics and sociology, racial segregation can be modeled as a threshold eﬀect. For example,
Card et al. (2008) recently investigated the existence of race-based tipping in neighbor-
hoods using U.S. Census data. In their setup, the hypothesis of interest is whether there
exist discontinuities in the dynamics of neighborhood racial composition: once the minor-
ity share in a neighborhood exceeds a threshold level (“tipping point”), most of the whites
would leave the neighborhood. In a simple model DEMO by Card et al. (2008), whites’
TESTING FOR THRESHOLD EFFECTS 3
willingness to pay for homes depends on DEMO neighborhood minority share. In their model,
the location of the tipping point can vary depending on whites’ preferences, thereby im-
plying that the location of the tipping point is unknown. In Section 4, we illustrate our
methodology by applying it to the data used by Card et DEMO (2008).
There are more examples of threshold models. In economics, Durlauf and Johnson (1995)
argue that cross-country growth models with multiple equilibria can exhibit threshold ef-
fects. In addition, Khan and Senhadji (DEMO) examine the existence of threshold eﬀects
in the relationship between inﬂation DEMO growth. In empirical ﬁnance, Pesaran and Pick
(2007) argue that DEMO eﬀect of ﬁnancial contagion (see, e.g. Forbes and Rigobon, 2002)DEMO
can be described as a discontinuous threshold eﬀect, hence testing for DEMO eﬀects
implies testing for the presence of ﬁnancial contagion. In biostatistics, DEMO mod-
els are typically speciﬁed with some unknown threshold parameters (see, e.g. Cox, 1987;
Schwartz et al., 1995). In epidemiology, logistic regressions with unknown change-points
are used to model the relationship between DEMO continuous exposure variable and disease
risk (see Pastor and Guallar, 1998; Pastor-Barriuso et al., 2003).
We consider a test of no DEMO eﬀect against the presence of threshold eﬀects. That
is, the null DEMO alternative hypotheses are that
H0 : α0 = 0 for any γ0 ∈ Γ vs. H1 : α0 = 0 for some γ0 ∈ DEMO
In general, unknown parameters in (1.2) are identiﬁable under the DEMO hypothesis;
however, the threshold parameter γ0 is not identiﬁed under DEMO null hypothesis. This feature
that the threshold parameter is not identiﬁed under the null hypothesis is an example of
the so-called “Davies problem” (see Davies, 1977, 1987).
As common in the literature (see, DEMO, Andrews and Ploberger, 1995; Hansen, 1996;
Andrews, 2001), we develop our tests following Roy’s union-intersection principle (Roy,
1953) to deal with the Davies problem. Speciﬁcally, in our setup, we DEMO that there
exist an objective function and a corresponding extreme estimator for the null hypothesis
4
LEE, SEO, AND SHIN
of no threshold model and those DEMO the alternative hypothesis of a threshold model. Then
our test statistic is based on the diﬀerence between the maximum values of the objective
functions DEMO the null and alternative hypotheses. This test statistic can be viewed as a
sup-likelihood-ratio (LR)-type statistics.
The main objective of this article is to provide a general testing framework in regression
models using the sup-LR-type DEMO under weak conditions. Most of the prior literature
has focused mainly on applications in time series analysis (see, e.g., Tong, 1990; Chan, 1993;
Andrews and Ploberger, 1994; Hansen, 1996; Cho and White, 2007). More recently, thresh-
old models have been considered DEMO nonparametric models (e.g. Delgado and Hidalgo,
2000), for panel DEMO models (e.g. Hansen, 1999), for transformation models (e.g. Pons,DEMO
2003; Kosorok and Song, 2007), and for binary response models (e.g. Lee and Seo, 2008),
among others.
In this article, we focus on cross-sectional applications and aim to provide a unifying test-
ing framework that includes objective functions that are suﬃciently diﬀerent from standard
DEMO functions. For example, we consider an objective function for the maximum
DEMO estimator (Manski, 1975, 1985), and also consider an objective DEMO based on
U-processes such as the maximum rank correlation estimator (Han, 1987). To our best
knowledge, we are the ﬁrst to propose tests for threshold eﬀects that can include maximum
score and maximum rank DEMO estimators as special cases.
1.1. Related Literature. Although the sup-LR-type test statistic is well known in the
literature, our method for establishing the asymptotic null distribution is new and nonstan-
dard. The standard approach in the DEMO for obtaining the asymptotic null distribution
requires that there exist a certain quadratic approximation to the objective function (see,
e.g., Andrews, 2001; Liu and Shao, 2003; Zhu and Zhang, 2006; Song et al., 2009). For ex-
ample, Andrews (2001) assumes that DEMO objective function has a quadratic expansion in
identiﬁable parameters for each value of a nuisance parameter that is unidentiﬁed under the
null hypothesis. In DEMO article, we provide an alternative, novel method that can be used
TESTING FOR THRESHOLD EFFECTS 5
to establish the asymptotic null distribution, even when the usual quadratic approximation
such as one in Andrews (2001) DEMO intractable (see Section 3 for details). For example, no
existing method can be applied to the objective function for the maximum score DEMO
However, it is worth noting that when quadratic approximations are available, Andrews
(2001) covers a more general case such as one where DEMO vectors may lie on the
boundary of the parameter space under the null hypothesis.
In the literature, there exist articles that establish asymptotic distributions for likelihood
ratio types of statistics, without requiring usual asymptotic quadratic approximations. For
example, Fan et al. (2000) establish that Wilks results hold as long as likelihood contour
sets are fan-shaped. As a result, they show that the likelihood ratio statistics can still be
asymptotically chi-squared, even if the maximum likelihood estimator is not asymptoti-
cally normal. In addition, Zhang and Li (1993) develop an empirical process approach to
deriving DEMO asymptotic null distribution of the sup-LR-type statistics without requiring
the usual quadratic approximation to the likelihood function, using the general result in
Zhang and Cheng (1989). Their approach is closely related to ours in that it employs the
empirical process method; however, their method is diﬀerent DEMO ours in the sense that
they focus on the case when the objective function is a likelihood function and when the
class of likelihood DEMO is assumed to be H¨older continuous in parameters. Again, nei-
ther DEMO et al. (2000) nor Zhang and Li (1993) can include our maximum score estimator
example as a special case.
1.2. Structure of DEMO Paper. The remainder of the article is as follows. In Section 2,
we provide an informal description of our test statistic and a DEMO of examples. Section
3 provides an informal overview of our method for obtaining the asymptotic null distribu-
tion. Section 4 illustrates the usefulness of DEMO test by applying it to real data used by
Card et al. (2008). Formal results are given in Section 5 and they are illustrated in Section
6. A summary of Monte Carlo simulation results are DEMO brieﬂy in Section D. In
Section 8, we provide some concluding DEMO All the proofs, some additional theoretical
6
LEE, SEO, AND SHIN
results, and details of Monte Carlo experiments are contained in the online supplementary
materials.
2. The Test Statistic
DEMO section describes our test statistic. To develop a general testing framework without
being tied down to a particular statistical model, we suppose that under the null hypothesis,
the remaining unknown parameters in (1.2) can DEMO estimated by optimizing a particular
objective function and also that under the alternative hypothesis, all unknown parame-
ters including α0 can be estimated by optimizing a suitable objective function. In other
words, we develop our test statistic based on the distance between optimized restricted and
unrestricted objective function DEMO
To be more speciﬁc, let Qn : Θ ⊗ Γ 7→ DEMO denote an objective function of interest based on
a random sample {(Yi , Wi ) : i = 1,...,n}. For a DEMO γ ∈ Γ, let
θˆ
(γ) denote an estimator
of DEMO that maximizes the objective function Qn (θ,γ). Deﬁne Qn (γ) := Qn 
θˆ
(γ) ,γ to be
a proﬁled objective function and let
In addition, let
γˆ
β˜
= argmax Qn (θ,γ) and
β :α=0
Q˜
= argmax Qn (DEMO) ,
n = max Qn (θ,γ) .
β :DEMO
γ
Recall that Qn does not depend on γ when α = 0. That is,
Q˜
n
is the maximum value of
the DEMO function under the null hypothesis and
Qˆ
n
is the maximum value without
imposing the null hypothesis.
Our test statistic is based on the DEMO between
Qˆ
n
and
Q˜
n , analogous to the likeli-
hood ratio (LR) statistic. Deﬁne the quasi-LR (QLR) statistic by
QLRn
DEMO r 2
n

Qˆ
n −
Q˜
n
,
θˆ
=
θˆ(ˆγ
) , and
Qˆ
n = Qn
(ˆγ
) .
TESTING FOR THRESHOLD EFFECTS 7
where rn is a rate of convergence DEMO probability of
θˆ
(γ) for a given γ. Let
for each γ, and note that
QLRn (γ) =
r 2
n
hQn (γ) −
Q˜
n
i
QLRn = sup QLRn (γ) DEMO
γ ∈Γ
Thus, the statistic QLRn can be viewed as a DEMO LR-type statistic. This statistic is rel-
atively easier to implement and analyze than some alternative statistics, e.g. a sup Wald
test statistic because it would not be straightforward to studentize the latter and to show
the DEMO tightness of ˆα
(γ) in some cases, e.g. in the DEMO score estimation for
binary response models. Also, we expect that the DEMO statistic would
have better ﬁnite sample performance as it is more immune to local maxima problems.
We consider two types of Qn (θ,γ): the ﬁrst type is a sample mean statistic and the
second DEMO is a U-statistic. For the ﬁrst case, the objective function has DEMO form
(2.1)
Qn (θ,γ) = 1
n
n
DEMO
=1
q (Yi , Wi ; θ,γ) ,
where DEMO is a known function up to parameters θ and γ. For example, the maximum score
estimator maximizes Qn (θ,γ) with
i
q (y, w; θ,γ) = (2y − 1) 1 DEMO (w,θ,γ) ≥ 0} .
In this example, the DEMO of convergence is rn = n1/3 . For the second case, the objective
function has the form
(2.2)
2
Qn (θ,γ) = n(n − 1)
1≤
X
≤n
χ (DEMO , Wi ,Yj , Wj ; θ,γ) ,
i<DEMO
where χ is again a known function up to parameters, and DEMO symmetric in the sense that
χ (yi, wi ,yj , DEMO ; θ,γ) = χ (yj , wj ,yi, wi ; θ,γ) . For example, the maximum rank correlation
8
LEE, SEO, AND SHIN
estimator maximizes Qn (θ,γ) DEMO
χ (y1 , w1 ,y2 , w2 ; θ,γ) DEMO 1 {y1 > y2 } 1 {g (w1 ,θ,γ) > g (w2 ,θ,γ)}
+ 1 {y1 < y2 } 1 {g (w1 ,θ,γ) < g (w2 ,θ,γ)} .
In this example, rn = n1/2 . In both cases, we assume that q or χ depends on (θ,γ) only
through the regression function g.
Additional examples include the maximum likelihood DEMO of the probit (or logit)
model, the quantile regression estimator (see Koenker, 2005, for the comprehensive treat-
ment of the methodology), and the partial maximum likelihood estimator of the propor-
tional hazard DEMO (see Cox, 1972, 1975) in the ﬁrst class, and DEMO rank correlation
based estimators such as the monotone rank estimator (Cavanagh DEMO Sherman, 1998) and
the pairwise rank estimator (Abrevaya, 1999) DEMO the second class.
3. Informal Overview of the Results
This section provides an informal overview of our method for obtaining the asymptotic
null distribution. DEMO results are given in Section 5. The main idea is to represent
our test as a continuous functional of an empirical process for a DEMO transformation of
objective functions of interest without referring to the estimators under the null and alter-
native hypotheses. Therefore, our method for obtaining the asymptotic null distribution
does not require an expansion of the objective functions, and can be used even in cases
when the usual quadratic approximation DEMO unavailable or diﬃcult to obtain. In general, the
asymptotic null distribution DEMO not pivotal; however, a method for computing asymptotic
p-values is illustrated with a couple of examples (subsampling is another option).
In what follows, we use the conventional notation in empirical process theory. Denote
by P the common probability measure, by Pn the empirical measure of the random sample
of size n from P, and by Gn the empirical process indexed by a class F of functions q such
that Gn DEMO = √n (Pn − P) q.
TESTING FOR THRESHOLD EFFECTS 9
To provide the main idea behind our DEMO, we focus on M-estimation, that is the
objective function has the form (2.1). Deﬁne
mξ,γ = qθ,γ −
q˜
b ,
where ξ = (θ 0 ,b0 )0 , qθ,DEMO = q (y, w; θ,γ) ,
and ˜q
DEMO = q(b0 ,0)0 ,γ
. Note that ˜q
b
is the same for any
γ and thus it is a function DEMO b only. We have introduced the index b to denote arguments
for β0 in the objective function with the restriction α = 0 to DEMO this from the index
β that denotes arguments for β0 in the unrestricted objective function.
Also, note that qθ,γ is the same for all γ if θ = θ0 , using the fact that α0 DEMO 0 under H0 .
Thus, under H0 , qθ0 ,γ
= ˜q
β0, and when b is restricted to β0 ,
mξ,DEMO = qθ,γ − qθ0 ,γ .
Similarly, when θ is ﬁxed at θ0 ,
mξ,γ = qθ0 ,γ −
q˜
DEMO .
It now follows that
(3.1)
QLRn
= r 2
DEMO
= r 2
n
sup Pn qθ,γ − sup Pn 
 sup (−Pn mξ,γ ) ,
θ,γ
b
sup
Pn mξ,γ −
ξ,γ :b=β0
q˜
b
ξ,γ :DEMO =θ0
2
which is a continuous transformation of rn Pn mξ,γ .
Note that since ξ := (θ 0 ,b0 ), DEMO is still a free parameter after ﬁxing θ at θ0 and also θ is
still a free parameter after ﬁxing b = β0 . DEMO is, we treat θ and b separate parameters.
The reason why DEMO,γ is deﬁned in this way is to write the QLR test as a continuous
transformation of an empirical process for mξ,γ . DEMO also that mξ0 ,γ = 0 for any γ, where
2 P
ξ0 = (θ00 ,β00 )0 . Then the convergence of rn n mξ,γ can be derived using the empirical process
10
theory through the decomposition
LEE, SEO, AND SHIN
(3.2)
r 2
n Pn mξ,γ
=
r 2
n
√nGn mξ,DEMO
+ r 2
n Pmξ,γ
.
Since the supremum is obtained at θ =
θˆ
(γ) for each γ and at b DEMO
β,˜
respectively, with
the convergence rate rn , we examine DEMO rescaled version of the process in (3.2) to obtain the
asymptotic null distribution.
3.1. Example 1: Probit. We use the probit model as our ﬁrst illustrative example. Deﬁne
Wγ := (X0 , Z0 1{T > γ})0 . The function q(y, w; θ,γ) DEMO the probit model has the form
(3.3)
q (y, DEMO; θ,γ) = y log Φ (g (w,θ,γ)) + (1 − y) log Φ (−g (w,θ,DEMO)) ,
where Φ (·) is the cumulative distribution function (CDF) of the standard normal distri-
bution and g (W,θ,DEMO) = W 0 θ. It will be shown formally in Section DEMO that the limiting
γ
distribution of the test statistic is the supremum of a chi-square process indexed by γ as
in (5.10) . DEMO φ(·) denote the probability density function of the standard normal DEMO
bution. Let e = (2Y − 1) φ (X0 β0 )/Φ ((2Y − 1) X0 β0 ) and V (γ) = E −e2 Wγ
let G denote a Gaussian process with the covariance kernel
W 0
γ
. Also,
K (γ1 ,γ2 ) = E e2 Wγ1
W 0
γ2
 .
Then, the DEMO distribution of the QLRn test becomes
(3.4)
1
2 sup DEMO (γ)0 V (γ)−1 G (γ)
γ
0
DEMO G1
V −1 G1  ,
β
where
G1
and Vβ DEMO the ﬁrst kβ elements of G and the ﬁrst kβ × kβ block of V (γ),
respectively. Here, kβ denotes the dimension of β.
Note that we cannot tabulate the critical values due to DEMO nonstandard asymptotic
distribution and need a simulation method to conduct the testing procedure. For example,
we can adopt the p-value transformation method as DEMO Hansen (1996). The basic idea is to
approximate the asymptotic DEMO by simulating the Gaussian process, which is the
TESTING FOR THRESHOLD EFFECTS 11
empirical process of the score function in DEMO case. For each i = 1,...,n, let
rθ
rb
DEMO
i = Wγ,i (2Yi
φ(W 0
γ,i
θˆ(DEMO
γ))
− 1)Φ[(2Yi −
φ(X0
i
β˜)DEMO
1)W 0
γ,i
Φ[(2Yi − 1)X
0
i
,
β˜]
θˆ(
γ)]
Xi (2Yi − 1)
,
q˜
i =
0
where Wγ,i := (Xi,
DEMO 1{Ti > γ})0 . We now carry out the following steps to simulate the
i
p-value.
i
b
3.2. Example 2: Quantile Regression. We now consider the quantile regression model.
The function q(y, w; θ,γ) for the quantile regression model has the form
(3.5)
q(y, w; θ,γ) = −ρτ [y − g(w,θ,γ)] ,
where ρτ (u) := u(DEMO − 1(u < 0)) is the ‘check’ function and
g (W,θ,γ) = W 0 θ. As in the
γ
DEMO model, it will be shown formally in Section 6 that the DEMO null distribution of
(1) to generate i.i.d. N (0, 1) random variables
n
{vij }i=1
large J;
for j = 1,...,J for a suﬃciently
(2) to simulate unrestricted and restricted DEMO functions, respectively:
Gj
n,θ (γ) =
1
n
DEMO X
=1
rθ qi (γ) vij and
Gj
n,b =
n
√n X
=1
i
rb qi vij ;
e
1
(DEMO) to simulate test statistics {D
J
using the simulated score functions DEMO and
j
n
}j =1
the sample analogue of the asymptotic distribution in (3.4):
j
Dn
where b
pn = (1/J) P
J
j =1
1
J
−1
θ,γ
= sup 1
γ 2 hG
j
n,θ
= (1/n) P
b
DEMO
j
n
n
i=1
(γ)0 b
b
o.
b
n
DEMO Gj
θ,γ n,θ (γ)
j 0
− Gn,DEMO
b
= (1/n) P
−1 Gj
b n,b
i
n
i=1 rb qi rb 0 , respec-
)0 and I
b
−1
b
I
qi
tively;
(4) to set
b
I
DEMO qi (γ) rθ qi (γ
> D
e e
I
12
LEE, SEO, AND SHIN
the QLR statistic is characterized by
DEMO
(3.6) 2 sup G (γ)0 V (γ)−1 G (γ)
γ
0
− G1
V −1 G1  ,
DEMO
where G is a mean-zero Gaussian process with covariance kernel
(3.7)DEMO
K (γ1 ,γ2 ) = τ(1 − τ)EWγ1
W 0 ,
γ2
V (γ) is a matrix such that V (γ) = E Wγ
W 0
γ fY |W
(X0 β0 |W) , and G1 and V1 denote the
ﬁrst k1 elements DEMO G and the ﬁrst kβ × k block of V (γ), respectively. As before, kβ denotes
β
the dimension of β. Now DEMO p-values can be simulated in the following way:
n
(1) to generate i.i.d. Unif [0, 1] random variables {uij }i=1
large J;
(2) to simulate the following functions, respectively:
for j = 1,...,J for a suﬃciently
n
√n X
=1
Wγ,DEMO [τ − 1(uij ≤ τ)] and
G˜
j
n
n
= √n X
=1
Xi [τ − 1(uij ≤ τ)];DEMO
1
where
1
Dj
n
J
{Dj }j =1
by:
n
= sup 1
γ 2 hG
j
n
(γ)0 b(γ
V
)−1 Gj (γ)
n
(3) to simulate test DEMO
−
Gj (γ) =
n
i
G˜
j 0
n
e
−1
G˜
j
n
i
V
(3.8)
b(γ) =
DEMO
= (1/J) P
1 n
nhn X
=1
n
0
Wγ,i Wγ,i
i
1
= nhn X
=1
Xi
X0 DEMO
i
i
J
j =1
1 nD
j
n > D
b
n
o.
K
Yi − X
0
i
β˜
hn
Yi − DEMO
hn
0
i
β˜
! ;
!, and
V
V
(DEMO) to set
J
pn
b
In step (3), K is a kernel function and hn is a bandwidth. Recall that
β˜
is DEMO estimator
i
of β0 under the null. When the regression error is independent of the regressors, then we
can estimate
(3.9)
b(γ(γ) and) = "e1
DEMO
e
V by
n
X
=1
n
1
= "n
n
DEMO
=1
i
0
Xi Xi
# × "
# × "
0
Wγ,i Wγ,i
1
nhn
1
nhn
n
X
=1
DEMO
n
X
=1
K
i
K
Yi − X
hn
0
i
β˜
Yi − X
hn
0
i
β˜
!#.
!#, and
4. Application: Tipping in Segregation
V
V
V
i
TESTING FOR THRESHOLD EFFECTS 13
We apply the proposed testing procedure to check whether there exists DEMO tipping point
for segregation. Using U.S. Census tract-level data, Card et DEMO (2008) recently showed
that the neighborhood’s white population decreases substantially when the minority share
in the area exceeds a tipping point (or threshold point).
In this application, we use a subsample of the dataset originally used by Card et al.
(2008). Among three diﬀerent base years, we choose a sample of which base year is 1980.
Next we pick four major cities and tested if there is a tipping DEMO To illustrate our
testing procedure, we ﬁrst consider the probit model. DEMO suppose that data {(Yi , Xi,Ti ) :
i DEMO 1,...,n} are generated from
Dwi = β0 + α0 1{Ti > γ0 } +
Yi = 1 {Dwi > 0} ,
X0
i δ0 + i ,
where Dwi is the ten-year change in the neighborhood’s white population, Ti is the base-year
minority share in the neighborhood, and Xi is a vector of six tract-level control variables.
The X variables include the unemployment rate, the log of mean family income, the frac-
tions of single-unit, vacant, and renter-occupied housing units, DEMO the fraction of workers
who use public transport to travel to work. See Card et al. (2008) for details on the dataset
and DEMO In the original dataset, Dwi is observed but for the time DEMO, we treat this
as a latent variable to illustrate our testing DEMO for the probit model. The error term
i follows the standard normal distribution. Thus, the null and alternative hypotheses in
14
our setting are
LEE, SEO, AND SHIN
(4.1)
H0 : α0 = 0 and H1 : α0 = 0,
respectively.
DEMO four cities we have chosen are Boston, Chicago, New York, DEMO Philadelphia. The
p-values are calculated by the simulation method described in Section 3 with 1,000 simu-
lations. For estimating a tipping point (γ) under the alternative, we use the grid search
method. The grid DEMO are constructed from Ti that fell in the interval [l, 50%], where l
is the maximum of 5% and the 5th percentile of DEMO }.
Table 1. Test for Tipping in Segregation: Probit Model
City DEMO p-value Tipping
Points (ˆγ) EX[ΔPr(y = 1|
Boston, MA DEMO 2.8% 46.80 -0.25
Chicago, IL 1813 0.0% 48.74 -0.34
New York, NY 2430 0.0% 14.01 -0.09
Philadelphia, PA 1300 0.0% 39.64 -0.30
X)]
We summarize the result in Table 1. The last column of DEMO table shows the average
changes in probability that the white population would increase when the minority share
crosses the tipping point. We calculate this DEMO marginal eﬀect as
1
EX[ΔPr(y = 1|X)] = n XΦ(
βˆ
0
+ Xi
δˆ)
− Φ(
βˆ + DEMO
0
+ Xi
δˆ
)
i
where Φ(·) is the CDF of the normal distribution.
First of all, testing results show that there exist tipping points in all four cities. Second,
the tipping DEMO vary from 14.01% in New York to 48.74% in Chicago. This shows that
cities are heterogeneous in whites’ preferences, among other things, implying DEMO tolerance
levels against minority shares are quite diﬀerent across diﬀerent cities. Third, the average
marginal eﬀects are also diﬀerent across cities. New York shows that the probability drops
less than 10%. Meanwhile, Chicago shows that it drops more than 30%.
TESTING FOR THRESHOLD EFFECTS 15
We now illustrate our testing procedure for DEMO median regression model using observed
Dwi directly, instead of Yi . DEMO now suppose that data {(Dwi , Xi,Ti ) : i = 1,...,n} are
generated from
Dwi = β0 + α0 DEMO > γ0 } + p(Ti ) +
X0
i δ0 + i ,
where median(i |Xi ,Ti ) = 0 and DEMO(T ) is the 4th-order polynomial of T . Note that Card et al.
(2008) considered the mean regression model (that is, DEMO(i |Xi,Ti ) = 0) with the 4th-order
polynomial in DEMO(T ). The null and alternative hypotheses are the same as DEMO in (4.1).
The p-values are calculated by the simulation method DEMO in Section 3 with 2,000
simulations. In the application, we DEMO b(γ) and e by (3.8) since we do not DEMO
V
V
whether regression errors are independent of regressors. For estimating a tipping point (γ)
under the alternative, we used the grid DEMO method. The grid points were constructed
from Ti that fell in the interval [l, 60%], where l is the maximum of 5% and DEMO 5th percentile
of {Ti }.
Table 2. Median regression model with the 4th-order polynomial
City obs. p-value Tipping Size of the
Point (ˆγ) DEMO (ˆα)
Boston, MA 700 4.7% 51.75 -17.640
Chicago, IL DEMO 2.9% 48.45 -13.929
New York, NY 2430 1.5% 23.70 -7.309
Philadelphia, PA 1300 1.2% 39.65 -11.599
We summarize the result in Table 2. DEMO results show that there exist tipping points
in all four cites at the 5% level. The tipping points vary across these cities and are DEMO
much diﬀerent from those from the probit model, especially in Chicago DEMO Philadelphia.
5. The Asymptotic Null Distribution
This section provides asymptotic theory for obtaining the asymptotic null distribution.
Our assumptions are quite general and allow DEMO a nonsmooth objective function Qn , which
16
LEE, SEO, AND SHIN
may not permit usual quadratic approximations. DEMO in Section 3, we focus on the M-
estimation in this DEMO In the online supplements, we provide asymptotic theory for the
case DEMO objective functions are based on U-processes and verify regularity conditions for
the maximum rank correlation (MRC) estimator. The consistency and local power of DEMO
test are included in the online supplements as well.
5.1. M-estimation. This section considers the ﬁrst case when the objective function has
the form DEMO (2.1). Our estimators need not be exact maximizers, which might have mea-
surability issues. Thus, we consider an estimator
θˆ
γ
for a given γ ∈ Γ such that
Qn 
θˆ
γ
,γ = sup Qn (θ,γ) + opγ  
−2
rn
 ,
θ ∈Θ
where opγ (1) indicates the sequence under consideration DEMO op (1) uniformly over γ ∈ Γ. We
deﬁne oγ (DEMO) and Opγ (1) similarly. Also, let
β˜
satisfy
where
Q¯
n
Q¯
n

β˜
 = sup
β ∈B
Q¯
n (β) + op  r
−2
n
 ,
denotes the restrictive DEMO function with α = 0.
To derive the asymptotic distribution of the statistic QLRn , we impose some high-level
assumptions, which will be veriﬁed later for each example. We ﬁrst introduce some notation.
Let
(5.1)
Fδ = {qθ,γ − qθ0 ,γ : |θ − θ0 | < δ,γ ∈ Γ} ,
where |·| is the Euclidean norm for a vector (we use the notation k·k to indicate a generic
norm for a function space). An envelope function of a class DEMO is a function F such that
PF 2 < ∞, |f (x)| ≤ F (x) for any x and f ∈ DEMO . An envelope function for Fδ is denoted
by Fδ .
Weak convergence of the statistic QLRn draws on the size of the class DEMO measured by
entropy with or without bracketing. Let N (ε, F , k·k) and N[ ] (ε, F , k·k) denote DEMO and
bracketing numbers, respectively. The logarithm of the covering number is DEMO entropy
TESTING FOR THRESHOLD EFFECTS 17
(without bracketing) and that of the DEMO number is called entropy with bracketing.
We mostly use the Lr (DEMO)-norm, kf kQ,r =  R |f |r dQ1/r , DEMO Q is a probability measure.
When the entropy without bracketing is concerned, it is common that the required condition
is in terms of uniform entropy, supQ log N (ε, F ,Lr (Q)) , where the supremum is taken
over all the possible probability measures on DEMO sample space, with 0 < QF r < ∞. While
the DEMO is an issue in the formal discussion of uniform entropy conditions, DEMO
hardly matters in applications. We assume measurability throughout the article. See e.g.
van der Vaart and Wellner (1996) for more general discussions on DEMO empirical process
method.
We now present a set of assumptions, whose DEMO will be discussed later on.
Assumption 5.1 (Uniform Consistency).
θˆ
(γ) = θ0 + opγ (1) and
β˜
= β0 + op (1) .
A set of suﬃcient conditions for the uniform DEMO in Assumption 5.1 is that
(i) uniform convergence of the objective function Qn ; (ii) separability of the true value.
Formally, we present it as Lemma 5.2 in Section 5.2.
Assumption 5.2 (Uniform Rates of Convergence in Probability). rn 
rn 
θˆ
(γ) DEMO θ0  = Opγ (1) .
β˜
− β0  = Op (1) and
Most often, the rate rn in Assumption 5.2 is already known for linear models and rn must
be the same DEMO
θˆ
(γ) for each γ since g (w,θ,γ) is a linear function in θ. Thus, Assumption
5.2 has mainly to do with verifying the uniformity. However, the entropy conditions below
in Assumption 5.4 are almost suﬃcient to ensure it, as will be shown in Lemma 5.3 in
Section 5.2.
In what follows, ﬁx 0 < K < ∞ and assume the following.
Assumption 5.3 (Lindeberg Condition and L2 -Continuity). For any η > 0,
4
rn
n
PF DEMO
K/rn 1
4
rn
n
PF 2
K/rn
= O (1) ,
 r 2 FK/rn > η√n = o (1) .
n
√n
18
LEE, SEO, AND SHIN
In addition, for any decreasing sequence ηn → 0,
(5.2) sup
|h1 −h2 |<ηn
|γ1 DEMO |<ηn
n P  q
r 4
n
θ0 +h1 /rn ,γ1
− qθ0 +h2 /rn ,γ2
2
= o (1) DEMO
Assumption 5.3 is a minimal set of conditions on the moments of the envelope function F
and on the smoothness of the limit objective DEMO These are straightforward to verify.
Assumption 5.4 (Entropy Conditions). For DEMO δ0 > 0, assume that
(5.3)
Z
0
1
sup sup rlog N ε kFδ kQ,2 , Fδ ,L2 (Q)DEMO < ∞
δ<δ0
Q
or
(5.4)
Z
0
1
DEMO rlog N[ ] ε kFδ kP,2 , Fδ ,L2 (P )dε < ∞.
δ<δ0
It is not always trivial to verify these entropy conditions. However, there are well-
known classes of functions that satisfy either of the conditions. For example, Vapnik-
Cervonenkis (VC) classes of functions have the covering numbersˇ
that are bounded by a
polynomial DEMO ε−1 , thus satisfying (5.3) as long as the VC indexes are bounded in n. The
bracketing numbers for classes of smooth functions, monotone functions, convex functions,
or Lipschitz functions are known, see DEMO Section 2.7 of van der Vaart and Wellner (1996).
In DEMO, the bracketing number of the collection of Lipschitz functions are bounded
DEMO the covering number of the index set, thus, being at most the polynomial in (1/ε)p ,
where p is the DEMO of the parameter space.
Partition h into (h0 ,h0 )0 DEMO to the dimensions of θ and b, respectively.
θ
b
Assumption DEMO (Finite-Dimensional Weak Convergence). Let h1n = ξ0 + h1
r DEMO and
n
h2n = ξ0 +h2
r −1 . Then, for DEMO K > 0,
n
norms are less than K,
any γ1 ,γ2 ∈ Γ, and any h1 and h2 whose Euclidean
DEMO 4
n
n P (mh1n ,γ1 − mh2n ,γ2)2 DEMO E (G1 (h1 ,γ1 ) − G1 (h2 ,γ2 ))2 ,
TESTING FOR THRESHOLD EFFECTS 19
−1
where G1 is a zero-mean Gaussian DEMO Furthermore, let hn = ξ0 + hrn . Then
r 2
DEMO Pmhn ,γ
−→ G2 (h,γ)
uniformly in h and γ over any compact set, for some non-stochastic G2 . Finally, DEMO and
G2 satisfy that
(5.5)
EG1 (h,γ)2
and
|hθ |r
→ 0
γ,hb , and some r > 0.
DEMO |(rh,γ+1/2) → −∞
as |hθ | → ∞, for any
The limit process over which the supremum will be taken DEMO characterized by the terms
given in Assumption 5.5. Considering the deﬁnition of mξ,γ , the Gaussian process G1 (h,γ)
is likely to be degenerate in h as shown in later examples. Condition (5.5) in Assumption
5.5 guarantees that the restricted suprema (as in the DEMO of QLRn in (3.1)) of G1 +G2
are Op (1). When G2 (h,γ) is quadratic in h and G1 (h,γ) is linear in h for a given γ, then
DEMO can choose r = 1 in (5.5).
We now present DEMO main theorem.
Theorem 5.1. Under Assumptions 5.1-5.5,
(5.6)
QLRn DEMO sup  sup G (h,γ) − sup (−G (h,γ)) ,
h:hθ =0
where G = G1 + DEMO .
γ
h:hb =0
While the asymptotic null distribution of QLRn is well-deﬁned under the restriction in
Assumption 5.5, the asymptotic critical values cannot be tabulated due to the unknown co-
variance kernel of G1 DEMO Therefore, we need to simulate critical values or asymptotic p-values.
Alternatively, we need to use resampling methods such as the bootstrap or subsampling.
DEMO works more generally including all the examples we examined in this article.
When we can solve out the maximizers explicitly for the expression inside DEMO bracket in
20
LEE, SEO, AND SHIN
(5.6), simulating the critical values in the spirit of Hansen (1996) can also be applied. Two
DEMO in Section 3 belong to this case.
5.2. Low-Level Suﬃcient Conditions for Assumptions. This section provides low-
level suﬃcient conditions for Assumptions 5.1-5.5. First, we present the following lemma
that can be used to verify Assumption DEMO
Lemma 5.2. Let F be a class of functions {qθ,γ : (θ,γ) ∈ Θ × Γ} with envelope F such that
DEMO < ∞. Suppose either of the following two conditions is satisﬁed: (i) N[ ] (ε, F ,L1 (P)) <
DEMO for every ε > 0; (ii) For FM deﬁned as DEMO class of functions f1 {F ≤ M } for f ∈ F ,
log N (ε, FM ,L1 (Pn )) = DEMO (n) for every ε and M > 0. Then,
sup |Qn (θ,γ) − Q (θ,γ)| −→ 0,
θ,γ
p
where Q (θ,γ) = Pqθ,γ . DEMO, assume that
(5.7) sup  sup {Q (θ0 ,γ) − Q (θ,γ)} > 0
γ ∈Γ
θ /∈
DEMO
0
for every open set Θ0 that contains θ0 . Then,
θˆ
(γ) − θ0 = opγ (1) .
While there DEMO diﬀerent ways to present suﬃcient conditions for Assumption 5.1, we
choose DEMO way as the subsequent discussion also draws on the entropy conditions. The
entropy conditions in Lemma 5.2 are automatically satisﬁed if Assumption 5.4 holds. DEMO,
separability is the one we need to check. Recall that Q (θ0 ,γ) is the same for all γ since γ
is not identiﬁed under the null. However, once we establish the consistency for a given γ
and that Q (θ0 ,γ) > sup
θ /∈
Θ
Q (θ,γ), the veriﬁcation of the separability DEMO not very diﬃcult
since γ appears only through an indicator function.
We now consider suﬃcient conditions for Assumption 5.2. The following lemma general-
izes DEMO standard method in van der Vaart and Wellner (1996) for obtaining the convergence
rate to the case where a uniform rate is needed DEMO to the presence of a nuisance parameter.
See Andrews (2001) for a diﬀerent approach when the quadratic approximation is plausible.
TESTING FOR THRESHOLD EFFECTS 21
Lemma 5.3. Assume that for every θ DEMO a neighborhood of θ0 ,
(5.8) sup P (qθ,γ − qθ0 ,γ ) ≤ −C |θ − θ0 |2 ,
DEMO
for some ﬁnite constant C > 0 and that for every n and suﬃciently small δ,
(5.9)
E
γ
|θ −θ0 |<δ |Gn (qθ,γ − qθ0 ,γ )| = O (DEMO (δ)) ,
sup sup
for a function φ such that φ (δ) /δ r is decreasing for some r < 2. If Assumption 5.1 holds,
then
2
for every rn such that DEMO φ
rn 
θˆ
(γ) − θ0  = Opγ (DEMO) ,
(1/rn ) ≤ √n for every
rn is DEMO, then (5.9) can
n. If the rate
be stated for DEMO = K/rn and φ (δ) = √n/r 2 .
n
The ﬁrst condition (5.8) is not diﬃcult to verify. Often, Pqθ,γ is twice continuously
diﬀerentiable at θ0 for all γ. In DEMO case, a suﬃcient condition is the existence of nonsingular
second derivative DEMO at θ = θ0 whose maximum eigenvalues are uniformly bounded
away from zero.
The second condition (5.9) is implied by Assumptions 5.3 and DEMO It is known that the
left-hand side term in the equation (DEMO) is bounded by the product of the L2 norm of the
DEMO function, P1/2 (F 2 ) , and the uniform entropy integral or the bracketing integral,
δ
which is deﬁned respectively by
DEMO
Z
0
1
sup Z r1 + log N ε kFδ kQ,2 , Fδ ,L2 (Q)dε
r1 + log N[ ] DEMO kFδ kP,2 , Fδ ,L2 (P)dε.
0
1
Q
See e.g. Theorems 2.14.1 and 2.14.2 in van der Vaart and Wellner (1996). These are
bounded by Assumption 5.4. Thus, in case when the rate rn is not known a priori, it
22
LEE, SEO, AND SHIN
is typical that φ2 (δ) DEMO PF 2 yields the correct rate, leading to the rate as DEMO solution of
δ
r 4 PF 2
n 1/rn
∼ n. This is in fact the ﬁrst condition in Assumption 5.3.
We now DEMO suﬃcient conditions for Assumption 5.4. Many interesting examples
feature the estimating function q in the form of Lipschitz of order r transformation in the
DEMO that qθ,γ = q (y,g (w,θ,γ)) and
|q (y,g (w; θ1 ,γ1 )) − q (y,g (w,θ2 ,γ2 ))| ≤ Lr (w) |g (w; θ1 ,γ1 ) − g (w; θ2 ,DEMO )|r ,
where Lr is square integrable in P. In this case, veriﬁcation of the entropy conditions and
the conditions on the envelope function is straightforward as in the following lemma.
Lemma 5.4. Suppose that DEMO is a class of functions qθ,γ , which are Lipschitz of order
r ∈ (0, 1] transformations, where |θ − θ0 | < δ and γ ∈ Γ. Then, for some δ0 > 0,
Z
0
1
sup sup rlog N ε kFδ kQ,2 , Fδ ,L2 (Q)dε < ∞.
δ<δ0
Q
Let φ (δ) = δ r . Then, there exists an envelope function Fδ such that for every η > 0,
lim φ−2 (δ) P 2 1 Fδ > ηδ −2 φ2 (δ) = 0.
Fδ
δ →0
The lemma speciﬁes the functional form of φ (δ) as δ r , resulting in the convergence rate
rn = n1/(4−2r ) , upon verifying conditions on Pqθ,γ . There are quite a few examples that are
Lipschitz of order 1. They include DEMO quantile regression model and the probit model in
Section 3.
If Pqθ,γ is twice continuously diﬀerentiable at θ = θ0 with a unique DEMO at θ0 ,
Assumptions 5.1 and 5.2 may be implied by DEMO conditions as discussed above. Then,
the following corollary is more convenient to apply than the main theorem. It provides
conditions under which G2 (h,γ) is quadratic in h for a given γ and most applications
belong to this case.
TESTING FOR THRESHOLD EFFECTS 23
Corollary 5.5. Suppose that the function Q (θ,γ) has a well-separated maximum θ0 in
the sense of (DEMO) and it is twice continuously diﬀerentiable at θ0 with a negative DEMO
derivative matrix, say −V (γ), whose maximum eigenvalues are bounded away from zero
for all γ. Let Vβ denote the block of DEMO (γ) that is associated with the second derivative with
2
1
0
1
0
compact set. If Assumptions 5.3 and 5.4 hold with DEMO sequencerespect to β. Then, rn Pmhn ,γ −→ − 2 hθ V (γ) hθ + 2 hb Vβ hb = G2 r(DEMO,γ, then) , uniformly over anyrn 
Opγ (1) and rn 
QLRn ⇒ sup  sup G (h,γ) − DEMO (−G (h,γ)) .
γ
h:hb =0
h:DEMO =0
β˜
− β0  = Op (1). If Assumption DEMO holds as well, then
θˆ
(γ) − θ0  =
DEMO in addition G1 (h,γ) is linear in h for a given γ, then a more explicit form of the
asymptotic null distribution is available. By construction, we may write
G1 (h,γ) = h0 G (γ) = (hβ − hb )0 G1 + DEMO G2 (γ) ,
where G (γ) =  G
0
DEMO ,
G2 (γ)0 
0
is a Gaussian process with some covariance kernel K(γ1 ,γ2 ).
Then, simple algebra shows that the limiting distribution of QLR has the form
1
(5.10) DEMO sup G (γ)0 V (γ)−1 G (γ)
DEMO
0
− G1
V −1 G1  .
β
n
Standard linear algebra allows us to write this as
1
2 supγ G (γ)0 Hα (γ) Hα (γ)0 G (γ) ,
DEMO Hα (γ) is a full-column rank matrix whose rank is the dimension of α, say kα .
Furthermore, if eﬃcient estimators are DEMO for both restricted and unrestricted models,
then for each γ, DEMO (γ)0 G (γ) is distributed as standard multivariate normal DEMO dimension
kα . Thus, 2QLRn converges in distribution to the supremum DEMO a chi-square process indexed
by γ. This is the case with the homoskedastic linear regression model with ordinary least
squares estimators (Hansen, 1996) and also with maximum likelihood estimators for logit
and probit models.
24
LEE, SEO, AND SHIN
6. Examples
This section presents a DEMO well-known statistical models as examples to illustrate how
to check the regularity conditions given in Section 5.
6.1. Maximum Score Estimation. The estimating function DEMO the maximum score es-
timation is
(6.1)
q (y, DEMO; θ,γ) = (2y − 1) 1 {x0 β + z0 α1 {t > γ} ≥ 0} .
To check the entropy DEMO (5.3) in Assumption 5.4, we show that the class F DEMO
these functions qθ,γ , where θ and γ belong to any compact subset in the Euclidean space,
is a VC class of DEMO Indeed, the set {x0 β + z0 α1 {t > γ} DEMO 0} can be represented by
union and intersection of half-spaces in the Euclidean space. Since half spaces are VC class
of sets and the DEMO feature is preserved under unions and intersections, see Lemma 2.6.17
in DEMO der Vaart and Wellner (1996), the sets constitute a VC DEMO, so do the indicator
functions of the sets. Now, Fδ = {qθ,γ : |θ − θ0 | < δ,γ ∈ Γ} DEMO also a VC class of functions
of the same index at most as F . Thus, the covering numbers of FK/rn is bounded in a
polynomial in (1/ε)−1 , not depending on n, and thus (5.3) is satisﬁed.
To ﬁnd an envelope function for Fδ , note that |qθ,γ − qθ0 ,γ | ≤ 1 and that it takes nonzero
values only when x0 β0 and x0 DEMO + z0 α1 {t > γ} take diﬀerent signs. The latter implies that
the distance between the two is greater than x0 β0 in DEMO values. Thus,
|x0 β0 | ≤ θ :|θ −θ0 |≤δ DEMO (β − β0 ) + z0 α1 {t > γ}| ≤ DEMO |x| ,
max
which yields an envelope function
Fδ = 1 DEMO β0 | ≤ 2δ |x|} .
TESTING FOR THRESHOLD EFFECTS 25
It is shown in Theorem 6.1 below DEMO some regularity conditions on P that this envelope
function satisﬁes the conditions in Assumption 5.3 with the rate obtained in Kim and Pollard
(1990) for
β,˜
that is, with rn = n1/3 .
DEMO following assumption is imposed, which is somewhat more restrictive than required
DEMO simplify the exposition. Let Wγ = (X0 , Z0 1{T > DEMO)0 .
Assumption 6.1. (i) The parameter θ has unit length, that is, Θ is the surface of the unit
sphere in DEMO , and γ ∈ Γ, which is an open subset of DEMO support of T.
(ii) The distribution of U conditional on W = w, denoted by FU |W(·|w), is absolutely con-
tinuous with respect to Lebesgue measure and the corresponding conditional density is uni-
DEMO continuous and positive everywhere with probability one. In addition, FU |W(DEMO) =
0.5 for almost every w and it is continuously diﬀerentiable DEMO respect to w.
(iii) X has a continuously diﬀerentiable density pX (·) and the angular component of X,
considered as a DEMO element in the unit sphere, has a bounded, continuous density with
respect to surface measure on the sphere. Furthermore, the density pX has compact support.
(iv) R 1 {x0 β0 = 0} pW (w) d$ > 0, where $ denotes the Lebesque measure on {w : x0 β0 = 0} .
(v)
is continuously distributed.
The DEMO theorem shows that conditions in Theorem 5.1 are satisﬁed.
Theorem 6.1. Suppose Assumption 6.1 hold and h,h1 and h2 belong to the null DEMO of
ξ0 . Let ` (w; h1 ,h2 ,γ1 ,DEMO ) be the sum of the lengths of two intervals (I1 DEMO I2 ) and (I2 − I1 ) ,
where I1
is the interval between w 0 and w 0
γ1h1θ γ2h2θ and I2 DEMO the interval between x0 h1b
and
x0 h2b . Also, let
(6.2)
κ(w) := E [1 {g (W; θ0 ,γ0 ) + U ≥ 0} − 1 {g (W; θ0 ,γ0 ) + U < 0} |W = w]
= 1 − DEMO |W[−g(w,θ0 ,γ0 )|w].
Then, the covariance kernel of DEMO limit Gaussian process G1 is characterized by
E (G1 (h1 ,DEMO ) − G1 (h2 ,γ2 ))2 = Z ` (DEMO; h1 ,h2 ,γ1 ,γ2 ) 1 {x0 β0 = 0} pW (w) d$,
T
26
LEE, SEO, AND SHIN
and
G2 (h,γ) = DEMO (x0 hb )2 −   hθ 
QLRn ⇒ sup DEMO sup G (h,γ) − sup (−G (h,γ))DEMO ,
γ
h:hb =0
h:hθ =0
QLRn is deﬁned DEMO (6.1) and G = G1 + G2 .
w 0
γ
2
 1 {x0 β0 = 0} [(∂/∂x0 ) κ (w) β0 ] pW (w) d$.
Furthermore,
where qθ,γ for
Theorem 6.1 establishes the asymptotic null distribution for the maximum score DEMO
tion. The corresponding distribution is nonstandard and cannot be tabulated; however,DEMO
statistical inference can be carried out by subsampling as in Delgado et al. (2001). Since
without Theorem 6.1, it would be diﬃcult DEMO obtain the validity of subsampling, one of the
merits of Theorem DEMO is to provide the asymptotic validity of subsampling.
6.2. The Probit Model. We now verify regularity conditions for the probit model. Note
that the DEMO q(y, w; θ,γ) in (3.3) is Lipschitz DEMO order 1 transformation and twice
continuously diﬀerentiable in θ. Therefore, applying DEMO 5.4 and Corollary 5.5, we
only need to check the separability DEMO (5.7) and Assumption 5.5. We assume the
following regularity conditions:
Assumption 6.2. (i) The parameters θ and γ are in the DEMO of compact sets Θ and
Γ where Γ is contained in an open subset of the support of T.
(ii) For any γ, the matrix E Wγ W
(iii) T is continuously distributed.
 DEMO and is nonsingular.
We ﬁrst verify the separability condition. Let γ be given. Since E W
lar, it is positive deﬁnite. This implies that W 0
γ θ0 = Wγ θ for any θ
0
γ
DEMO
W 0
γ
 is nonsingu-
= θ . Therefore, strict
DEMO
monotonicity of Φ (·) assures identiﬁcation for each γ, which DEMO the separability
condition.
TESTING FOR THRESHOLD EFFECTS 27
Since q (·) is twice continuously DEMO, it follows from the discussion following
Corollary 5.5 that the limiting DEMO of the test statistic is the supremum of a chi-
square process indexed by γ as in (5.10) . Then the desired result DEMO (3.4) follows. Using
identical arguments, we can obtain the null DEMO distribution of the test statistic for
the logit model. In general, DEMO arguments can apply to statistical models for which the
test statistic can be constructed based on the maximum likelihood estimator.
6.3. Quantile regression. Note DEMO the function q(y, w; θ,γ) in (3.5) DEMO Lipschitz of
order 1 as a function of g(w,θ,γ). Therefore, the bracketing entropy condition (5.4) and
the condition on the envelope function in Assumption 5.3 are satisﬁed due to Lemma 5.4.
DEMO, rn = √n. We verify the other conditions in Corollary 5.5.
DEMO that the density of Y conditional on W and that of T conditional on the other
elements in W exist and are continuously diﬀerentiable DEMO uniformly bounded derivatives.
Let fY |W (·|w) denote the conditional density of Y given W = w. Then, Pqθ,γ is twice
continuously diﬀerentiable in any (θ,γ) , implying the last condition in DEMO 5.3 is
satisﬁed. Furthermore, G1 is linear in h as to DEMO shown below. Thus, the limit distribution
is characterized by (5.10) DEMO
V (γ) = E W
γ
W 0
γ fY |W
(X0 β0 |W) ,
and a mean-zero Guassian process G DEMO covariance kernel in (3.7). To see this, write
Δτ (DEMO) := ρτ (y − a) − ρτ (y − DEMO ) − [1(y < a0 ) − τ](a − a0 ).
Then as in Pollard (1991), simple algebra yields that
(6.3)
Deﬁne
|Δτ (a)| ≤ |a − a0 |1{|y − a0 | ≤ |a − a0 |}.
ϕh,γ (y, w) := [1(y < x0 β0 ) − τ] (x0 (hβ − hb ) + z0 hα 1{t > γ}) .
28
By (6.3),
LEE, SEO, AND SHIN
≤
→
DEMO |mhn ,γ − ϕhn ,γ |2
1 (|Y − X0 DEMO | ≤
E W 0
γ hθ
0.
W 0
γ hθ
√n
) + E |X0 hb | 1 |Y − X0 β0 DEMO ≤
|X√0 hnb
| 
Therefore, the covariance kernel is given DEMO that of ϕh,γ by applications of Cauchy-Schwarz
inequality, which is DEMO by (3.7).
Note that in this example, the asymptotic null distribution is not the supremum of a chi-
square process indexed by DEMO This is due to the fact that the quantile regression estimator
is not an eﬃcient estimator. However, critical values can be simulated by the same method
as in the maximum likelihood estimation, which was illustrated in section 3.
7. Monte Carlo Simulations
In this section, we report Monte Carlo simulation results for all four examples considered
in the article. Details DEMO simulation designs and testing procedures are provided in the online
supplement.
Figure 2 summarizes the results of the simulation study, by showing the power functions
for four examples with three diﬀerent sample sizes: n = 50, 100, and 200. The top right
and left panels report results DEMO the probit example and those from the maximum score
estimation example, DEMO In addition, the bottom right and left panels report
results from DEMO quantile regression example and those from the maximum rank correlation
estimation example, respectively. First of all, the ﬁgure shows the ﬁnite sample size DEMO the
test when the nominal level is 5%. Under the null hypothesis (α = 0), the rejection rates
of the test are close to the nominal level in most cases. Secondly, Figure 2 shows the power
of the test when α increases from 0 to 1. The DEMO indicates that, in all cases, the power
increases fast as the parameter value of α is farther away from zero and also it DEMO as
n gets large.
TESTING FOR THRESHOLD EFFECTS 29
1
0.8
0.6
0 4
.4
0.2
DEMO
1.0
0.8
0.6
0.4
0.2
0.0
n=200
n 100=100
n=50
size: DEMO
1.0
0.8
n=200
n=100
n=50
size: 5%
0.6
0.4
0.2
Figure DEMO Power Functions of Threshold Models
Threshold Probit Threshold MSE
0 0.2 0.4 0.6 0.8 1
Slope Variable
n=200
n=100
n=50
size: 5%
Threshold Quantile
0 0.2 0.4 0.6 0.8 1
Slope Variable
0.0
1.0
0.8
0.6
DEMO
0.2
0.0
0 0.2 0.4 0.6 0.8 1
Slope Variable
Transformation Model (MRC)
n=200
n=100
n=50
size: 5%
0 0.2 0.4 0.6 DEMO 1
Slope Variable
8. Conclusions
We have developed a general testing procedure for threshold eﬀects and have proposed a
new method for establishing the DEMO null distribution. Since the new approach does
not require to approximate the objective function in a quadratic form, we can construct
the test statistic for nonstandard cases like the maximum score estimation. Furthermore,
we have DEMO the test statistic when the objective function is a U-process. We believe
our approach would prove useful in many other occasions where objective function DEMO
inferences are made.
Power
Power
Power
Power
30
LEE, SEO, AND SHIN
Fan et al. (2001) show DEMO a class of the generalized likelihood statistics based on some
appropriate nonparametric estimators are asymptotically chi-squared in nonparametric
testing problems. However, they do not consider the Davies problem. It is an interest-
ing research topic to DEMO whether one can generalize the methodology of Fan et al. (2001)DEMO
to cover the case when there may be a nuisance parameter that appears under the alter-
native, but not under the null. Such examples are partially linear regression models and
varying coeﬃcient models with a change-point DEMO to a covariate threshold.
We have provided local power results in the online supplements, but have not established
the asymptotic admissibility of the test we proposed. Andrews and Ploberger (1995) have
established the asymptotic admissibility DEMO the likelihood ratio test. It might be possible
to extend their results to more general cases, including our QLR statistics. Alternatively,
following Andrews and Ploberger (1994) and Song et al. (2009), we may introduce a class
of tests of the following form:
Exp − DEMO
2
= rn
(1 + c)−p/2 Z
1
exp 2 c c QLRn
+ 1
(γ) dJ (γ) ,
where p is the dimension of b, J (·) is a prespeciﬁed weight function over values of γ
in Γ, and c is a prespeciﬁed scalar constant. It might be possible to establish that
DEMO − QLRn has some weighted average power properties in our setup, DEMO the lines
of Andrews and Ploberger (1994) and Song et al. (2009). These are interesting topics for
future research.
Appendices
The appendices contain all the mathematical proofs, additional theoretical results, and
Monte Carlo DEMO results. In particular, (i) we provide the proofs of all DEMO theo-
rems; (ii) we provide asymptotic theory for the case DEMO objective functions are based
on U-processes and verify regularity conditions for the maximum rank correlation (MRC)
TESTING FOR THRESHOLD EFFECTS 31
estimator; (iii) we discuss the consistency and local power of the test when the null hy-
pothesis is DEMO; and (iv) we report details of Monte Carlo simulation designs DEMO testing
procedures.
Appendix A. Proofs of Theorems
Proof of Theorem 5.1. As supremum is a continuous operator, we need to establish the
weak convergence of the process r 2
n Pn mξ,γ
. Also note DEMO in view of Lemma 2.5 of Kim and
Pollard (1990) the supremum of the limit process G is Op (1) under Assumption DEMO Under
the uniform convergence rate given in Assumption 2, it is DEMO to consider the process
r 2 only on the r −1
n Pn mξ,γ n
neighborhood of ξ0 . Furthermore, given the decomposition (3.2)
of r 2
n Pn mξ,γ and Assumption 5, it remains to obtain the weak convergence of the empirical
process indexed by the sequence of classes of functions
Mn =  r 2 DEMO ,γ : |h| ≤ K,γ ∈ Γ,
n
√n
DEMO hn is deﬁned in Assumption 5. That is, we derive the DEMO convergence of
r 2
n
√nGn mhn ,γ ,
for any given K > 0. Then, an application of the continuous mapping theorem concludes
the proof.
We apply either Theorem 2.11.22 or 2.11.23 of van DEMO Vaart and Wellner (1996) to ob-
tain the weak convergence. While our assumptions are suﬃcient for both theorems, they
are presented in terms of functions q not of functions m. Thus, we need to show that the
conditions on q are preserved under the transformation yielding m. DEMO, we verify that the
boundedness of both entropy conditions (5.3) DEMO (5.4) is preserved under summation. For
the latter, note that DEMO deﬁnition of the bracketing numbers implies that for two classes
F and G of functions,
N[ ] (2ε, F + G ,Lr (Q)) ≤ N[ ] (ε, F ,Lr (Q)) N[ ] (ε, G ,Lr (Q)) .
32
LEE, SEO, AND SHIN
Therefore, the bounded entropy condition (DEMO) for Fδ implies the boundedness of the
entropy condition for the DEMO
Mδ = {mξ,γ : |ξ − ξ0 | < δ} .
For the former case of uniform entropy, we refer to Theorem 2.10.20 of van der Vaart and Wellner
(1996), which shows
log N ε k2Fδ kQ,2 , Fδ + Fδ ,L2 (Q) DEMO 2 log N ε kFδ kQ,2 , Fδ ,L2 (Q).
Thus, it is shown that the class Mδ also satisﬁes either the entropy conditions (5.3) or (5.4),
which also satisﬁes DEMO of either Theorem 2.11.22 or 2.11.23 of van der Vaart and Wellner
(1996). An envelope function Mδ for Mδ is given by 2Fδ , which satisﬁes the conditions
of Theorem 2.11.22 or 2.11.23 of van DEMO Vaart and Wellner (1996) under Assumption 3.
This completes the proof.
Proof of Lemma 5.2. The proof of this lemma is omitted since DEMO ﬁrst conclusion is a re-
statement of Theorems 2.4.1 and 2.4.3 in van der Vaart and Wellner (1996) and the second
conclusion follows DEMO from Lemma A-1 of Andrews (1993). Speciﬁcally speaking,
Condition (a) of Lemma A-1 of Andrews (1993) is satisﬁed by Theorem 2.4.1 and Theorem
2.4.3 in van der Vaart and Wellner (1996).
Proof of Lemma 5.3. To prove the lemma, we modify the peeling device in the proof of
Theorem 3.2.5 in van der Vaart and DEMO (1996). For each n, the parameter space
can be partitioned into the shells Sj,n = {θ : 2j
rn supγ (γ) − θ0 is larger than 2M for a given
γ. In that case supθ,γ Pn qθ,γ − Pn qθ0 ≥ 0, where the supremum is taken over the shell for θ
θˆ
−1
< DEMO |θ − θ0 | ≤ 2j } for integer j’s. If
M,
θˆ
(γ) is in one of the shells for some
TESTING FOR THRESHOLD EFFECTS 33
and γ ∈ Γ, due to the deﬁnition of
θ.ˆ
Pr rn sup
γ
θˆ
(γ) − θ0 > 2M 
Therefore, for any η > 0,
≤
X
DEMO Pr 2 sup
γ
j ≥M,
j ≤ηrn
Pr ( sup γ Pnqθ,γ − Pqθ0 ≥ 0)
θ ∈Sj,n ;
θˆ
(γ) − θ0
≥ η.
2
The two terms in DEMO right side of the inequality can be shown to be made arbitrarily
small by the same argument in the proof of Theorem 3.2.5 in DEMO der Vaart and Wellner
(1996).
Proof of Lemma 5.4. Let DEMO denote the collection of g (w; θ,γ)s such that |θ − θ0 | < δ and
δ an envelope function of DEMO . Then, it follows from Theorem 2.10.20 of van der Vaart DEMO Wellner
(1996) that the uniform entropy integral of Fδ is bounded by
(A.1)
Z
0
1
sup rlog N ε k
Q
g¯
dε
δ kQ,2r , Gδ ,L2r (Q)ε1−r ,
g¯
where the supremum is taken over all ﬁnitely discrete probability measures DEMO It is clear that
Gδ constitutes a VC class of functions since the subgraphs are represented by intersections
and unions of half spaces as DEMO in Section 6.1. Since the VC-index does not depend
on δ and the covering number of a VC class is polynomial in (1/ε) , the uniform entropy
integral in (A.1) is bounded uniformly in δ. This in turn implies that the uniform entropy
integral condition in (5.3).
An envelope function for Fδ is given by Fδ = DEMO ·
g¯
r
δ
since
|q (y,g (w; θ,DEMO)) − q (y,g (w; θ0 ,γ0 ))|2 ≤ 4L2 (w
) ¯g
2r (w) .
r
δ (DEMO) = |w| δ is an envelope
function for Gδ using the DEMO inequality. Then, it is straightforward to see that
To check the DEMO on the envelope function, note that ¯g
34
LEE, SEO, AND SHIN
with φ (δ) = δ DEMO
φ−2 (δ) PF 2 1 Fδ > ηδ −2 φ2 (DEMO)
= E  4L2 (W) |w|2 1 {2Lr (W) |w| δ r > η}
r
→
0,
δ
as δ → DEMO for any η > 0.
Proof of Corollary 5.5. From the second order expansion of Pmhn ,γ , the functional form
of G2 is obvious since the ﬁrst derivative is zero at ξ = ξ0 from DEMO ﬁrst order condition.
The consistency of
θˆ
(γ) (and thus
DEMO
) follows from Lemma 5.2, and the convergence rates
follow from DEMO 5.3 since (5.8) is satisﬁed due to the presence of the second derivative
matrix Vθ (γ) and (5.9) is implied by DEMO 5.4. The last convergence then follows
from Theorem 5.1.
Proof of Theorem 6.1. We prove the conditions in Theorem 5.1. Assumption 5.4 is also DEMO
cussed in the text. The ﬁrst two conditions for the envelope function FK/rn in Assumption
3 are veriﬁed in Kim and Pollard (1989) .
To show the uniform consistency, we need to verify the DEMO (5.7) . Since γ0 is not
identiﬁed, it is an DEMO ﬁxed number, say, zero. Then it can be shown that
(DEMO)
Δ∗ (θ,γ) = P (qθ0 ,γ0 − qθ,γ )
= Ehκ(W)1 {g (W; θ,γ) DEMO 0 > g (W; θ0 ,γ0 )}
− 1 {g (W; θ0 ,γ0 ) ≥ 0 > g (W; θ,γ)} i.
By the assumption that FU |W[0|w] = 0.5, note that κ(w) ≥ 0 when g(w; θ0 ,γ0 ) ≥ 0 and
that κ(w) < 0 when g(w; DEMO ,γ0 ) < 0. Deﬁne
Q(θ,γ) = hw ∈ supp(W) : {g(w; θ,γ) ≥ 0 > g(w,θ0 ,γ0 )} ∪ {g(w,θ0 ,γ0 ) ≥ 0 > g(w,θ,γ)} i.
TESTING FOR THRESHOLD EFFECTS 35
By arguments identical to those used to DEMO Proposition 2 of Manski (1988), θ0 is identiﬁed
if and DEMO if inf γ Pr(W ∈ Q(θ,γ)) > 0 for any θ = θ0 . Therefore, supγ Δ∗ (θ,γ) is non-
positive everywhere and is equal to zero only when (θ,γ) = (θ0 ,γ0 ).
The uniform convergence with rn DEMO n1/3 can be argued from Lemma 5.3 upon proving
(5.8) , which will be veriﬁed when we derive the limit of r DEMO
n Pmhn ,γ
.
Now we present the covariance kernel of DEMO limit gaussian process G1 and verify the last
condition in Assumption 3. The following decomposition is useful: for any ξ1 ,ξ2 ,γ1 , and
γ2 ,we have
rn P (mξ1 ,γ1 − mξ2 ,DEMO)2
= rn P (|1 {g (W,θ1 ,γ1 ) DEMO 0} − 1 {g (W,θ2 ,γ2 ) ≥ 0}|)
+ rn P (|1 {X0 β1 ≥ 0} − 1 {X0 β2 ≥ 0}|)
− rn 2P (1 {g (W,θ1 ,γ1 ) ≥ 0} − 1 {g (W,θ2 ,γ2 ) ≥ DEMO) (1 {X0 β1 ≥ 0} − 1 {X0 β2 ≥ 0})
=: A1 + A2 + A3 .
Some reparameterization and change of variables are useful. In particular to impose the
normalization restriction, |θ| = |b| = 1, we characterize the localized parameters as
hn =  
0
0
hnβ ,hnα
r1 −
,hnb 
0
0
DEMO
θ /rn
2
0
h˙
0
β /rn
,hα /rn, r1 −
0
b /rn β0 +
h˙
0
b
/rn!
0
,
0
h˙
2
=
β0 +
where
h˙
β
,DEMO
h˙
b
< K and
h˙
β
and
h˙
b
are orthogonal to β0 . Note here that since α0 = 0 the
parameter DEMO is not constrained. Let gn be deﬁned in the same way. Note here that we
index by h and g rather than h1 and DEMO to ease the exposition. Accordingly, decompose x
into
(A.3)
x = ζβ0 + η,
36
LEE, SEO, AND SHIN
where β 0 η = 0. DEMO, x0 hnβ = ζr1 −
h˙
θ /rn
2
+ η 0
h˙
β /rn. Now, take A1 and note that
0
DEMO = rn P1 {g (W,θ1 ,γ1 ) ≥ 0 > g (W,θ2 ,γ2 )} + rn P1 {g (W,DEMO ,γ2 ) ≥ 0 > g (W,θ1 ,γ1 )} .
Let Zγ = Z 1 {T > γ} and pW (x, w−x) = pW (w) for W =  X0 ,
W 0
−x

0
. Also recall that
z = R0 x DEMO R0 β0 ζ + R0 η and let Rγ = R1 {T > γ} . Take the ﬁrst term with substitution of
(A.3) , θ1 = hnθ and θ2 = gnθ , that is, consider
DEMO P (ζ r1 −
h˙ θ
rn
2
+
β0
0 DEMO hα
rn
η 0
! + rn 
h˙
β
+ Rγ1hα 
≥ 0 > ζ r1 −
2
g˙ θ
rn
+
DEMO
0 Rγ2 gα
rn
η 0
! + rn
(˙g
β
DEMO becomes, after rearranging terms and changing the variable ξ =
(A.4)
ZZ 1 
−q1−|
0 β0 = 0} pW
η0(
DEMO
h˙
β +Rγ1 hα )
θ /rn |
2
−β0
0 Rγ1 hα /rn
ζ˙ β0
rn
+
≤
ζ <˙
×1
DEMO
η, w−x!d
−√
η0(
g˙
β +Rγ2 gα )
1−|
g˙
θ /rn |2 −β
0
0 Rγ2
ζd$,˙
ζ/r˙
n,
+ Rγ2gα )),
gα /rn

and converges DEMO
Z η
0
h
h˙
β −
g˙
β
 + R (hα 1 {t > γ1 } − gα 1 {t > γ2 })i
+
1 {η 0 β0 = 0} pW (η, DEMO) d$,
where (x)+ = x1 {x > 0} and $ denote the Lebesque measure on {w : x0 β0 = 0} DEMO The
convergence follows from the dominated convergence theorem.
Then, after sorting DEMO notation, the limit function of A1 with ξ1 = hn and DEMO = gn can
be represented by
ZZ
0
wγ1hθ
−
0
wγ2gθ
1 {x0 β0 = 0} pW (w) d$,
where hθ DEMO gθ take values on the space orthogonal to θ0 . By the same reasoning, that of
A2 is given by
ZZ |x0 [(hb − gb )]| 1 {x0 β0 = 0} pW (w) d$,
TESTING FOR THRESHOLD EFFECTS 37
where hb and gb orthogonal to β0 DEMO
Note that the limit of A1 (and A2 ) is an DEMO of the length of the interval between
two points indexed by (DEMO ,γ1 ) and (gθ ,γ2 ) (and by hb and gb ) and that the limit of A3 is a
composite of DEMO and intersection of the two intervals. Then, using the notation in DEMO
text, we can write
E (G1 (h,γ1 ) − DEMO (g,γ2 ))2 = Z ` (w; h,g,DEMO ,γ2 ) 1 {x0 β0 = 0} pW (w) d$,DEMO
hb )+. We analyze|hα − gα | (1 +r Poq(1)) .
for h and g in the null space of ξ0 DEMO It can also be seen that the condition (5.2) in Assumption
5.3 is satisﬁed, observing (A.4) is bounded byr 2 = r 2 P ( h˙
Next, turn to G2 (h,γ) DEMO n Pmhn ,γ n
2 P
limit of rn
β −
DEMO
β
2
n h ,γ
, then the
θ θ
2
DEMO be derived in the same way. Write rn Pqhθ ,γ = DEMO + B2n , recalling
(A.2) , where
(κ (W) DEMO {X0 β0 < 0 ≤ g (W,hn ,γ)})
E (κ (W) 1 {X0 β0 ≥ 0 > g (DEMO,hn,γ)}) .
= r 2 E
n
B1n
2
DEMO
−r
B2n =
The ﬁrst term B1n can be written as, DEMO the decomposition of x in (A.3) and keeping
the relevant notation there,
rn ZZ 1  0
η0(h˙ β +Rγ hα )
(A.5a) B1n =
ζ <˙
≤
−q1−|
×1 {η 0 β0 = 0} κ
2
θ /rn |
h˙ −
β0
0 Rγ hα /rn
!pW + η, w−x!d
ζ˙ β0 + η, w−x ζ˙ β0 ζd$,˙
(A.5b) rn rn
which, using the fact that κ (w) = 0 for w such that x0 DEMO = 0 and an expansion for κ with
a mean value ζ,˜
ζ˙
ζ˜ β0 + η, w−x! rn β0 !,
rn
+ η, w−x! = κ (η, w
ζ˙ β0 ) + ∂ κ
κ rn −x ∂x0
g˙
q˜
q˜
hb
q
h ,γ
38
LEE, SEO, AND SHIN
converges by the dominated convergence theorem DEMO
Z 1
1
= − 2 Z
ζ˙
n−x
x0 
0

h˙
h˙
β
β
+ Rγ hα  ≤
+ Rγ DEMO 
2
ζ <˙
0o 1 {x0 β0 = 0} [(DEMO/∂x0 ) κ (w) β0 ] pW (w) d
1 {x0 β0 = 0} [(∂/∂x0 ) κ (w) β0 DEMO pW (w) d$.
ζd$˙
Similarly, we can see that B2n DEMO (−B1n ) →
0. And the limit of r 2 P
DEMO
q˜
hb
is also obvious.
Since this result also implies (5.8) , we veriﬁed all the conditions of Theorem 5.1.
Appendix B. Estimation DEMO on U -Processes
In this section, we provide asymptotic theory for DEMO case with objective functions based
on U-processes. To do so, let DEMO denote the random discrete measure putting mass 2/n(n −
1) for each of the points {(Yi, Wi ,Yj , Wj ) : 1 ≤ i < j ≤ n}. Since we assume DEMO χ in
(2.2) depends on (θ,γ) only through the regression function g (W,θ,γ) in this case as well,DEMO
arguments identical to those in Section 5.1 yields
where
2
QLRn = rn
= r 2
n
µξ,γ (yi , wi ,yj , wj ) := χθ,γ (yi , wi ,yj , DEMO ) −
χ˜
sup Qn (θ,γ) − sup Qn (DEMO)
θ,γ
β
sup  sup Un µξ,γ − sup (−Un µξ,γ ) ,
γ
ξ :b=β0
ξ :θ =θ0
b (yi, wi ,yj , wj )
and ˜χ
DEMO
b := χ(b0 ,0)0 ,γ . Therefore, QLRn is a continuous transformation of rn Un mξ,γ . General
theory DEMO U-processes provides a method for approximating r 2
n Un mξ,γ
by its projection
uniformly in ξ and γ (e.g. see Ghosal et al., 2000, Appendix). Therefore, the derivation
of the asymptotic null distribution is similar to that of Section 5.1.
In this section, we consider the case with rn = n1/2 since all the estimators, which we
are aware of, based on U-Processes are n−1/2 consistent. To state an additional regularity
condition for this section, consider a class of functions
Mδ = {χθ,γ − χθ0 ,γ : |θ − θ0 | < δ,γ ∈ Γ}
with an envelope function Mδ .
TESTING FOR THRESHOLD EFFECTS 39
Assumption DEMO (Envelope Function and Entropy Condition). (1) Let Q denote DEMO
product measure P ⊗ P. Then, QM 2
K/n1/2
DEMO > 0, we have that
→ 0 for any positive K < ∞. (2) For some
Z
0
1
sup sup log N ε kMδ kQ,2 , Mδ ,L2 (Q) dε < DEMO
δ<δ0
Q
The ﬁrst condition in Assumption B.1 is reasonable given that Mδ is deﬁned only for
a local neighborhood around θ0 . DEMO entropy condition here is more stringent than that
of Assumption 5.4. However, VC classes of functions have the covering numbers that are
bounded by a polynomial in ε−1 , thus still satisfying condition (2) of DEMO B.1 as
long as the VC indexes are bounded in n.
Consider a class of functions ¯δ that is the same as in (5.1) with q = Πχ, where
F
Πχθ,γ (y, w) = 2 [Eχθ,γ (Y, W,y, w) − Qχθ,DEMO ] .
An envelope function for ¯δ
F
is denoted by
F¯
δ . In addition, deﬁne
Πµξ,γ (y, w) = DEMO [Eµξ,γ (Y, W,y, w) − Qµξ,γ ] .
The following theorem establishes the asymptotic null distribution when an estimator DEMO a
maximizer of a U-Process.
Theorem B.1. Let Assumptions 5.1 and 5.2 hold with rn = n1/2 . Let Assumption 5.3
hold with DEMO =
F¯
δ
and q = Πχ, and Assumption 5.5 hold DEMO m = Πµ. In addition, let
Assumption B.1 hold. Then
QLRn DEMO sup  sup G (h,γ) − sup (−G (h,γ)) ,
γ
h:hb =0
h:hθ =0
where DEMO = G1 + G2 is redeﬁned suitably with m = Πµ.
40
Proof of Theorem B.1. Deﬁne
U
bn µξ,γ := Qµξ,γ + Pn Πµξ,γ .
Then by Theorem A.1 of Ghosal DEMO al. (2000) and comments following this theorem, there
exists a DEMO constant C < ∞ such that
E
≤
sup
µξ,γ ∈MK/n1/2
|Unµξ,γ − bn µξ,γ |!
Cn−1 (QMK/n2 1/2)1/2 Z sup
0
Q
log N ε
= DEMO(n−1 ),
MK/n1/2
Q,2
, MK/n1/2 ,L2 (Q) dε
U
1
LEE, SEO, AND SHIN
DEMO the last equality follows from Assumption B.1. Then since PΠµξ,γ = 0 and rn = n1/2 ,
r 2
√nnGn Πµξ,γ + op (1),
uniformly over Mδ . All regularity conditions DEMO Theorem 5.1 are assumed directly ex-
cept for Assumption 5.4. By Lemma A2 of Ghosal et al. (2000), the entropy condition
r 2 = r 2
n Un µξ,γ n Qµξ,γ
+
we DEMO that
of Assumption B.1 is suﬃcient for Assumption 5.4. Therefore, Theorem DEMO proves this
theorem.
Since the asymptotic distribution is identical to the M-estimation case with the projected
function Πµξ,γ , a corollary similar to DEMO 5.5 can be established. The discussion
following the corollary is also valid. Therefore, if Qχθ,γ is twice diﬀerentiable at θ0 with
relevant rank conditions satisﬁed and if G1 is linear in h, then the asymptotic representation
in (5.10) would be obtained.
TESTING FOR THRESHOLD EFFECTS 41
B.1. Maximum Rank Correlation Estimation. The objective DEMO of the maxi-
mum rank correlation (MRC) estimator is a second-order U-process with kernel
χ (y1 , w1 ,y2 , w2 ; DEMO,γ)
:= 1 {y1 > y2 } 1 {g (w1 ,θ,γ) > g (w2 ,θ,γ)} + 1 DEMO < y2 } 1 {g (w1 ,θ,γ) < g (w2 ,θ,γ)} .
Recall that the MRC estimator can be applied to a general regression model deﬁned as
Y = H ◦ DEMO (g (W,θ0 ,γ0 ) ,U) ,
where H is a non-degenerate monotone function and F is a strictly monotone function
DEMO both arguments. To provide its asymptotic null distribution, we need to DEMO the
separability condition, Assumptions 5.3, 5.5, and B.1. We assume DEMO following conditions
which are slight modiﬁcation of the standard regularity conditions of the MRC estimator
in Sherman (1993) to reﬂect the threshold eﬀects.
DEMO B.2. (i) The ﬁrst element of θ, say θ1 , DEMO normalized to be 1.
(ii) The ﬁrst component of W has an everywhere positive Lebesgue density conditional on
the remaining components W
w
DEMO
f = e for all e.
(iii) W is independent of U, and the support of Wγ is not contained in any proper linear
subspace of
Rdim(X)+dim(Z)
for any γ.
(iv) T is continuously distributed.
(v) Let N be a neighborhood of θ0 . Then, the following conditions hold: (a) all mixed DEMO
partial derivatives of Πχθ,γ with respect to θ exist on N for all γ ∈ Γ; (b) There exists an
integrable function M (y, w) such that
sup |rθθ0 Πχθ,γ (Y, W) − rθθ0 Πχθ0 ,γ (Y, W)| ≤ M (Y, W) |θ − θ0 | ;
γ
(c) supγ P |rθ Πχθ0 ,γ |2 < ∞; (d) supγ P DEMO
negative deﬁnite for all γ ∈ Γ.
i,j
∂ 2
∂θi ∂θj
Πχθ0 ,γ
< ∞; and (e) Prθθ0 Πχθ0 ,γ is
42
LEE, SEO, AND SHIN
Since the functions H and F DEMO monotone, the support condition of W implies that
Pr (Y1 > Y2 |W1 , W2 ) > Pr (Y1 < Y2 |W1 , W2 ) ⇔ g (W1 ,θ0 ,γ) > g (W2 ,θ0 ,γ)
for any γ. This condition combined with the DEMO arguments in Han (1987) com-
pletes the separability condition. We next turn our attention to Assumption B.1. Consider
the class of functions
MK/DEMO/2 = χθ,γ − χθ0 ,γ : |θ − θ0 DEMO < K/n1/2 ,γ ∈ Γ .
From the arguments DEMO Section 5 of Sherman (1993) and in the example of maximum score
estimation, we can show that MK/n1/2 is a VC-class of functions and that MK/n1/2 has an
envelope function MK/DEMO/2 = 1 |x0 β0 | ≤ C  K/n
1/2
 |x| for a constant C. Therefore, it
satisﬁes the conditions in Assumption B.1. To verify Assumption 5.3, consider the following
class of projected functions
FK/n1/2 = Πχθ,γ − Πχθ0 ,γ : |θ − θ0 | < K/n1/2 ,γ ∈ Γ .
¯
Then, Assumptions 5.3 follows from the ﬁnite envelope and the smoothness condition of
Πχθ,γ . It remains to show Assumption 5.5. However, it follows from the diﬀerentiability of
Πχθ,γ that the asymptotic representation in (5.10) applies. In particular, the covariance
kernel of G (γ) DEMO given by P (rθ Πχθ0 ,γ1) (rθ Πχθ0 ,γ2)0  and V (γ) = Prθθ0 Πχθ0 ,γ .
Appendix C. Consistency and Local Power
In this section, we present asymptotic properties of our test statistic when the null
hypothesis is false. We ﬁrst DEMO a ﬁxed alternative g (w) such that
g (w) = x0 β,
for any β. Let P1 denote the common probability DEMO under this alternative.
TESTING FOR THRESHOLD EFFECTS 43
Theorem C.1. Let F be a class DEMO functions qθ,γ with envelope F such that P1 F < ∞. As-
sume either of the following two conditions: (i) N[ ] (ε, F ,L1 (P1 )) < ∞ for every ε > 0; (ii)
For FM deﬁned as the class of DEMO f1 {F ≤ M } for f ∈ F , log N (ε, FM ,L1 (Pn )) =
op (n) for every ε and M > 0. Let Q1 (θ,γ) = DEMO qθ,γ and assume that there exists (θ,γ) such
that Q1 (θ,γ) > supθ :α=0 Q (θ,γ) . Then, the test QLRn is consistent against the alternative
g, that DEMO, the rejection probability of our test goes to one under P1 DEMO
This theorem states conditions under which our test is consistent. This theorem might
not be very constructive to convey some meaningful insight into what DEMO our test
can detect as it is diﬃcult to determine the functional form of Q1 without a speciﬁc q and
P1 . Roughly speaking, however, it implies that the test can detect an alternative which is
better approximated by a piecewise linear structural form than linear one. Clearly, if
g (w) = x0 β0 + z0 α0 1 {t > γ0 }
for some α0 = 0, the test is consistent DEMO the other conditions of the above theorem.
Furthermore, Theorem C.1 suggests DEMO the test be powerful against some other nonlinear
alternatives, as we DEMO via Monte Carlos experiments in Section D.
Next, we investigate the DEMO power property of our tests under sequences of local
alternatives:
gn (w) = x0 β0 + ρ−1 · x0 α (t) ,
n
where α is a vector-valued integrable function deﬁned on the DEMO of T and ρn → ∞.
This alternative is a natural generalization of the threshold model to encompass smooth
transition models and varying coeﬃcient DEMO Let Pn denote the probability measure
for each n under the local alternatives. As above, general statement is less informative
than examination of speciﬁc examples since local power depends largely on whether or not
the limit DEMO rn Pn mhn ,γ is diﬀerent from that of rn Pmhn ,γ .
When ρn = rn , the local asymptotic distribution of DEMO under Pn can be obtained
under minor modiﬁcation of previous assumptions. We discuss this. We keep Assumption 1
44
LEE, SEO, AND SHIN
and 2. Assumptions 3-5 need to DEMO restated in terms of Pn. The uniform entropy condition
(5.3) in Assumption 4 remains the same since it does not depend on the DEMO measure (see
e.g. section 2.11.1 of van der Vaart and Wellner (1996)). Lemmas 1 and 2 are valid under
these modiﬁcations on Assumption 3 and 4 and thus Assumptions 1 and 2 can be DEMO
in the same way as under the null. The limit quantities in Assumption 5 would not the
same as those under P. Either of DEMO covariance kernel of G1 or the functional form of G2
or both change under Pn , yielding the local power. The methods to verify DEMO
1-5 are similar as under P. When Pmξ,γ is twice diﬀerentiable, its ﬁrst derivative is zero
at ξ = ξ0 , where ξ0 := (β 0 , 00 ,β 0 )0 , and DEMO is quadratic in its second derivative. On the
0
0
other hand, the ﬁrst derivative of Pn mξ,γ is not zero at ξ = ξ0 but rn (∂/∂ξ) Pn mξ0 ,γ has
a non-vanishing limit. This is usually called the “noncentrality parameter”, which is the
source of the local power and yields the consistency when ρn = DEMO (rn ) . All of our examples
have nontrivial noncentrality parameters.
DEMO now present two of previous examples to illustrate power properties of our test, fo-
cusing on the noncentrality parameter. First, consider the maximum DEMO estimation of
the binary response model. We begin with r 2 . As shown in section 6.1, r 2
n Pn mhn ,γ DEMO Pmhn ,γ
converges to a quadratic function in h without a DEMO term as the ﬁrst term in the ex-
pansion vanishes under P. We show that the linear term does not vanish under Pn. In
DEMO, note that κ (w) in (6.2) need to be DEMO by
κn (w) = 1 − 2FU |W −x0 β0 − r
= κ (w) + 2fU |W −x0 β0
−1 x0 α (t)
n
|w
− ρ−1 · x0
α˜
(t) |w
n
DEMO x0 α (t) ,
n
where ˜α
is the mean DEMO Then, following the steps to derive the limit of r 2
DEMO Pmhn ,γ
in
the proof of Theorem 6.1 with κ (w) replaced by κn (w) , we can see that the diﬀerence
r 2
n Pnmhn
,γ −
r 2
n Pmhn ,γ ,
that is, the noncentrality parameter is given by
2 Z Z α (t)0 (xx0 (hβ − hb ) + xx0 1 {t > γ} hα )
rn 1
ρn {x0 β0 = 0} fU |W (0|
w) pW (w) d$.
TESTING FOR THRESHOLD EFFECTS 45
If α (T ) is nonzero with positive probability, then the noncentrality parameter is nonzero
for some γ, DEMO of h unless hα = 0. On the other hand, we DEMO easily see from the
proof of Theorem 6.1 that the covariance kernel of G1 does not change. Therefore, our test
has local power with ρn = rn and is consistent when ρn = o (rn ) .
Next consider the MLE of the probit model. Let ρn = DEMO = √n and examine the score
functions for q (y, w; θ,γ
) and ˜q
(y, w; b) under Pn . Their expected values are zero under
P but non-zeros and diﬀerent DEMO each other under Pn, which yields the noncentrality
parameter. In particular, a direct calculation of the expected value with an expansion of
the DEMO Φ (x0 β0 + x0 α (t) /√n) at DEMO β0 yields
√nPn ∂
∂θq (y, w; θ0 ,γ) DEMO E
  X1 {T > γ} φ X0 β0 +
Φ (φ (−XX0 β0 β0 )0 )  X1 {T > γ} φ −X
φ (X0 β0 )
Φ (X0 β0 )
DEMO
X
+E
→
E

φ2 (X0 β0 )
Φ (DEMO β0 ) Φ (−X

X0
α˜
(T )
√n
DEMO β0 − X0
α˜
 X0 α (T )
√(Tn) X0 α (T )

0 β0 )

XX 0 α (T )
XX 0 1 {T > γ} α (T )

,
where ˜α
lies between α and 0. DEMO,
√nPn ∂
∂b
q˜
φ2 (X0 β0 )
(y, w; β0 ) → E Φ (X0 β0 ) Φ (−X0 β0 ) XX 0 α (T ) .
Then, the noncentrality parameter becomes
φ2 (X0 β0 )
E Φ (X0 β0 ) Φ (−X0 β0 ) XX 0 α (T ) 1 {T > γ} = 0
for some γ as long as α (T ) is not zero with positive probability. Therefore, the test has non-
DEMO local power against local alternatives of the above form as well as of the threshold
type. Furthermore, if ρn = o (√n) , then the noncentrality parameter diverges to inﬁnity
to yield the consistency of DEMO test.
46
LEE, SEO, AND SHIN
Appendix D. Monte Carlo Simulations
In DEMO section we investigate ﬁnite sample properties of the proposed test by Monte Carlo
experiments. we report Monte Carlo simulation results for all four examples DEMO in
the article.
D.1. Binary Response Models: Probit, Logit, and DEMO Score. First, we
report Monte Carlo simulation results when the samples DEMO generated from a simple probit
or logit model. To see whether the test has power against an alternative that is diﬀerent
from a threshold DEMO, we consider the smooth transition model as well as the threshold
DEMO as alternatives. Therefore, we have 4 diﬀerent models in total, and the baseline
model has the following form:
Y
∗
= β0 DEMO β1 X + αZψ (T,γ) + U
Y = 1 {Y
∗
> 0} ,
where ψ (T,γ) = 1 {T > γ} for the threshold model and ψ (T,γ) DEMO 1/ (1 + exp (− (T − γ)))
for the smooth transition model. The true parameter values are set as DEMO = 0.5, β1 = 1,
γ = 0.5 for the DEMO model, and γ = 0 for the smooth transition model. When DEMO null
hypothesis is true, the parameter α is equal to zero. DEMO the alternatives, α has various
non-zero values from 0.2 to 1. DEMO covariates X and Z are generated independently from
N (0, 1) and N (0, 2), respectively. The covariate T follows the uniform distribution on the
interval [0, 1] for the threshold model and N (0, 1) for the smooth transition model. The
error term U is generated from either N (0, 1) or the logistic distribution.
Parameters other than γ are estimated by the Newton-Raphson’s method, and the thresh-
old parameter γ is estimated by the grid search. For DEMO grid, we used the data points of T
after trimming at DEMO and upper 10th percentiles. We considered three diﬀerent sample
sizes, n DEMO 50, 100, and 200, and replicated each simulation design 1000 DEMO For the
simulation number of the score functions, we set J DEMO 2000.
TESTING FOR THRESHOLD EFFECTS 47
1
0.8
0.6
0 4
.4
0.2
DEMO
1
0.8
0.6
0 4
.4
0.2
0
n=200
n 100=100
n=50
size: 5%
Figure 2. Power Functions of Threshold Models
Threshold Probit
1
Threshold Logit
0.8
n 100
n=50
size: 5%
=100
n=200
0.6
0 4
.4
0 0.2 0.4 0.6 0.8 1
n=200
n 100=100
n=50
DEMO: 5%
Slope Variable
0.8
n=200
n=100
n=50
size: 5%
0.6
0.2
0 0.2 0.4 0.6 0.8 1
Slope Variable
Figure 3. Power Functions DEMO Smooth Transition Models
Smooth Transition Probit
1
Smooth Transition Logit
0.4
0 0.2 0.4 0.6 0.8 1
Slope Variable
0.2
0 0.2 0.4 0.6 DEMO 1
Slope Variable
0
0
Figures 2–3 summarize the result of the simulation study. Overall, the test performs well
as expected from the theory. First, under the null hypothesis (α = 0), the rejection DEMO of
the test are close to the nominal level in most cases. Second, Figures 2–3 show the power
of the test when α increases from 0 to 1. The result indicates that, in all cases, DEMO power
increases fast as the parameter value of α is farther away from zero. The test shows good
performance even with a relatively small DEMO size, say n = 100.
We now report simulation results for DEMO the null hypothesis that α0 = 0 for the
probit threshold model above with the maximum score objective function. This amounts
Power
Power
Power
DEMO
48
LEE, SEO, AND SHIN
Figure 4. Power Functions of the DEMO Threshold Model with Maximum
Score Estimation
Threshold MSE
0.6
0.4
0.2
0.0
0 0.2 0.4 0.6 0.8 1
Slope Variable
1.0
0.8
n=200
n=100
DEMO
size: 5%
to the case when a researcher only relies on DEMO assumption that U has conditional median
zero without knowing that U follows the standard normal distribution. The critical values
are obtained via subsampling. The DEMO sizes (m) and original sample sizes (n) were
(m,DEMO) = (20, 50), (30, 100), (35, DEMO), respectively.
Figure 4 shows the power functions with the 5% level test. Not surprisingly, relative to
the left panel of Figure 2, DEMO power does not increase rapidly as α gets large or n increases.
Note that this is consistent with the theoretical result that the test DEMO the maximum score
estimation has local power at a rate of n−1/3 .
D.2. Quantile Regression. In this section we investigate ﬁnite sample DEMO of the
proposed test for the quantile regression model. In particular, DEMO consider the median
regression model (τ = 0.5):
Y = β0 + β1 X + αZψ (T,γ) + U,
DEMO ψ (T,γ) = 1 {T > γ}. The true parameter values are set as β0 = 0.5, β1 = 1,
γ = 0.5. When the null hypothesis is true, the parameter α is equal to zero. Under the
alternatives, α has various non-zero values from 0.2 to 1. The covariates X and Z are
generated independently from DEMO (0, 1) and N (0, 2), respectively. The DEMO T follows
Power
TESTING FOR THRESHOLD EFFECTS 49
the uniform distribution on the interval [0, 1] for the threshold model. The error term U is
generated from DEMO standard normal distribution.
Parameters other than γ are estimated by the linear programming method for the stan-
dard linear quantile regression model, and the threshold parameter γ is estimated by the
grid search. For the grid, we use the data points of T after trimming at lower and DEMO
10th percentiles. We consider three diﬀerent sample sizes, n = 50, 100, and 200, and repli-
cate each simulation design 1000 times. DEMO the simulation number of the score functions,
we set J = 2000.
In addition, we estimate b(γ) and e by (3.9) since regression errors are independent of
V
V
regressors. Finally, we DEMO the standard normal density as the the kernel function K and
Silverman’s rule of thumb for h = 1.06 ×
:= Yi −
of
U˜
X0
i
β˜.
σn˜
−1/5
, where ˜σ
is the DEMO standard deviation
Figure 5. Power Functions of Threshold Quantile Regression Models
Threshold Quantile
0.6
0.4
0.2
0.0
0 0.2 0.4 0.6 0.8 1
Slope DEMO
1.0
0.8
n=200
n=100
n=50
size: 5%
Figure 5 shows the DEMO functions for the 5 % level test. Under the null of α = 0, the
rejection rates of the test are about 2% lower than the nominal level. The ﬁgure shows the
power of the test DEMO fast as α or n gets large.
Power
50
LEE, SEO, AND SHIN
D.3. Maximum Rank Correlation Estimation. For DEMO simulation study of the MRC
estimator, we use the following data DEMO procedure:
T (Y ) = β1 X1 + β2 X2 DEMO αZ · 1 (T > γ) + U
where covariates, DEMO , X2 , Z and T, are generated independently from N (0, 4) ,N (0, 1) ,N (0, 1) ,
and the uniform distribution on the interval [0, 1] , respectively. The error term U is gen-
erated from N (0, DEMO) . We set the transformation function T (y) log y. DEMO parameter β1 is
normalized as 1, and other parameters are set DEMO β = 1 and γ = 0.5. The parameter α is
equal to zero under the null hypothesis, and varies from 0.2 to 1 under the alternatives.
Note that the constant term is not identiﬁed in DEMO unknown transformation model, so we
drop it from the model.
We DEMO all parameters using the grid search. The girds used for each parameter
are as follows: the 51 points equally spaced on the interval [−1, 3] are used for estimating
β2 , the 51 points on [−1, 2] for α, and the 36 points on [0.1, 0.9] for γ. We consider three
sample sizes, n = 50, 100, and 200, and replicate each design 1,000 times. We calculate the
simulated p-value with J = 1, 000.
Figure 6. Power Functions of Threshold Models with Maximum Rank Cor-
relation Estimation
Transformation Model (MRC)
n=200
n=100
n=50
size: 5%
1.0
0.8
0.6
0.4
0.2
0.0
0 0.2 0.4 0.6 0.8 1
Slope Variable
Power
TESTING FOR THRESHOLD EFFECTS 51
Simulated critical values can be obtained using DEMO derivatives as in Section 7 of
Sherman (1993). Speciﬁcally, we use the smooth objective function in the simulation step
by substituting the DEMO normal cdf for the indicator function with an appropriate
bandwidth. Figure 6 shows the power functions for the 5 % level test. Overall, test seems
to perform well as in previous examples.
We now explain how DEMO obtain critical values in detail below:
(1) Given the data, estimate the parameter under the null and the alternative, e and
DEMO,ˆ γˆ
, respectively. Construct the test statistic QLRn using the DEMO
(2) Recall some notation here:
and
Qn (θ,γ) = Unχθ,γ (Yi , Yj , Wγ,i , Wγ,j )
=
n (n − 1)
X
=j
1 (Yi > Yj ) 1  W
1
i
0 θ > W 0
DEMO,i γ,j
θ
µξ,γ (Yi,Yj ,
Wi , Wj ) == 1 (χ(YYii ,> YYj ,jW) 1γ,DEMO ,WWγ,j ) − χeb(Yi , Yj , Xi , DEMO )
0 θ > W 0
γ,i γ,j
θ DEMO 1  X
0 b > X0
i j
b.
Replace indicator functions in the objective function with the standard normal cdf.
Now, µξ,γ is twice diﬀerentiable with respect to ξ (slightly abuse notation and use
the same µ,χ etc.) The ﬁrst order derivative of µξ,γ is
where
∂ χθ,γ
∂θ
∂ χb
∂b
e
= Φ DEMO −a Yj φ (Wγ,i −aWγ,j )0 θ Wγ,DEMO −a Wγ,j
= Φ Yi −a Yj φ (Xi −aXj )0 b Xi −a Xj .
∂ µξ,γ
∂ξ
=

∂ χθ,γ
∂θ
∂ χb
− ∂b

,
e
β
52
LEE, SEO, AND SHIN
The bandwidth a is set as DEMO = 2ˆ
σn(−3/5)
where ˆσ
is the sample standard deviation
of the argument in the function, i.e. Yi − Yj , (Wγ,i − Wγ,j )0 θ etc. The second
derivative DEMO
∂
∂ξ∂ξ 0
µξ,γ =

∂ 2
∂θ∂θ0
χθ,γ
0
0
∂ 2
− ∂b∂b0
where diagonal elements can be computed DEMO e
χb

,
(3) To generate the simulated empirical DEMO, say U
b n, for each (i,j), we DEMO
tiply Vij = Vi + Vj to µξ,γ (Yi ,Yj , Wi , Wj ), where V and V are generated from
Gamma(0.25, 0.5), independently.
i
j
(4) Then the simulated test statistic is
sup
γ
1
2
rn b
n
− Un DEMO
∂ µ
∂ξ
ξ,γ˜

0
∂ 2
−Un ∂ξ∂ξ 0 µ
ξ,γ˜

−1
r
n
b
n
− Un 
DEMO µ
∂ξ
ξ,γ˜
 .
U
(5) Simulate the same statistic J times for a large J, and calculate the simulated p-
U
value as in the main text (that is, the proportion DEMO simulated test statistics that
are greater than the original test statistic).
References
Abrevaya, J. (1999). Leapfrog estimation of a ﬁxed-eﬀects model DEMO unknown transfor-
mation of the dependent variable. Journal of Econometrics 93 (DEMO), 203–228.
Andrews, D. W. K. (1993). Tests for parameter instability and structural change with
unknown change point. Econometrica 61 (4), 821–856.
Andrews, D. W. K. (2001). Testing when a parameter DEMO on the boundary of the maintained
hypothesis. Econometrica 69 (3), DEMO
Andrews, D. W. K. and W. Ploberger (1994). Optimal tests when a nuisance parameter is
present only under the alternative. Econometrica 62 (6), 1383–1414.
Andrews, D. W. K. and W. Ploberger (1995)DEMO Admissibility of the likelihood ratio test
when a nuisance parameter is present only under the alternative. The Annals of Statis-
tics 23 (5), 1609–1629.
TESTING FOR THRESHOLD EFFECTS 53
Card, D., A. Mas, and J. Rothstein (2008). Tipping and the dynamics of segregation.
Quarterly Journal of Economics 123 (1), 177–218.
Cavanagh, C. and R. Sherman (1998). Rank estimation for monotonic index models. Jour-
nal of Econometrics 84 (2), 351–381.
Chan, K. S. (1993). Consistency and limiting DEMO of the least squares estimator of
a threshold autoregressive model. Annals of Statistics 21, 520–533.
Cho, J. S. and H. White (2007). Testing for regime switching. Econometrica 75 (6), 1671–
1720.
Cox, DEMO (1987). Threshold dose-response models in toxicology. Biometrics 43 (3), 511–523.
Cox, D. (1972). Regression models and life tables. Journal DEMO the Royal Statistical Society
Series B 34, 187–220.
Cox, D. (DEMO). Partial likelihood. Biometrika 62, 269–276.
Davies, R. B. (1977)DEMO Hypothesis testing when a nuisance parameter is present only under
the alternative. Biometrika 64, 247–254.
Davies, R. B. (1987). Hypothesis testing when a nuisance parameter is present only under
the alternative. Biometrika 74 (1), 33–43.
Delgado, M. A. and J. Hidalgo (2000). Nonparametric DEMO on structural breaks.
Journal of Econometrics 96 (1), 113–144.
Delgado, M. A., J. M. Rodriguez-Poo, and M. Wolf (2001). Subsampling inference in cube
root asymptotics with an application to Manski’s maximum score DEMO Economics
Letters 73 (2), 241–250.
Durlauf, S. N. and P. A. Johnson (1995). Multiple regimes and cross-country growth
behavior. Journal of Applied Econometrics 10 (4), 365–384.
Fan, J., H.-N. Hung, DEMO W.-H. Wong (2000). Geometric understanding of likelihood ratio
statistics. Journal DEMO the American Statistical Association 95 (451), pp. 836–841.
Fan, J., C. Zhang, and J. Zhang (2001). Generalized likelihood ratio statistics and wilks
phenomenon. The Annals of Statistics 29 (1), pp. 153–193.
54
LEE, SEO, AND SHIN
Forbes, K. J. and R. Rigobon (2002). No contagion, only interdependence: Measuring stock
market co-movements. Journal of Finance 57 (5), 2223–2261.
Ghosal, S., A. Sen, DEMO A. W. van der Vaart (2000). Testing monotonicity of regression.
DEMO of Statistics 28 (4), 1054–1082.
Han, A. K. (1987)DEMO Non-parametric analysis of a generalized regression model : The maxi-
mum rank correlation estimator. Journal of Econometrics 35 (2-3), 303–316.
Hansen, B. DEMO (1996). Inference when a nuisance parameter is not identiﬁed under DEMO null
hypothesis. Econometrica 64 (2), 413–430.
Hansen, B. E. (DEMO). Threshold eﬀects in non-dynamic panels: Estimation, testing, and
inference. DEMO of Econometrics 93 (2), 345–368.
Khan, M. S. and A. S. Senhadji (2001). Threshold eﬀects in the relationship between
inﬂation and growth. IMF Staﬀ Papers 48 (1), 1–21.
Kim, J. and DEMO Pollard (1990). Cube root asymptotics. Annals of Statistics 18 (1), 191–219.
Koenker, R. (2005). Quantile Regression, Volume 38 of Econometric Society monographs.
Cambridge University Press.
Kosorok, M. R. and R. Song (2007). Inference under right censoring for transformation
models with a change-point based on a covariate threshold. Annals of Statistics 35 (3),
DEMO
Lee, S. and M. H. Seo (2008). Semiparametric estimation of a binary response model with
a change-point due to a covariate threshold. DEMO of Econometrics 144 (2), 492–499.
Liu, X. and Y. Shao (2003). Asymptotics for likelihood ratio tests under loss of identiﬁa-
bility. Annals of Statistics 31 (3), 807–832.
Manski, C. F. (1975). Maximum score estimation of the stochastic utility model of choice.
Journal DEMO Econometrics 3 (3), 205–228.
Manski, C. F. (1985). DEMO analysis of discrete response. Asymptotic properties
of the maximum score estimator. Journal of Econometrics 27 (3), 313–333.
Manski, C. F. (1988). Identiﬁcation of binary response models. Journal of the American
Statistical Association 83 (403), 729–738.
TESTING FOR THRESHOLD EFFECTS 55
Pastor, R. and E. Guallar (1998)DEMO Use of tow-segmented logistic regression to estimate
change-points in epidemiologic studies. American Journal of Epidemiology 148 (7), 631–
642.
Pastor-Barriuso, R., E. Guallar, and J. Coresh (2003). Transition models for change-point
estimation DEMO logistic regression. Statistics in Medicine 22, 1141–1162.
Pesaran, M. H. and A. Pick (2007). Econometric issues in the analysis of contagion. Journal
of Economic Dynamics and Control 31 (4), 1245–1277.
Pons, O. (2003). Estimation in a Cox regression model with a change-point according DEMO a
threshold in a covariate. Annals of Statistics 31 (2), DEMO
Roy, S. (1953). On a heuristic method of test construction and its use in multivariate
analysis. Ann. Math. Stat. 24, 220–238.
Schwartz, P. F., C. Gennings, and V. M. Chinchilli (1995). DEMO models for combi-
nation data from reproductive and development experiments. Journal of the American
Statistical Association 90 (431), 862–870.
Sherman, R. (1993). The limiting distribution of the maximum rank correlation estimator.
Econometrica 61 (1), 123–137.
Song, R., M. Kosorok, and J. Fine (DEMO). On asymptotically optimal tests under loss of
identiﬁability in semiparametric models. Annals of Statistics 37, 2409–2444.
Tong, H. (1990). Non-linear Time Series: A Dynamical System Approach. New York:
Oxford University Press.
van der Vaart, A. W. and J. A. Wellner (1996). Weak DEMO and Empirical Process.
Springer, New York.
Zhang, J. and P. Cheng (1989). The asymptotic powers of some pp tests. Jour. Sys. Sci.
and Math. Sci. 9, pp. 370–382.
Zhang, J. and G. Li (1993). A new approach to asymptotic distributions of maximum
likelihood ratio DEMO In K. Matusita, M. L. Puri, and T. Hayakawa (Eds.), Statistical
Science and Data Analysis: Proceedings of the third Paciﬁc Area DEMO Conference,
the Netherlands, pp. 325–336. International Science Publishers.
56
LEE, SEO, AND SHIN
Zhu, H. and H. Zhang (DEMO). Asymptotics for estimation and testing procedures under
loss of identiﬁability. Journal of Multivariate Analysis 97 (1), 19–45.
Department of Economics, Seoul DEMO University, 599 Gwanak-ro, Gwanak-gu, Seoul,
151-742, Republic of Korea, and Centre for Microdata Methods and Practice, Institute
for Fiscal Studies, 7 Ridgmount Street, London, WC1E 7AE, UK.
E-mail address: sokbae@gmail.com
DEMO: http://www.ifs.org.uk/people/profile?id=46.
Department of Economics, London School of Economics, Houghton Street, London,
WC2A 2AE, UK.
E-mail address: m.seo@lse.ac.uk
URL: http://personal.lse.ac.uk/SEO.
Department of Economics, University of Western Ontario, 1151 Richmond Street N,
London, ON N6A 5C2, Canada.
E-mail address: yshin29@uwo.ca
URL: http://publish.uwo.ca/~yshin29.{1g42fwefx}