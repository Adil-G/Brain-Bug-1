<-----Page 0----->Testing for threshold effects
in regression models
Sokbae Lee
Myung Hwan Seo
Youngki Shin

The Institute for Fiscal Studies
Department of Economics, UCL
cemmap working paper CWP36/10

<-----Page 1----->TESTING FOR THRESHOLD EFFECTS IN REGRESSION MODELS
SOKBAE LEE, MYUNG HWAN SEO, AND YOUNGKI SHIN
Abstract. In this article, we develop a general method for testing threshold effects in
regression models, using sup-likelihood-ratio (LR)-type statistics. Although the sup-LRtype test statistic has been considered in the literature, our method for establishing the
asymptotic null distribution is new and nonstandard. The standard approach in the literature for obtaining the asymptotic null distribution requires that there exist a certain
quadratic approximation to the objective function. The article provides an alternative,
novel method that can be used to establish the asymptotic null distribution, even when
the usual quadratic approximation is intractable. We illustrate the usefulness of our approach in the examples of the maximum score estimation, maximum likelihood estimation,
quantile regression, and maximum rank correlation estimation. We establish consistency
and local power properties of the test. We provide some simulation results and also an
empirical application to tipping in racial segregation. This article has supplementary materials online.
Key words. Davies problem, empirical process, maximum score estimation, maximum
rank correlation estimation, U-process, threshold model.
AMS Subject Classification. 62F03, 62F05.

Date: 17 November 2010.
We would like to thank Jesse Rothstein for providing the data used in the article and also thank two referees
and an associate editor for their helpful comments. Lee thanks the Economic and Social Research Council
for the ESRC Centre for Microdata Methods and Practice (RES-589-28-0001) and the European Research
Council for the research grant (ERC-2009-StG-240910-ROMETA). Shin thanks the Social Sciences and
Humanities Research Council of Canada (410-2010-0345) for the research grant.
1

<-----Page 2----->2

LEE, SEO, AND SHIN

1. Introduction
This article develops general tests for threshold effects in a variety of regression models,
including mean, median and quantile regression, binary response, censored or truncated
regression, and proportional hazards models as special cases. To illustrate our testing
problem, consider a binary regression model as an example. In this model, an observed
binary outcome Y is modeled typically as Y = 1(Y ‚àó ‚â• 0), where 1(A) denotes the indicator
function, i.e., 1(A) = 1 if A is true and zero otherwise, and Y ‚àó is a latent continuous variable
that determines the binary outcome Y (see e.g. Manski, 1988). Suppose that Y ‚àó has the
following form:
(1.1)
(1.2)

Y ‚àó = g (W, Œ∏0 , Œ≥0) + U,
g (w, Œ∏, Œ≥) = x0 Œ≤ + z0 Œ±1 {t > Œ≥} ,

where W is a vector of regressors that consist of distinct elements of (X, Z, T ), U is an
unobserved random variable, and Œ∏0 := (Œ≤00 , Œ±00 )0 and Œ≥0 are unknown true parameter values
and belong to Œò := B √ó A and Œì, respectively, which are subsets of finite-dimensional
Euclidean spaces. Without loss of generality, assume that the vector Z is a subset of X
such that Z = R0 X for some known matrix R and that T might be an element of X. The
random variable T is the threshold variable and Œ≥0 is the unknown threshold parameter.
Note that we specify the threshold effect as a change-point due to an unknown threshold
in a particular covariate.
Threshold models have a large number of applications in empirical research. In economics and sociology, racial segregation can be modeled as a threshold effect. For example,
Card et al. (2008) recently investigated the existence of race-based tipping in neighborhoods using U.S. Census data. In their setup, the hypothesis of interest is whether there
exist discontinuities in the dynamics of neighborhood racial composition: once the minority share in a neighborhood exceeds a threshold level (‚Äútipping point‚Äù), most of the whites
would leave the neighborhood. In a simple model developed by Card et al. (2008), whites‚Äô

<-----Page 3----->TESTING FOR THRESHOLD EFFECTS

3

willingness to pay for homes depends on the neighborhood minority share. In their model,
the location of the tipping point can vary depending on whites‚Äô preferences, thereby implying that the location of the tipping point is unknown. In Section 4, we illustrate our
methodology by applying it to the data used by Card et al. (2008).
There are more examples of threshold models. In economics, Durlauf and Johnson (1995)
argue that cross-country growth models with multiple equilibria can exhibit threshold effects. In addition, Khan and Senhadji (2001) examine the existence of threshold effects
in the relationship between inflation and growth. In empirical finance, Pesaran and Pick
(2007) argue that the effect of financial contagion (see, e.g. Forbes and Rigobon, 2002)
can be described as a discontinuous threshold effect, hence testing for threshold effects
implies testing for the presence of financial contagion. In biostatistics, dose-response models are typically specified with some unknown threshold parameters (see, e.g. Cox, 1987;
Schwartz et al., 1995). In epidemiology, logistic regressions with unknown change-points
are used to model the relationship between the continuous exposure variable and disease
risk (see Pastor and Guallar, 1998; Pastor-Barriuso et al., 2003).
We consider a test of no threshold effect against the presence of threshold effects. That
is, the null and alternative hypotheses are that
H0 : Œ±0 = 0 for any Œ≥0 ‚àà Œì vs. H1 : Œ±0 6= 0 for some Œ≥0 ‚àà Œì.
In general, unknown parameters in (1.2) are identifiable under the alternative hypothesis;
however, the threshold parameter Œ≥0 is not identified under the null hypothesis. This feature
that the threshold parameter is not identified under the null hypothesis is an example of
the so-called ‚ÄúDavies problem‚Äù (see Davies, 1977, 1987).
As common in the literature (see, e.g., Andrews and Ploberger, 1995; Hansen, 1996;
Andrews, 2001), we develop our tests following Roy‚Äôs union-intersection principle (Roy,
1953) to deal with the Davies problem. Specifically, in our setup, we suppose that there
exist an objective function and a corresponding extreme estimator for the null hypothesis

<-----Page 4----->4

LEE, SEO, AND SHIN

of no threshold model and those for the alternative hypothesis of a threshold model. Then
our test statistic is based on the difference between the maximum values of the objective
functions under the null and alternative hypotheses. This test statistic can be viewed as a
sup-likelihood-ratio (LR)-type statistics.
The main objective of this article is to provide a general testing framework in regression
models using the sup-LR-type statistic under weak conditions. Most of the prior literature
has focused mainly on applications in time series analysis (see, e.g., Tong, 1990; Chan, 1993;
Andrews and Ploberger, 1994; Hansen, 1996; Cho and White, 2007). More recently, threshold models have been considered for nonparametric models (e.g. Delgado and Hidalgo,
2000), for panel data models (e.g. Hansen, 1999), for transformation models (e.g. Pons,
2003; Kosorok and Song, 2007), and for binary response models (e.g. Lee and Seo, 2008),
among others.
In this article, we focus on cross-sectional applications and aim to provide a unifying testing framework that includes objective functions that are sufficiently different from standard
log-likelihood functions. For example, we consider an objective function for the maximum
score estimator (Manski, 1975, 1985), and also consider an objective function based on
U-processes such as the maximum rank correlation estimator (Han, 1987). To our best
knowledge, we are the first to propose tests for threshold effects that can include maximum
score and maximum rank correlation estimators as special cases.

1.1. Related Literature. Although the sup-LR-type test statistic is well known in the
literature, our method for establishing the asymptotic null distribution is new and nonstandard. The standard approach in the literature for obtaining the asymptotic null distribution
requires that there exist a certain quadratic approximation to the objective function (see,
e.g., Andrews, 2001; Liu and Shao, 2003; Zhu and Zhang, 2006; Song et al., 2009). For example, Andrews (2001) assumes that the objective function has a quadratic expansion in
identifiable parameters for each value of a nuisance parameter that is unidentified under the
null hypothesis. In this article, we provide an alternative, novel method that can be used

<-----Page 5----->TESTING FOR THRESHOLD EFFECTS

5

to establish the asymptotic null distribution, even when the usual quadratic approximation
such as one in Andrews (2001) is intractable (see Section 3 for details). For example, no
existing method can be applied to the objective function for the maximum score estimator.
However, it is worth noting that when quadratic approximations are available, Andrews
(2001) covers a more general case such as one where parameter vectors may lie on the
boundary of the parameter space under the null hypothesis.
In the literature, there exist articles that establish asymptotic distributions for likelihood
ratio types of statistics, without requiring usual asymptotic quadratic approximations. For
example, Fan et al. (2000) establish that Wilks results hold as long as likelihood contour
sets are fan-shaped. As a result, they show that the likelihood ratio statistics can still be
asymptotically chi-squared, even if the maximum likelihood estimator is not asymptotically normal. In addition, Zhang and Li (1993) develop an empirical process approach to
deriving the asymptotic null distribution of the sup-LR-type statistics without requiring
the usual quadratic approximation to the likelihood function, using the general result in
Zhang and Cheng (1989). Their approach is closely related to ours in that it employs the
empirical process method; however, their method is different from ours in the sense that
they focus on the case when the objective function is a likelihood function and when the
class of likelihood functions is assumed to be HoÃàlder continuous in parameters. Again, neither Fan et al. (2000) nor Zhang and Li (1993) can include our maximum score estimator
example as a special case.

1.2. Structure of the Paper. The remainder of the article is as follows. In Section 2,
we provide an informal description of our test statistic and a couple of examples. Section
3 provides an informal overview of our method for obtaining the asymptotic null distribution. Section 4 illustrates the usefulness of our test by applying it to real data used by
Card et al. (2008). Formal results are given in Section 5 and they are illustrated in Section
6. A summary of Monte Carlo simulation results are provided briefly in Section D. In
Section 8, we provide some concluding remarks. All the proofs, some additional theoretical

<-----Page 6----->6

LEE, SEO, AND SHIN

results, and details of Monte Carlo experiments are contained in the online supplementary
materials.

2. The Test Statistic
This section describes our test statistic. To develop a general testing framework without
being tied down to a particular statistical model, we suppose that under the null hypothesis,
the remaining unknown parameters in (1.2) can be estimated by optimizing a particular
objective function and also that under the alternative hypothesis, all unknown parameters including Œ±0 can be estimated by optimizing a suitable objective function. In other
words, we develop our test statistic based on the distance between optimized restricted and
unrestricted objective function values.
To be more specific, let Qn : Œò ‚äó Œì 7‚Üí R denote an objective function of interest based on
a random sample {(Yi , Wi ) : i = 1, . . . , n}. For a given Œ≥ ‚àà Œì, let Œ∏ÃÇ (Œ≥) denote an estimator


of Œ∏0 that maximizes the objective function Qn (Œ∏, Œ≥). Define Qn (Œ≥) := Qn Œ∏ÃÇ (Œ≥) , Œ≥ to be

a profiled objective function and let

Œ≥ÃÇ = argmax Qn (Œ≥) , Œ∏ÃÇ = Œ∏ÃÇ (Œ≥ÃÇ) , and QÃÇn = Qn (Œ≥ÃÇ) .
Œ≥

In addition, let
Œ≤ÃÉ = argmax Qn (Œ∏, Œ≥) and QÃÉn = max Qn (Œ∏, Œ≥) .
Œ≤:Œ±=0

Œ≤:Œ±=0

Recall that Qn does not depend on Œ≥ when Œ± = 0. That is, QÃÉn is the maximum value of
the objective function under the null hypothesis and QÃÇn is the maximum value without
imposing the null hypothesis.
Our test statistic is based on the difference between QÃÇn and QÃÉn , analogous to the likelihood ratio (LR) statistic. Define the quasi-LR (QLR) statistic by
QLRn =

rn2





QÃÇn ‚àí QÃÉn ,

<-----Page 7----->TESTING FOR THRESHOLD EFFECTS

7

where rn is a rate of convergence in probability of Œ∏ÃÇ (Œ≥) for a given Œ≥. Let
h
i
QLRn (Œ≥) = rn2 Qn (Œ≥) ‚àí QÃÉn
for each Œ≥, and note that
QLRn = sup QLRn (Œ≥) .
Œ≥‚ààŒì

Thus, the statistic QLRn can be viewed as a sup LR-type statistic. This statistic is relatively easier to implement and analyze than some alternative statistics, e.g. a sup Wald
test statistic because it would not be straightforward to studentize the latter and to show
the uniform tightness of Œ±ÃÇ (Œ≥) in some cases, e.g. in the maximum score estimation for
binary response models. Also, we expect that the objective-function-based statistic would
have better finite sample performance as it is more immune to local maxima problems.
We consider two types of Qn (Œ∏, Œ≥): the first type is a sample mean statistic and the
second type is a U-statistic. For the first case, the objective function has the form
n

1X
q (Yi , Wi ; Œ∏, Œ≥) ,
Qn (Œ∏, Œ≥) =
n i=1

(2.1)

where q is a known function up to parameters Œ∏ and Œ≥. For example, the maximum score
estimator maximizes Qn (Œ∏, Œ≥) with
q (y, w; Œ∏, Œ≥) = (2y ‚àí 1) 1 {g (w, Œ∏, Œ≥) ‚â• 0} .
In this example, the rate of convergence is rn = n1/3 . For the second case, the objective
function has the form
(2.2)

Qn (Œ∏, Œ≥) =

X
2
œá (Yi , Wi , Yj , Wj ; Œ∏, Œ≥) ,
n(n ‚àí 1) 1‚â§i<j‚â§n

where œá is again a known function up to parameters, and is symmetric in the sense that
œá (yi , wi , yj , wj ; Œ∏, Œ≥) = œá (yj , wj , yi , wi ; Œ∏, Œ≥) . For example, the maximum rank correlation

<-----Page 8----->8

LEE, SEO, AND SHIN

estimator maximizes Qn (Œ∏, Œ≥) with
œá (y1 , w1 , y2, w2 ; Œ∏, Œ≥) = 1 {y1 > y2 } 1 {g (w1 , Œ∏, Œ≥) > g (w2 , Œ∏, Œ≥)}
+ 1 {y1 < y2 } 1 {g (w1 , Œ∏, Œ≥) < g (w2 , Œ∏, Œ≥)} .
In this example, rn = n1/2 . In both cases, we assume that q or œá depends on (Œ∏, Œ≥) only
through the regression function g.
Additional examples include the maximum likelihood estimator of the probit (or logit)
model, the quantile regression estimator (see Koenker, 2005, for the comprehensive treatment of the methodology), and the partial maximum likelihood estimator of the proportional hazard model (see Cox, 1972, 1975) in the first class, and various rank correlation
based estimators such as the monotone rank estimator (Cavanagh and Sherman, 1998) and
the pairwise rank estimator (Abrevaya, 1999) in the second class.

3. Informal Overview of the Results
This section provides an informal overview of our method for obtaining the asymptotic
null distribution. Formal results are given in Section 5. The main idea is to represent
our test as a continuous functional of an empirical process for a certain transformation of
objective functions of interest without referring to the estimators under the null and alternative hypotheses. Therefore, our method for obtaining the asymptotic null distribution
does not require an expansion of the objective functions, and can be used even in cases
when the usual quadratic approximation is unavailable or difficult to obtain. In general, the
asymptotic null distribution is not pivotal; however, a method for computing asymptotic
p-values is illustrated with a couple of examples (subsampling is another option).
In what follows, we use the conventional notation in empirical process theory. Denote
by P the common probability measure, by Pn the empirical measure of the random sample
of size n from P, and by Gn the empirical process indexed by a class F of functions q such
‚àö
that Gn q = n (Pn ‚àí P) q.

<-----Page 9----->TESTING FOR THRESHOLD EFFECTS

9

To provide the main idea behind our method, we focus on M-estimation, that is the
objective function has the form (2.1). Define
mŒæ,Œ≥ = qŒ∏,Œ≥ ‚àí qÃÉb ,
where Œæ = (Œ∏0 , b0 )0 , qŒ∏,Œ≥ = q (y, w; Œ∏, Œ≥) , and qÃÉb = q(b0 ,0)0 ,Œ≥ . Note that qÃÉb is the same for any
Œ≥ and thus it is a function of b only. We have introduced the index b to denote arguments
for Œ≤0 in the objective function with the restriction Œ± = 0 to distinguish this from the index
Œ≤ that denotes arguments for Œ≤0 in the unrestricted objective function.
Also, note that qŒ∏,Œ≥ is the same for all Œ≥ if Œ∏ = Œ∏0 , using the fact that Œ±0 = 0 under H0 .
Thus, under H0 , qŒ∏0 ,Œ≥ = qÃÉŒ≤0 , and when b is restricted to Œ≤0 ,
mŒæ,Œ≥ = qŒ∏,Œ≥ ‚àí qŒ∏0 ,Œ≥ .
Similarly, when Œ∏ is fixed at Œ∏0 ,
mŒæ,Œ≥ = qŒ∏0 ,Œ≥ ‚àí qÃÉb .
It now follows that
QLRn =
(3.1)

=

rn2
rn2





sup Pn qŒ∏,Œ≥ ‚àí sup Pn qÃÉb
Œ∏,Œ≥

b





sup Pn mŒæ,Œ≥ ‚àí sup (‚àíPn mŒæ,Œ≥ ) ,

Œæ,Œ≥:b=Œ≤0

Œæ,Œ≥:Œ∏=Œ∏0

which is a continuous transformation of rn2 Pn mŒæ,Œ≥ .
Note that since Œæ := (Œ∏0 , b0 ), b is still a free parameter after fixing Œ∏ at Œ∏0 and also Œ∏ is
still a free parameter after fixing b = Œ≤0 . That is, we treat Œ∏ and b separate parameters.
The reason why mŒæ,Œ≥ is defined in this way is to write the QLR test as a continuous
transformation of an empirical process for mŒæ,Œ≥ . Note also that mŒæ0 ,Œ≥ = 0 for any Œ≥, where
Œæ0 = (Œ∏00 , Œ≤00 )0 . Then the convergence of rn2 Pn mŒæ,Œ≥ can be derived using the empirical process

<-----Page 10----->10

LEE, SEO, AND SHIN

theory through the decomposition
(3.2)

r2
rn2 Pn mŒæ,Œ≥ = ‚àön Gn mŒæ,Œ≥ + rn2 PmŒæ,Œ≥ .
n

Since the supremum is obtained at Œ∏ = Œ∏ÃÇ (Œ≥) for each Œ≥ and at b = Œ≤ÃÉ, respectively, with
the convergence rate rn , we examine a rescaled version of the process in (3.2) to obtain the
asymptotic null distribution.
3.1. Example 1: Probit. We use the probit model as our first illustrative example. Define
WŒ≥ := (X0 , Z0 1{T > Œ≥})0 . The function q(y, w; Œ∏, Œ≥) for the probit model has the form
(3.3)

q (y, w; Œ∏, Œ≥) = y log Œ¶ (g (w, Œ∏, Œ≥)) + (1 ‚àí y) log Œ¶ (‚àíg (w, Œ∏, Œ≥)) ,

where Œ¶ (¬∑) is the cumulative distribution function (CDF) of the standard normal distribution and g (W, Œ∏, Œ≥) = WŒ≥0 Œ∏. It will be shown formally in Section 6 that the limiting
distribution of the test statistic is the supremum of a chi-square process indexed by Œ≥ as
in (5.10) . Let œÜ(¬∑) denote the probability density function of the standard normal distri

bution. Let e = (2Y ‚àí 1) œÜ (X0 Œ≤0 )/Œ¶ ((2Y ‚àí 1) X0 Œ≤0 ) and V (Œ≥) = E ‚àíe2 WŒ≥ WŒ≥0 . Also,
let G denote a Gaussian process with the covariance kernel



K (Œ≥1 , Œ≥2 ) = E e2 WŒ≥1 WŒ≥0 2 .
Then, the asymptotic distribution of the QLRn test becomes
(3.4)



1
0
‚àí1
0 ‚àí1
sup G(Œ≥) V (Œ≥) G(Œ≥) ‚àí G1 VŒ≤ G1 ,
2 Œ≥

where G1 and VŒ≤ denote the first kŒ≤ elements of G and the first kŒ≤ √ó kŒ≤ block of V (Œ≥),
respectively. Here, kŒ≤ denotes the dimension of Œ≤.
Note that we cannot tabulate the critical values due to the nonstandard asymptotic
distribution and need a simulation method to conduct the testing procedure. For example,
we can adopt the p-value transformation method as in Hansen (1996). The basic idea is to
approximate the asymptotic distribution by simulating the Gaussian process, which is the

<-----Page 11----->TESTING FOR THRESHOLD EFFECTS

11

empirical process of the score function in our case. For each i = 1, . . . , n, let
‚àáŒ∏ qÃÇi = WŒ≥,i (2Yi ‚àí 1)
‚àáb qÃÉi = Xi (2Yi ‚àí 1)

0
œÜ(WŒ≥,i
Œ∏ÃÇ(Œ≥))
0
Œ¶[(2Yi ‚àí 1)WŒ≥,i
Œ∏ÃÇ(Œ≥)]

,

œÜ(X0i Œ≤ÃÉ)
,
Œ¶[(2Yi ‚àí 1)X0i Œ≤ÃÉ]

where WŒ≥,i := (X0i , Z0i 1{Ti > Œ≥})0 . We now carry out the following steps to simulate the
p-value.
(1) to generate i.i.d. N (0, 1) random variables {vij }ni=1 for j = 1, ..., J for a sufficiently
large J;
(2) to simulate unrestricted and restricted score functions, respectively:
n

Gjn,Œ∏

n

1 X
1 X
(Œ≥) = ‚àö
‚àáŒ∏ qbi (Œ≥) vij and Gjn,b = ‚àö
‚àáb qei vij ;
n i=1
n i=1
J

(3) to simulate test statistics {Dnj }j=1 using the simulated score functions above and
the sample analogue of the asymptotic distribution in (3.4):
Dnj

i
1h j
0 b‚àí1 j
j0 b‚àí1 j
Gn,Œ∏ (Œ≥) IŒ∏,Œ≥ Gn,Œ∏ (Œ≥) ‚àí Gn,b Ib Gn,b
= sup
Œ≥ 2

P
P
‚àí1
where IbŒ∏,Œ≥
= (1/n) ni=1 ‚àáŒ∏ qbi (Œ≥) ‚àáŒ∏ qbi (Œ≥)0 and Ibb‚àí1 = (1/n) ni=1 ‚àáb qei ‚àáb qei0 , respectively;

(4) to set pbJn = (1/J)

n
o
j
bn .
1
D
>
D
n
j=1

PJ

3.2. Example 2: Quantile Regression. We now consider the quantile regression model.
The function q(y, w; Œ∏, Œ≥) for the quantile regression model has the form
(3.5)

q(y, w; Œ∏, Œ≥) = ‚àíœÅœÑ [y ‚àí g(w, Œ∏, Œ≥)] ,

where œÅœÑ (u) := u(œÑ ‚àí 1(u < 0)) is the ‚Äòcheck‚Äô function and g (W, Œ∏, Œ≥) = WŒ≥0 Œ∏. As in the
probit model, it will be shown formally in Section 6 that the limiting null distribution of

<-----Page 12----->12

LEE, SEO, AND SHIN

the QLR statistic is characterized by


1
0
‚àí1
0 ‚àí1
sup G(Œ≥) V (Œ≥) G(Œ≥) ‚àí G1 V1 G1 ,
2 Œ≥

(3.6)

where G is a mean-zero Gaussian process with covariance kernel
K (Œ≥1 , Œ≥2) = œÑ (1 ‚àí œÑ )EWŒ≥1 WŒ≥0 2 ,

(3.7)



V (Œ≥) is a matrix such that V (Œ≥) = E WŒ≥ WŒ≥0 fY |W (X0Œ≤0 |W) , and G1 and V1 denote the
first k1 elements of G and the first kŒ≤ √ókŒ≤ block of V (Œ≥), respectively. As before, kŒ≤ denotes

the dimension of Œ≤. Now the p-values can be simulated in the following way:

(1) to generate i.i.d. Unif [0, 1] random variables {uij }ni=1 for j = 1, ..., J for a sufficiently
large J;
(2) to simulate the following functions, respectively:
n

Gjn

n

1 X
1 X
(Œ≥) = ‚àö
WŒ≥,i [œÑ ‚àí 1(uij ‚â§ œÑ )] and GÃÉjn = ‚àö
Xi [œÑ ‚àí 1(uij ‚â§ œÑ )];
n i=1
n i=1
J

(3) to simulate test statistics {Dnj }j=1 by:
Dnj = sup
Œ≥

where

n
1 X
0
b
V (Œ≥) =
WŒ≥,i WŒ≥,i
K
nhn i=1

(3.8)

(4) to set

i
1h j
e ‚àí1 GÃÉj
Gn (Œ≥)0 Vb (Œ≥)‚àí1 Gjn (Œ≥) ‚àí GÃÉj0
V
n
n
2

n
1 X
e
Xi X0i K
V =
nhn i=1

pbJn

= (1/J)

Yi ‚àí X0i Œ≤ÃÉ
hn
!
Yi ‚àí X0i Œ≤ÃÉ
;
hn

!

, and

n
o
j
b
j=1 1 Dn > Dn .

PJ

In step (3), K is a kernel function and hn is a bandwidth. Recall that Œ≤ÃÉ is the estimator
of Œ≤0 under the null. When the regression error is independent of the regressors, then we

<-----Page 13----->TESTING FOR THRESHOLD EFFECTS

13

can estimate Vb (Œ≥) and Ve by
# "
" n
!#
n
0
X
X
1
1
Y
‚àí
X
Œ≤ÃÉ
i
i
0
Vb (Œ≥) =
WŒ≥,i WŒ≥,i √ó
K
, and
n i=1
nhn i=1
hn
(3.9)
# "
!#
" n
n
0
X
X
1
Y
‚àí
X
Œ≤ÃÉ
1
i
i
Xi X0i √ó
K
.
Ve =
n i=1
nhn i=1
hn
4. Application: Tipping in Segregation

We apply the proposed testing procedure to check whether there exists a tipping point
for segregation. Using U.S. Census tract-level data, Card et al. (2008) recently showed
that the neighborhood‚Äôs white population decreases substantially when the minority share
in the area exceeds a tipping point (or threshold point).
In this application, we use a subsample of the dataset originally used by Card et al.
(2008). Among three different base years, we choose a sample of which base year is 1980.
Next we pick four major cities and tested if there is a tipping point. To illustrate our
testing procedure, we first consider the probit model. We suppose that data {(Yi , Xi , Ti ) :
i = 1, . . . , n} are generated from
Dwi = Œ≤0 + Œ±0 1{Ti > Œ≥0 } + X0i Œ¥0 + i ,
Yi = 1 {Dwi > 0} ,
where Dwi is the ten-year change in the neighborhood‚Äôs white population, Ti is the base-year
minority share in the neighborhood, and Xi is a vector of six tract-level control variables.
The X variables include the unemployment rate, the log of mean family income, the fractions of single-unit, vacant, and renter-occupied housing units, and the fraction of workers
who use public transport to travel to work. See Card et al. (2008) for details on the dataset
and variables. In the original dataset, Dwi is observed but for the time being, we treat this
as a latent variable to illustrate our testing procedure for the probit model. The error term
i follows the standard normal distribution. Thus, the null and alternative hypotheses in

<-----Page 14----->14

LEE, SEO, AND SHIN

our setting are
H0 : Œ±0 = 0 and H1 : Œ±0 6= 0,

(4.1)
respectively.

The four cities we have chosen are Boston, Chicago, New York, and Philadelphia. The
p-values are calculated by the simulation method described in Section 3 with 1,000 simulations. For estimating a tipping point (Œ≥) under the alternative, we use the grid search
method. The grid points are constructed from Ti that fell in the interval [l, 50%], where l
is the maximum of 5% and the 5th percentile of {Ti }.
Table 1. Test for Tipping in Segregation: Probit Model

City
Boston, MA
Chicago, IL
New York, NY
Philadelphia, PA

obs.

p-value

700
1813
2430
1300

2.8%
0.0%
0.0%
0.0%

Tipping
EX [‚àÜPr(y = 1|X)]
Points (Œ≥ÃÇ)
46.80
-0.25
48.74
-0.34
14.01
-0.09
39.64
-0.30

We summarize the result in Table 1. The last column of each table shows the average
changes in probability that the white population would increase when the minority share
crosses the tipping point. We calculate this average marginal effect as
EX [‚àÜPr(y = 1|X)] =

1 X
ÀÜ	
Œ¶(Œ≤ÃÇ + X0i Œ¥ÃÇ) ‚àí Œ¶(Œ≤ÃÇ + Œ±ÃÇ + X0i Œ¥)
n i

where Œ¶(¬∑) is the CDF of the normal distribution.
First of all, testing results show that there exist tipping points in all four cities. Second,
the tipping points vary from 14.01% in New York to 48.74% in Chicago. This shows that
cities are heterogeneous in whites‚Äô preferences, among other things, implying that tolerance
levels against minority shares are quite different across different cities. Third, the average
marginal effects are also different across cities. New York shows that the probability drops
less than 10%. Meanwhile, Chicago shows that it drops more than 30%.

<-----Page 15----->TESTING FOR THRESHOLD EFFECTS

15

We now illustrate our testing procedure for the median regression model using observed
Dwi directly, instead of Yi . We now suppose that data {(Dwi , Xi , Ti ) : i = 1, . . . , n} are
generated from
Dwi = Œ≤0 + Œ±0 1{Ti > Œ≥0 } + p(Ti ) + X0i Œ¥0 + i ,
where median(i |Xi , Ti ) = 0 and p(T ) is the 4th-order polynomial of T . Note that Card et al.
(2008) considered the mean regression model (that is, E(i |Xi , Ti ) = 0) with the 4th-order
polynomial in p(T ). The null and alternative hypotheses are the same as those in (4.1).
The p-values are calculated by the simulation method described in Section 3 with 2,000
simulations. In the application, we estimated Vb (Œ≥) and Ve by (3.8) since we do not know

whether regression errors are independent of regressors. For estimating a tipping point (Œ≥)

under the alternative, we used the grid search method. The grid points were constructed
from Ti that fell in the interval [l, 60%], where l is the maximum of 5% and the 5th percentile
of {Ti }.
Table 2. Median regression model with the 4th-order polynomial

City
Boston, MA
Chicago, IL
New York, NY
Philadelphia, PA

obs.

p-value

700
1813
2430
1300

4.7%
2.9%
1.5%
1.2%

Tipping Size of the
Point (Œ≥ÃÇ) Jump (Œ±ÃÇ)
51.75
-17.640
48.45
-13.929
23.70
-7.309
39.65
-11.599

We summarize the result in Table 2. Testing results show that there exist tipping points
in all four cites at the 5% level. The tipping points vary across these cities and are not
much different from those from the probit model, especially in Chicago and Philadelphia.
5. The Asymptotic Null Distribution
This section provides asymptotic theory for obtaining the asymptotic null distribution.
Our assumptions are quite general and allow for a nonsmooth objective function Qn , which

<-----Page 16----->16

LEE, SEO, AND SHIN

may not permit usual quadratic approximations. As in Section 3, we focus on the Mestimation in this section. In the online supplements, we provide asymptotic theory for the
case when objective functions are based on U-processes and verify regularity conditions for
the maximum rank correlation (MRC) estimator. The consistency and local power of the
test are included in the online supplements as well.
5.1. M-estimation. This section considers the first case when the objective function has
the form in (2.1). Our estimators need not be exact maximizers, which might have measurability issues. Thus, we consider an estimator Œ∏ÃÇŒ≥ for a given Œ≥ ‚àà Œì such that



Qn Œ∏ÃÇŒ≥ , Œ≥ = sup Qn (Œ∏, Œ≥) + opŒ≥ rn‚àí2 ,
Œ∏‚ààŒò

where opŒ≥ (1) indicates the sequence under consideration is op (1) uniformly over Œ≥ ‚àà Œì. We
define oŒ≥ (1) and OpŒ≥ (1) similarly. Also, let Œ≤ÃÉ satisfy
 

QÃÑn Œ≤ÃÉ = sup QÃÑn (Œ≤) + op rn‚àí2 ,
Œ≤‚ààB

where QÃÑn denotes the restrictive objective function with Œ± = 0.
To derive the asymptotic distribution of the statistic QLRn , we impose some high-level
assumptions, which will be verified later for each example. We first introduce some notation.
Let
(5.1)

FŒ¥ = {qŒ∏,Œ≥ ‚àí qŒ∏0 ,Œ≥ : |Œ∏ ‚àí Œ∏0 | < Œ¥, Œ≥ ‚àà Œì} ,

where |¬∑| is the Euclidean norm for a vector (we use the notation k¬∑k to indicate a generic
norm for a function space). An envelope function of a class F is a function F such that
PF 2 < ‚àû, |f (x)| ‚â§ F (x) for any x and f ‚àà F . An envelope function for FŒ¥ is denoted
by FŒ¥ .
Weak convergence of the statistic QLRn draws on the size of the class FŒ¥ measured by
entropy with or without bracketing. Let N (Œµ, F , k¬∑k) and N[ ] (Œµ, F , k¬∑k) denote covering and
bracketing numbers, respectively. The logarithm of the covering number is called entropy

<-----Page 17----->TESTING FOR THRESHOLD EFFECTS

17

(without bracketing) and that of the bracketing number is called entropy with bracketing.
1/r
R
We mostly use the Lr (Q)-norm, kf kQ,r =
|f |r dQ
, where Q is a probability measure.

When the entropy without bracketing is concerned, it is common that the required condition
is in terms of uniform entropy, supQ log N (Œµ, F , Lr (Q)) , where the supremum is taken
over all the possible probability measures on the sample space, with 0 < QF r < ‚àû. While

the measurability is an issue in the formal discussion of uniform entropy conditions, it
hardly matters in applications. We assume measurability throughout the article. See e.g.
van der Vaart and Wellner (1996) for more general discussions on the empirical process
method.
We now present a set of assumptions, whose details will be discussed later on.
Assumption 5.1 (Uniform Consistency). Œ∏ÃÇ (Œ≥) = Œ∏0 + opŒ≥ (1) and Œ≤ÃÉ = Œ≤0 + op (1) .
A set of sufficient conditions for the uniform consistency in Assumption 5.1 is that
(i) uniform convergence of the objective function Qn ; (ii) separability of the true value.
Formally, we present it as Lemma 5.2 in Section 5.2.


Assumption 5.2 (Uniform Rates of Convergence in Probability). rn Œ≤ÃÉ ‚àí Œ≤0 = Op (1) and


rn Œ∏ÃÇ (Œ≥) ‚àí Œ∏0 = OpŒ≥ (1) .
Most often, the rate rn in Assumption 5.2 is already known for linear models and rn must
be the same for Œ∏ÃÇ (Œ≥) for each Œ≥ since g (w, Œ∏, Œ≥) is a linear function in Œ∏. Thus, Assumption
5.2 has mainly to do with verifying the uniformity. However, the entropy conditions below
in Assumption 5.4 are almost sufficient to ensure it, as will be shown in Lemma 5.3 in
Section 5.2.
In what follows, fix 0 < K < ‚àû and assume the following.
Assumption 5.3 (Lindeberg Condition and L2 -Continuity). For any Œ∑ > 0,
rn4
2
= O (1) ,
PFK/r
n
n

 2
‚àö
rn
rn4
2
PFK/rn 1 ‚àö FK/rn > Œ∑ n = o (1) .
n
n

<-----Page 18----->18

LEE, SEO, AND SHIN

In addition, for any decreasing sequence Œ∑n ‚Üí 0,
(5.2)

sup
|h1 ‚àíh2 |<Œ∑n
|Œ≥1 ‚àíŒ≥2 |<Œ∑n

2
rn4
P qŒ∏0 +h1 /rn ,Œ≥1 ‚àí qŒ∏0 +h2 /rn ,Œ≥2 = o (1) .
n

Assumption 5.3 is a minimal set of conditions on the moments of the envelope function F
and on the smoothness of the limit objective function. These are straightforward to verify.
Assumption 5.4 (Entropy Conditions). For some Œ¥0 > 0, assume that
(5.3)

Z

r

1

sup sup
0 Œ¥<Œ¥0

Q

Z

r



log N Œµ kFŒ¥ kQ,2 , FŒ¥ , L2 (Q) dŒµ < ‚àû

or
(5.4)

1

sup

0 Œ¥<Œ¥0



log N[ ] Œµ kFŒ¥ kP,2 , FŒ¥ , L2 (P ) dŒµ < ‚àû.

It is not always trivial to verify these entropy conditions. However, there are wellknown classes of functions that satisfy either of the conditions. For example, VapnikCÃåervonenkis (VC) classes of functions have the covering numbers that are bounded by a
polynomial in Œµ‚àí1 , thus satisfying (5.3) as long as the VC indexes are bounded in n. The
bracketing numbers for classes of smooth functions, monotone functions, convex functions,
or Lipschitz functions are known, see e.g. Section 2.7 of van der Vaart and Wellner (1996).
In particular, the bracketing number of the collection of Lipschitz functions are bounded
by the covering number of the index set, thus, being at most the polynomial in (1/Œµ)p ,
where p is the dimension of the parameter space.
Partition h into (h0Œ∏ , h0b )0 according to the dimensions of Œ∏ and b, respectively.
Assumption 5.5 (Finite-Dimensional Weak Convergence). Let h1n = Œæ0 + h1 rn‚àí1 and
h2n = Œæ0 + h2 rn‚àí1 . Then, for any K > 0, any Œ≥1 , Œ≥2 ‚àà Œì, and any h1 and h2 whose Euclidean
norms are less than K,
rn4
P (mh1n ,Œ≥1 ‚àí mh2n ,Œ≥2 )2 ‚Üí E (G1 (h1 , Œ≥1 ) ‚àí G1 (h2 , Œ≥2 ))2 ,
n

<-----Page 19----->TESTING FOR THRESHOLD EFFECTS

19

where G1 is a zero-mean Gaussian process. Furthermore, let hn = Œæ0 + hrn‚àí1 . Then
rn2 Pmhn ,Œ≥ ‚àí‚Üí G2 (h, Œ≥)
uniformly in h and Œ≥ over any compact set, for some non-stochastic G2 . Finally, G1 and
G2 satisfy that
G2 (h, Œ≥)
EG1 (h, Œ≥)2
‚Üí 0 and
‚Üí ‚àí‚àû
r
|hŒ∏ |
|hŒ∏ |r+1/2

(5.5)

as |hŒ∏ | ‚Üí ‚àû, for any Œ≥, hb , and some r > 0.
The limit process over which the supremum will be taken is characterized by the terms
given in Assumption 5.5. Considering the definition of mŒæ,Œ≥ , the Gaussian process G1 (h, Œ≥)
is likely to be degenerate in h as shown in later examples. Condition (5.5) in Assumption
5.5 guarantees that the restricted suprema (as in the definition of QLRn in (3.1)) of G1 +G2
are Op (1). When G2 (h, Œ≥) is quadratic in h and G1 (h, Œ≥) is linear in h for a given Œ≥, then
one can choose r = 1 in (5.5).
We now present our main theorem.

Theorem 5.1. Under Assumptions 5.1-5.5,
(5.6)

QLRn ‚áí sup
Œ≥





sup G (h, Œ≥) ‚àí sup (‚àíG (h, Œ≥)) ,

h:hb =0

h:hŒ∏ =0

where G = G1 + G2 .
While the asymptotic null distribution of QLRn is well-defined under the restriction in
Assumption 5.5, the asymptotic critical values cannot be tabulated due to the unknown covariance kernel of G1 . Therefore, we need to simulate critical values or asymptotic p-values.
Alternatively, we need to use resampling methods such as the bootstrap or subsampling.
Subsampling works more generally including all the examples we examined in this article.
When we can solve out the maximizers explicitly for the expression inside the bracket in

<-----Page 20----->20

LEE, SEO, AND SHIN

(5.6), simulating the critical values in the spirit of Hansen (1996) can also be applied. Two
examples in Section 3 belong to this case.
5.2. Low-Level Sufficient Conditions for Assumptions. This section provides lowlevel sufficient conditions for Assumptions 5.1-5.5. First, we present the following lemma
that can be used to verify Assumption 5.1.
Lemma 5.2. Let F be a class of functions {qŒ∏,Œ≥ : (Œ∏, Œ≥) ‚àà Œò √ó Œì} with envelope F such that
PF < ‚àû. Suppose either of the following two conditions is satisfied: (i) N[ ] (Œµ, F , L1 (P)) <
‚àû for every Œµ > 0; (ii) For FM defined as the class of functions f 1 {F ‚â§ M} for f ‚àà F ,
log N (Œµ, FM , L1 (Pn )) = op (n) for every Œµ and M > 0. Then,
p

sup |Qn (Œ∏, Œ≥) ‚àí Q (Œ∏, Œ≥)| ‚àí‚Üí 0,
Œ∏,Œ≥

where Q (Œ∏, Œ≥) = PqŒ∏,Œ≥ . Furthermore, assume that
(5.7)





sup sup {Q (Œ∏0 , Œ≥) ‚àí Q (Œ∏, Œ≥)} > 0
Œ≥‚ààŒì

Œ∏ ‚ààŒò
/ 0

for every open set Œò0 that contains Œ∏0 . Then, Œ∏ÃÇ (Œ≥) ‚àí Œ∏0 = opŒ≥ (1) .
While there are different ways to present sufficient conditions for Assumption 5.1, we
choose this way as the subsequent discussion also draws on the entropy conditions. The
entropy conditions in Lemma 5.2 are automatically satisfied if Assumption 5.4 holds. Thus,
separability is the one we need to check. Recall that Q (Œ∏0 , Œ≥) is the same for all Œ≥ since Œ≥
is not identified under the null. However, once we establish the consistency for a given Œ≥
and that Q (Œ∏0 , Œ≥) > supŒ∏‚ààŒò
/ Q (Œ∏, Œ≥), the verification of the separability is not very difficult
since Œ≥ appears only through an indicator function.
We now consider sufficient conditions for Assumption 5.2. The following lemma generalizes a standard method in van der Vaart and Wellner (1996) for obtaining the convergence
rate to the case where a uniform rate is needed due to the presence of a nuisance parameter.
See Andrews (2001) for a different approach when the quadratic approximation is plausible.

<-----Page 21----->TESTING FOR THRESHOLD EFFECTS

21

Lemma 5.3. Assume that for every Œ∏ in a neighborhood of Œ∏0 ,
sup P (qŒ∏,Œ≥ ‚àí qŒ∏0 ,Œ≥ ) ‚â§ ‚àíC |Œ∏ ‚àí Œ∏0 |2 ,

(5.8)

Œ≥

for some finite constant C > 0 and that for every n and sufficiently small Œ¥,
(5.9)

E sup sup |Gn (qŒ∏,Œ≥ ‚àí qŒ∏0 ,Œ≥ )| = O (œÜ (Œ¥)) ,
Œ≥

|Œ∏‚àíŒ∏0 |<Œ¥

for a function œÜ such that œÜ (Œ¥) /Œ¥ r is decreasing for some r < 2. If Assumption 5.1 holds,
then





rn Œ∏ÃÇ (Œ≥) ‚àí Œ∏0 = OpŒ≥ (1) ,
for every rn such that rn2 œÜ (1/rn ) ‚â§
be stated for Œ¥ = K/rn and œÜ (Œ¥) =

‚àö

‚àö

n for every n. If the rate rn is known, then (5.9) can

n/rn2 .

The first condition (5.8) is not difficult to verify. Often, PqŒ∏,Œ≥ is twice continuously
differentiable at Œ∏0 for all Œ≥. In this case, a sufficient condition is the existence of nonsingular
second derivative matrices at Œ∏ = Œ∏0 whose maximum eigenvalues are uniformly bounded
away from zero.
The second condition (5.9) is implied by Assumptions 5.3 and 5.4. It is known that the
left-hand side term in the equation (5.9) is bounded by the product of the L2 norm of the
envelope function, P1/2 (FŒ¥2 ) , and the uniform entropy integral or the bracketing integral,
which is defined respectively by
sup
Q

or

Z

1

0

Z

0

1

r

r



1 + log N Œµ kFŒ¥ kQ,2 , FŒ¥ , L2 (Q) dŒµ



1 + log N[ ] Œµ kFŒ¥ kP,2 , FŒ¥ , L2 (P) dŒµ.

See e.g. Theorems 2.14.1 and 2.14.2 in van der Vaart and Wellner (1996). These are
bounded by Assumption 5.4. Thus, in case when the rate rn is not known a priori, it

<-----Page 22----->22

LEE, SEO, AND SHIN

is typical that œÜ2 (Œ¥) = PFŒ¥2 yields the correct rate, leading to the rate as the solution of
2
‚àº n. This is in fact the first condition in Assumption 5.3.
rn4 PF1/r
n

We now provide sufficient conditions for Assumption 5.4. Many interesting examples
feature the estimating function q in the form of Lipschitz of order r transformation in the
sense that qŒ∏,Œ≥ = q (y, g (w, Œ∏, Œ≥)) and
|q (y, g (w; Œ∏1 , Œ≥1 )) ‚àí q (y, g (w, Œ∏2 , Œ≥2))| ‚â§ Lr (w) |g (w; Œ∏1 , Œ≥1 ) ‚àí g (w; Œ∏2 , Œ≥2)|r ,
where Lr is square integrable in P. In this case, verification of the entropy conditions and
the conditions on the envelope function is straightforward as in the following lemma.

Lemma 5.4. Suppose that FŒ¥ is a class of functions qŒ∏,Œ≥ , which are Lipschitz of order
r ‚àà (0, 1] transformations, where |Œ∏ ‚àí Œ∏0 | < Œ¥ and Œ≥ ‚àà Œì. Then, for some Œ¥0 > 0,
Z

1

sup sup
0 Œ¥<Œ¥0

Q

r



log N Œµ kFŒ¥ kQ,2 , FŒ¥ , L2 (Q) dŒµ < ‚àû.

Let œÜ (Œ¥) = Œ¥ r . Then, there exists an envelope function FŒ¥ such that for every Œ∑ > 0,

	
lim œÜ‚àí2 (Œ¥) PFŒ¥2 1 FŒ¥ > Œ∑Œ¥ ‚àí2 œÜ2 (Œ¥) = 0.

Œ¥‚Üí0

The lemma specifies the functional form of œÜ (Œ¥) as Œ¥ r , resulting in the convergence rate
rn = n1/(4‚àí2r) , upon verifying conditions on PqŒ∏,Œ≥ . There are quite a few examples that are
Lipschitz of order 1. They include the quantile regression model and the probit model in
Section 3.
If PqŒ∏,Œ≥ is twice continuously differentiable at Œ∏ = Œ∏0 with a unique maximum at Œ∏0 ,
Assumptions 5.1 and 5.2 may be implied by other conditions as discussed above. Then,
the following corollary is more convenient to apply than the main theorem. It provides
conditions under which G2 (h, Œ≥) is quadratic in h for a given Œ≥ and most applications
belong to this case.

<-----Page 23----->TESTING FOR THRESHOLD EFFECTS

23

Corollary 5.5. Suppose that the function Q (Œ∏, Œ≥) has a well-separated maximum Œ∏0 in
the sense of (5.7) and it is twice continuously differentiable at Œ∏0 with a negative second
derivative matrix, say ‚àíV (Œ≥), whose maximum eigenvalues are bounded away from zero
for all Œ≥. Let VŒ≤ denote the block of V (Œ≥) that is associated with the second derivative with
respect to Œ≤. Then, rn2 Pmhn ,Œ≥ ‚àí‚Üí ‚àí 21 h0Œ∏ V (Œ≥) hŒ∏ + 12 h0b VŒ≤ hb = G2 (h, Œ≥) , uniformly over any


compact set. If Assumptions 5.3 and 5.4 hold with a sequence rn , then rn Œ∏ÃÇ (Œ≥) ‚àí Œ∏0 =


OpŒ≥ (1) and rn Œ≤ÃÉ ‚àí Œ≤0 = Op (1). If Assumption 5.5 holds as well, then
QLRn ‚áí sup
Œ≥





sup G (h, Œ≥) ‚àí sup (‚àíG (h, Œ≥)) .

h:hb =0

h:hŒ∏ =0

If in addition G1 (h, Œ≥) is linear in h for a given Œ≥, then a more explicit form of the
asymptotic null distribution is available. By construction, we may write
G1 (h, Œ≥) = h0 G (Œ≥) = (hŒ≤ ‚àí hb )0 G1 + hŒ± G2 (Œ≥) ,
where G (Œ≥) = G10 , G2 (Œ≥)0

0

is a Gaussian process with some covariance kernel K(Œ≥1 , Œ≥2 ).

Then, simple algebra shows that the limiting distribution of QLRn has the form
(5.10)



1
0
‚àí1
0 ‚àí1
sup G(Œ≥) V (Œ≥) G(Œ≥) ‚àí G1 VŒ≤ G1 .
2 Œ≥

Standard linear algebra allows us to write this as
1
sup G (Œ≥)0 HŒ± (Œ≥) HŒ± (Œ≥)0 G (Œ≥) ,
2 Œ≥
where HŒ± (Œ≥) is a full-column rank matrix whose rank is the dimension of Œ±, say kŒ± .
Furthermore, if efficient estimators are used for both restricted and unrestricted models,
then for each Œ≥, HŒ± (Œ≥)0 G (Œ≥) is distributed as standard multivariate normal with dimension
kŒ± . Thus, 2QLRn converges in distribution to the supremum of a chi-square process indexed
by Œ≥. This is the case with the homoskedastic linear regression model with ordinary least
squares estimators (Hansen, 1996) and also with maximum likelihood estimators for logit
and probit models.

<-----Page 24----->24

LEE, SEO, AND SHIN

6. Examples
This section presents a few well-known statistical models as examples to illustrate how
to check the regularity conditions given in Section 5.

6.1. Maximum Score Estimation. The estimating function for the maximum score estimation is
(6.1)

q (y, w; Œ∏, Œ≥) = (2y ‚àí 1) 1 {x0 Œ≤ + z0 Œ±1 {t > Œ≥} ‚â• 0} .

To check the entropy condition (5.3) in Assumption 5.4, we show that the class F of
these functions qŒ∏,Œ≥ , where Œ∏ and Œ≥ belong to any compact subset in the Euclidean space,
is a VC class of functions. Indeed, the set {x0 Œ≤ + z0 Œ±1 {t > Œ≥} ‚â• 0} can be represented by
union and intersection of half-spaces in the Euclidean space. Since half spaces are VC class
of sets and the VC feature is preserved under unions and intersections, see Lemma 2.6.17
in van der Vaart and Wellner (1996), the sets constitute a VC class, so do the indicator
functions of the sets. Now, FŒ¥ = {qŒ∏,Œ≥ : |Œ∏ ‚àí Œ∏0 | < Œ¥, Œ≥ ‚àà Œì} is also a VC class of functions
of the same index at most as F . Thus, the covering numbers of FK/rn is bounded in a

polynomial in (1/Œµ)‚àí1 , not depending on n, and thus (5.3) is satisfied.

To find an envelope function for FŒ¥ , note that |qŒ∏,Œ≥ ‚àí qŒ∏0 ,Œ≥ | ‚â§ 1 and that it takes nonzero
values only when x0 Œ≤0 and x0 Œ≤ + z0 Œ±1 {t > Œ≥} take different signs. The latter implies that
the distance between the two is greater than x0 Œ≤0 in absolute values. Thus,
|x0 Œ≤0 | ‚â§

max |x0 (Œ≤ ‚àí Œ≤0 ) + z0 Œ±1 {t > Œ≥}| ‚â§ 2Œ¥ |x| ,

Œ∏:|Œ∏‚àíŒ∏0 |‚â§Œ¥

which yields an envelope function
FŒ¥ = 1 {|x0 Œ≤0 | ‚â§ 2Œ¥ |x|} .

<-----Page 25----->TESTING FOR THRESHOLD EFFECTS

25

It is shown in Theorem 6.1 below under some regularity conditions on P that this envelope
function satisfies the conditions in Assumption 5.3 with the rate obtained in Kim and Pollard
(1990) for Œ≤ÃÉ, that is, with rn = n1/3 .
The following assumption is imposed, which is somewhat more restrictive than required
to simplify the exposition. Let WŒ≥ = (X0 , Z0 1{T > Œ≥})0 .
Assumption 6.1. (i) The parameter Œ∏ has unit length, that is, Œò is the surface of the unit
sphere in Rk , and Œ≥ ‚àà Œì, which is an open subset of the support of T.
(ii) The distribution of U conditional on W = w, denoted by FU |W (¬∑|w), is absolutely continuous with respect to Lebesgue measure and the corresponding conditional density is uniformly continuous and positive everywhere with probability one. In addition, FU |W (0|w) =
0.5 for almost every w and it is continuously differentiable with respect to w.
(iii) X has a continuously differentiable density pX (¬∑) and the angular component of X,
considered as a random element in the unit sphere, has a bounded, continuous density with
respect to surface measure on the sphere. Furthermore, the density pX has compact support.
R
(iv) 1 {x0 Œ≤0 = 0} pW (w) d$ > 0, where $ denotes the Lebesque measure on {w : x0 Œ≤0 = 0} .
(v) T is continuously distributed.

The following theorem shows that conditions in Theorem 5.1 are satisfied.
Theorem 6.1. Suppose Assumption 6.1 hold and h, h1 and h2 belong to the null space of
Œæ0 . Let ` (w; h1, h2 , Œ≥1, Œ≥2 ) be the sum of the lengths of two intervals (I1 ‚àí I2 ) and (I2 ‚àí I1 ) ,
where I1 is the interval between wŒ≥0 1 h1Œ∏ and wŒ≥0 2 h2Œ∏ and I2 is the interval between x0 h1b and
x0 h2b . Also, let

(6.2)

Œ∫(w) := E [1 {g (W; Œ∏0 , Œ≥0 ) + U ‚â• 0} ‚àí 1 {g (W; Œ∏0 , Œ≥0 ) + U < 0} |W = w]
= 1 ‚àí 2FU |W [‚àíg(w, Œ∏0, Œ≥0 )|w].

Then, the covariance kernel of the limit Gaussian process G1 is characterized by
2

E (G1 (h1 , Œ≥1) ‚àí G1 (h2 , Œ≥2 )) =

Z

` (w; h1 , h2 , Œ≥1, Œ≥2 ) 1 {x0 Œ≤0 = 0} pW (w) d$,

<-----Page 26----->26

LEE, SEO, AND SHIN

and
Z 
2 
2
0
0
G2 (h, Œ≥) =
(x hb ) ‚àí wŒ≥ hŒ∏
1 {x0 Œ≤0 = 0} [(‚àÇ/‚àÇx0 ) Œ∫ (w) Œ≤0 ] pW (w) d$.
Furthermore,
QLRn ‚áí sup
Œ≥





sup G (h, Œ≥) ‚àí sup (‚àíG (h, Œ≥)) ,

h:hb =0

h:hŒ∏ =0

where qŒ∏,Œ≥ for QLRn is defined using (6.1) and G = G1 + G2 .
Theorem 6.1 establishes the asymptotic null distribution for the maximum score estimation. The corresponding distribution is nonstandard and cannot be tabulated; however,
statistical inference can be carried out by subsampling as in Delgado et al. (2001). Since
without Theorem 6.1, it would be difficult to obtain the validity of subsampling, one of the
merits of Theorem 6.1 is to provide the asymptotic validity of subsampling.

6.2. The Probit Model. We now verify regularity conditions for the probit model. Note
that the function q(y, w; Œ∏, Œ≥) in (3.3) is Lipschitz of order 1 transformation and twice
continuously differentiable in Œ∏. Therefore, applying Lemma 5.4 and Corollary 5.5, we
only need to check the separability condition (5.7) and Assumption 5.5. We assume the
following regularity conditions:

Assumption 6.2. (i) The parameters Œ∏ and Œ≥ are in the interior of compact sets Œò and
Œì where Œì is contained in an open subset of the support of T.


(ii) For any Œ≥, the matrix E WŒ≥ WŒ≥0 exists and is nonsingular.
(iii) T is continuously distributed.



We first verify the separability condition. Let Œ≥ be given. Since E WŒ≥ WŒ≥0 is nonsingu-

lar, it is positive definite. This implies that WŒ≥0 Œ∏0 6= WŒ≥ Œ∏ for any Œ∏ 6= Œ∏0 . Therefore, strict
monotonicity of Œ¶ (¬∑) assures identification for each Œ≥, which establishes the separability
condition.

<-----Page 27----->TESTING FOR THRESHOLD EFFECTS

27

Since q (¬∑) is twice continuously differentiable, it follows from the discussion following
Corollary 5.5 that the limiting distribution of the test statistic is the supremum of a chisquare process indexed by Œ≥ as in (5.10) . Then the desired result in (3.4) follows. Using
identical arguments, we can obtain the null asymptotic distribution of the test statistic for
the logit model. In general, similar arguments can apply to statistical models for which the
test statistic can be constructed based on the maximum likelihood estimator.

6.3. Quantile regression. Note that the function q(y, w; Œ∏, Œ≥) in (3.5) is Lipschitz of
order 1 as a function of g(w, Œ∏, Œ≥). Therefore, the bracketing entropy condition (5.4) and
the condition on the envelope function in Assumption 5.3 are satisfied due to Lemma 5.4.
‚àö
Furthermore, rn = n. We verify the other conditions in Corollary 5.5.
Assume that the density of Y conditional on W and that of T conditional on the other
elements in W exist and are continuously differentiable with uniformly bounded derivatives.
Let fY |W (¬∑|w) denote the conditional density of Y given W = w. Then, PqŒ∏,Œ≥ is twice
continuously differentiable in any (Œ∏, Œ≥) , implying the last condition in Assumption 5.3 is
satisfied. Furthermore, G1 is linear in h as to be shown below. Thus, the limit distribution
is characterized by (5.10) with


V (Œ≥) = E WŒ≥ WŒ≥0 fY |W (X0 Œ≤0 |W) ,
and a mean-zero Guassian process G with covariance kernel in (3.7). To see this, write
‚àÜœÑ (a) := œÅœÑ (y ‚àí a) ‚àí œÅœÑ (y ‚àí a0 ) ‚àí [1(y < a0 ) ‚àí œÑ ](a ‚àí a0 ).
Then as in Pollard (1991), simple algebra yields that
(6.3)

|‚àÜœÑ (a)| ‚â§ |a ‚àí a0 |1{|y ‚àí a0 | ‚â§ |a ‚àí a0 |}.

Define
œïh,Œ≥ (y, w) := [1(y < x0 Œ≤0 ) ‚àí œÑ ] (x0 (hŒ≤ ‚àí hb ) + z0 hŒ± 1{t > Œ≥}) .

<-----Page 28----->28

LEE, SEO, AND SHIN

By (6.3),
nE |mhn ,Œ≥ ‚àí œïhn ,Œ≥ |2
(
 0 )


0
WŒ≥ hŒ∏ 
 0 
|X
h
|
b
0
0
0
‚â§ E WŒ≥ hŒ∏  1 |Y ‚àí X Œ≤0 | ‚â§ ‚àö
+ E |X hb | 1 |Y ‚àí X Œ≤0 | ‚â§ ‚àö
n
n

‚Üí 0.

Therefore, the covariance kernel is given by that of œïh,Œ≥ by applications of Cauchy-Schwarz
inequality, which is given by (3.7).
Note that in this example, the asymptotic null distribution is not the supremum of a chisquare process indexed by Œ≥. This is due to the fact that the quantile regression estimator
is not an efficient estimator. However, critical values can be simulated by the same method
as in the maximum likelihood estimation, which was illustrated in section 3.

7. Monte Carlo Simulations
In this section, we report Monte Carlo simulation results for all four examples considered
in the article. Details of simulation designs and testing procedures are provided in the online
supplement.
Figure 2 summarizes the results of the simulation study, by showing the power functions
for four examples with three different sample sizes: n = 50, 100, and 200. The top right
and left panels report results from the probit example and those from the maximum score
estimation example, respectively. In addition, the bottom right and left panels report
results from the quantile regression example and those from the maximum rank correlation
estimation example, respectively. First of all, the figure shows the finite sample size of the
test when the nominal level is 5%. Under the null hypothesis (Œ± = 0), the rejection rates
of the test are close to the nominal level in most cases. Secondly, Figure 2 shows the power
of the test when Œ± increases from 0 to 1. The result indicates that, in all cases, the power
increases fast as the parameter value of Œ± is farther away from zero and also it increases as
n gets large.

<-----Page 29----->TESTING FOR THRESHOLD EFFECTS

29

Figure 1. Power Functions of Threshold Models
Threshold Probit

Threshold MSE

1

1.0

n=200

n=200

n=100
n
100

n=100

n=50
0.8

n=50

size: 5%

0.8

0.6

size: 5%

Power

Power

0.6

04
0.4

0.4

0.2
0.2

0
0

0.2

0.4

0.6

0.8

0.0

1

0

Slope Variable

0.2

0.4

0.6

0.8

1

Slope Variable

Threshold Quantile

Transformation Model (MRC)

1.0

1.0

n=200

n=200

n=100

n=100

n=50
0.8

n=50
0.8

size: 5%

Power

0.6

Power

0.6

size: 5%

0.4

0.4

0.2

0.2

0.0

0.0
0

0.2

0.4

0.6

0.8

1

0

Slope Variable

0.2

0.4

0.6

0.8

1

Slope Variable

8. Conclusions
We have developed a general testing procedure for threshold effects and have proposed a
new method for establishing the asymptotic null distribution. Since the new approach does
not require to approximate the objective function in a quadratic form, we can construct
the test statistic for nonstandard cases like the maximum score estimation. Furthermore,
we have proposed the test statistic when the objective function is a U-process. We believe
our approach would prove useful in many other occasions where objective function based
inferences are made.

<-----Page 30----->30

LEE, SEO, AND SHIN

Fan et al. (2001) show that a class of the generalized likelihood statistics based on some
appropriate nonparametric estimators are asymptotically chi-squared in nonparametric
testing problems. However, they do not consider the Davies problem. It is an interesting research topic to see whether one can generalize the methodology of Fan et al. (2001)
to cover the case when there may be a nuisance parameter that appears under the alternative, but not under the null. Such examples are partially linear regression models and
varying coefficient models with a change-point due to a covariate threshold.
We have provided local power results in the online supplements, but have not established
the asymptotic admissibility of the test we proposed. Andrews and Ploberger (1995) have
established the asymptotic admissibility of the likelihood ratio test. It might be possible
to extend their results to more general cases, including our QLR statistics. Alternatively,
following Andrews and Ploberger (1994) and Song et al. (2009), we may introduce a class
of tests of the following form:
Exp ‚àí QLRn =

rn2



(1 + c)

‚àíp/2

Z

exp





1 c
QLRn (Œ≥) dJ (Œ≥) ,
2c+1

where p is the dimension of b, J (¬∑) is a prespecified weight function over values of Œ≥
in Œì, and c is a prespecified scalar constant.

It might be possible to establish that

Exp ‚àí QLRn has some weighted average power properties in our setup, along the lines
of Andrews and Ploberger (1994) and Song et al. (2009). These are interesting topics for
future research.

Appendices
The appendices contain all the mathematical proofs, additional theoretical results, and
Monte Carlo simulation results. In particular, (i) we provide the proofs of all the theorems; (ii) we provide asymptotic theory for the case when objective functions are based
on U-processes and verify regularity conditions for the maximum rank correlation (MRC)

<-----Page 31----->TESTING FOR THRESHOLD EFFECTS

31

estimator; (iii) we discuss the consistency and local power of the test when the null hypothesis is false; and (iv) we report details of Monte Carlo simulation designs and testing
procedures.

Appendix A. Proofs of Theorems
Proof of Theorem 5.1. As supremum is a continuous operator, we need to establish the
weak convergence of the process rn2 Pn mŒæ,Œ≥ . Also note that in view of Lemma 2.5 of Kim and
Pollard (1990) the supremum of the limit process G is Op (1) under Assumption 5. Under
the uniform convergence rate given in Assumption 2, it is sufficient to consider the process
rn2 Pn mŒæ,Œ≥ only on the rn‚àí1 neighborhood of Œæ0 . Furthermore, given the decomposition (3.2)
of rn2 Pn mŒæ,Œ≥ and Assumption 5, it remains to obtain the weak convergence of the empirical
process indexed by the sequence of classes of functions
Mn =




rn2
‚àö mhn ,Œ≥ : |h| ‚â§ K, Œ≥ ‚àà Œì ,
n

where hn is defined in Assumption 5. That is, we derive the weak convergence of
r2
‚àön Gn mhn ,Œ≥ ,
n
for any given K > 0. Then, an application of the continuous mapping theorem concludes
the proof.
We apply either Theorem 2.11.22 or 2.11.23 of van der Vaart and Wellner (1996) to obtain the weak convergence. While our assumptions are sufficient for both theorems, they
are presented in terms of functions q not of functions m. Thus, we need to show that the
conditions on q are preserved under the transformation yielding m. First, we verify that the
boundedness of both entropy conditions (5.3) and (5.4) is preserved under summation. For
the latter, note that the definition of the bracketing numbers implies that for two classes
F and G of functions,
N[ ] (2Œµ, F + G, Lr (Q)) ‚â§ N[ ] (Œµ, F , Lr (Q)) N[ ] (Œµ, G, Lr (Q)) .

<-----Page 32----->32

LEE, SEO, AND SHIN

Therefore, the bounded entropy condition (5.4) for FŒ¥ implies the boundedness of the
entropy condition for the class
MŒ¥ = {mŒæ,Œ≥ : |Œæ ‚àí Œæ0 | < Œ¥} .
For the former case of uniform entropy, we refer to Theorem 2.10.20 of van der Vaart and Wellner
(1996), which shows








log N Œµ k2FŒ¥ kQ,2 , FŒ¥ + FŒ¥ , L2 (Q) ‚â§ 2 log N Œµ kFŒ¥ kQ,2 , FŒ¥ , L2 (Q) .
Thus, it is shown that the class MŒ¥ also satisfies either the entropy conditions (5.3) or (5.4),
which also satisfies that of either Theorem 2.11.22 or 2.11.23 of van der Vaart and Wellner
(1996). An envelope function MŒ¥ for MŒ¥ is given by 2FŒ¥ , which satisfies the conditions
of Theorem 2.11.22 or 2.11.23 of van der Vaart and Wellner (1996) under Assumption 3.
This completes the proof.

Proof of Lemma 5.2. The proof of this lemma is omitted since the first conclusion is a restatement of Theorems 2.4.1 and 2.4.3 in van der Vaart and Wellner (1996) and the second
conclusion follows immediately from Lemma A-1 of Andrews (1993). Specifically speaking,
Condition (a) of Lemma A-1 of Andrews (1993) is satisfied by Theorem 2.4.1 and Theorem
2.4.3 in van der Vaart and Wellner (1996).

Proof of Lemma 5.3. To prove the lemma, we modify the peeling device in the proof of
Theorem 3.2.5 in van der Vaart and Wellner (1996). For each n, the parameter space
can be partitioned into the shells Sj,n = {Œ∏ : 2j‚àí1 < rn |Œ∏ ‚àí Œ∏0 | ‚â§ 2j } for integer j‚Äôs. If




rn supŒ≥ Œ∏ÃÇ (Œ≥) ‚àí Œ∏0  is larger than 2M for a given M, Œ∏ÃÇ (Œ≥) is in one of the shells for some
Œ≥. In that case supŒ∏,Œ≥ Pn qŒ∏,Œ≥ ‚àí Pn qŒ∏0 ‚â• 0, where the supremum is taken over the shell for Œ∏

<-----Page 33----->TESTING FOR THRESHOLD EFFECTS

33

and Œ≥ ‚àà Œì, due to the definition of Œ∏ÃÇ. Therefore, for any Œ∑ > 0,
(
)




X


‚â§
Pr
sup Pn qŒ∏,Œ≥ ‚àí PqŒ∏0 ‚â• 0
Pr rn sup Œ∏ÃÇ (Œ≥) ‚àí Œ∏0  > 2M
Œ≥

j‚â•M,2j ‚â§Œ∑rn

Œ∏‚ààSj,n ;Œ≥







+ Pr 2 sup Œ∏ÃÇ (Œ≥) ‚àí Œ∏0  ‚â• Œ∑ .
Œ≥

The two terms in the right side of the inequality can be shown to be made arbitrarily
small by the same argument in the proof of Theorem 3.2.5 in van der Vaart and Wellner
(1996).

Proof of Lemma 5.4. Let GŒ¥ denote the collection of g (w; Œ∏, Œ≥)s such that |Œ∏ ‚àí Œ∏0 | < Œ¥ and
gÃÑŒ¥ an envelope function of GŒ¥ . Then, it follows from Theorem 2.10.20 of van der Vaart and Wellner
(1996) that the uniform entropy integral of FŒ¥ is bounded by
(A.1)

Z

1

0

sup
Q

r


 dŒµ
log N Œµ kgÃÑŒ¥ kQ,2r , GŒ¥ , L2r (Q) 1‚àír ,
Œµ

where the supremum is taken over all finitely discrete probability measures Q. It is clear that
GŒ¥ constitutes a VC class of functions since the subgraphs are represented by intersections
and unions of half spaces as discussed in Section 6.1. Since the VC-index does not depend
on Œ¥ and the covering number of a VC class is polynomial in (1/Œµ) , the uniform entropy
integral in (A.1) is bounded uniformly in Œ¥. This in turn implies that the uniform entropy
integral condition in (5.3).
An envelope function for FŒ¥ is given by FŒ¥ = 2Lr ¬∑ gÃÑŒ¥r since
|q (y, g (w; Œ∏, Œ≥)) ‚àí q (y, g (w; Œ∏0 , Œ≥0 ))|2 ‚â§ 4L2r (w) gÃÑ 2r (w) .
To check the conditions on the envelope function, note that gÃÑŒ¥ (w) = |w| Œ¥ is an envelope
function for GŒ¥ using the Cauchy-Schwarz inequality. Then, it is straightforward to see that

<-----Page 34----->34

LEE, SEO, AND SHIN

with œÜ (Œ¥) = Œ¥ r

	

œÜ‚àí2 (Œ¥) PFŒ¥2 1 FŒ¥ > Œ∑Œ¥ ‚àí2 œÜ2 (Œ¥)
= E 4L2r (W) |w|2 1 {2Lr (W) |w| Œ¥ r > Œ∑}
‚Üí 0,

as Œ¥ ‚Üí 0 for any Œ∑ > 0.

Proof of Corollary 5.5. From the second order expansion of Pmhn ,Œ≥ , the functional form
of G2 is obvious since the first derivative is zero at Œæ = Œæ0 from the first order condition.
The consistency of Œ∏ÃÇ (Œ≥) (and thus Œ≤ÃÉ) follows from Lemma 5.2, and the convergence rates
follow from Lemma 5.3 since (5.8) is satisfied due to the presence of the second derivative
matrix VŒ∏ (Œ≥) and (5.9) is implied by Assumption 5.4. The last convergence then follows
from Theorem 5.1.

Proof of Theorem 6.1. We prove the conditions in Theorem 5.1. Assumption 5.4 is also discussed in the text. The first two conditions for the envelope function FK/rn in Assumption
3 are verified in Kim and Pollard (1989) .
To show the uniform consistency, we need to verify the condition (5.7) . Since Œ≥0 is not
identified, it is an arbitrary fixed number, say, zero. Then it can be shown that
(A.2)

‚àÜ‚àó (Œ∏, Œ≥) = P (qŒ∏0 ,Œ≥0 ‚àí qŒ∏,Œ≥ )
h

= E Œ∫(W) 1 {g (W; Œ∏, Œ≥) ‚â• 0 > g (W; Œ∏0 , Œ≥0 )}
i
‚àí 1 {g (W; Œ∏0, Œ≥0 ) ‚â• 0 > g (W; Œ∏, Œ≥)} .

By the assumption that FU |W [0|w] = 0.5, note that Œ∫(w) ‚â• 0 when g(w; Œ∏0, Œ≥0 ) ‚â• 0 and
that Œ∫(w) < 0 when g(w; Œ∏0, Œ≥0 ) < 0. Define
h
i
Q(Œ∏, Œ≥) = w ‚àà supp(W) : {g(w; Œ∏, Œ≥) ‚â• 0 > g(w, Œ∏0 , Œ≥0)} ‚à™ {g(w, Œ∏0, Œ≥0 ) ‚â• 0 > g(w, Œ∏, Œ≥)} .

<-----Page 35----->TESTING FOR THRESHOLD EFFECTS

35

By arguments identical to those used to prove Proposition 2 of Manski (1988), Œ∏0 is identified
if and only if inf Œ≥ Pr(W ‚àà Q(Œ∏, Œ≥)) > 0 for any Œ∏ 6= Œ∏0 . Therefore, supŒ≥ ‚àÜ‚àó (Œ∏, Œ≥) is nonpositive everywhere and is equal to zero only when (Œ∏, Œ≥) = (Œ∏0 , Œ≥0).
The uniform convergence with rn = n1/3 can be argued from Lemma 5.3 upon proving
(5.8) , which will be verified when we derive the limit of rn2 Pmhn ,Œ≥ .
Now we present the covariance kernel of the limit gaussian process G1 and verify the last
condition in Assumption 3. The following decomposition is useful: for any Œæ1 , Œæ2, Œ≥1 , and
Œ≥2 ,we have
rn P (mŒæ1 ,Œ≥1 ‚àí mŒæ2 ,Œ≥2 )2
= rn P (|1 {g (W, Œ∏1 , Œ≥1) ‚â• 0} ‚àí 1 {g (W, Œ∏2 , Œ≥2 ) ‚â• 0}|)
+ rn P (|1 {X0 Œ≤1 ‚â• 0} ‚àí 1 {X0Œ≤2 ‚â• 0}|)
‚àí rn 2P (1 {g (W, Œ∏1 , Œ≥1 ) ‚â• 0} ‚àí 1 {g (W, Œ∏2 , Œ≥2 ) ‚â• 0}) (1 {X0 Œ≤1 ‚â• 0} ‚àí 1 {X0Œ≤2 ‚â• 0})
=: A1 + A2 + A3 .
Some reparameterization and change of variables are useful. In particular to impose the
normalization restriction, |Œ∏| = |b| = 1, we characterize the localized parameters as
hn =
=

0
h0nŒ≤ , h0nŒ± , h0nb
!0
r
r

2

2




1 ‚àí hÃáŒ∏ /rn  Œ≤00 + hÃá0Œ≤ /rn , h0Œ± /rn , 1 ‚àí hÃáb /rn  Œ≤00 + hÃá0b /rn ,

   
   
where hÃáŒ≤  , hÃáb  < K and hÃáŒ≤ and hÃáb are orthogonal to Œ≤0 . Note here that since Œ±0 = 0 the
parameter hŒ± is not constrained. Let gn be defined in the same way. Note here that we

index by h and g rather than h1 and h2 to ease the exposition. Accordingly, decompose x
into
(A.3)

x = Œ∂Œ≤0 + Œ∑,

<-----Page 36----->36

LEE, SEO, AND SHIN

where Œ≤00 Œ∑ = 0. Then, x0 hnŒ≤ = Œ∂

r


2


1 ‚àí hÃáŒ∏ /rn  + Œ∑ 0 hÃáŒ≤ /rn . Now, take A1 and note that

A1 = rn P1 {g (W, Œ∏1 , Œ≥1 ) ‚â• 0 > g (W, Œ∏2, Œ≥2 )} + rn P1 {g (W, Œ∏2 , Œ≥2) ‚â• 0 > g (W, Œ∏1 , Œ≥1 )} .
0
0
Let ZŒ≥ = Z 1 {T > Œ≥} and pW (x, w‚àíx ) = pW (w) for W = X0 , W‚àíx
. Also recall that
z = R0 x = R0 Œ≤0 Œ∂ + R0 Œ∑ and let RŒ≥ = R1 {T > Œ≥} . Take the first term with substitution of
(A.3) , Œ∏1 = hnŒ∏ and Œ∏2 = gnŒ∏ , that is, consider
(

rn P Œ∂

r

 2
 
1 ‚àí  hÃárnŒ∏  +

Œ≤00 RŒ≥1 hŒ±
rn

!


Œ∑0 
+
hÃáŒ≤ + RŒ≥1 hŒ±
rn
r
 2
 
1 ‚àí  rgÃánŒ∏  +
‚â•0>Œ∂

Œ≤00 RŒ≥2 gŒ±
rn

!

)
Œ∑0
+
(gÃáŒ≤ + RŒ≥2 gŒ± ) ,
rn

which becomes, after rearranging terms and changing the variable Œæ = Œ∂Ãá/rn ,
ZZ
(A.4)

1



Œ∑0 (hÃáŒ≤ +RŒ≥1 hŒ± )
‚àí

q
2
1‚àí|hÃáŒ∏ /rn | ‚àíŒ≤00 RŒ≥1 hŒ± /rn

0

√ó1 {Œ∑ Œ≤0 = 0} pW

‚â§ Œ∂Ãá < ‚àö
‚àí

Œ∑0 (gÃáŒ≤ +RŒ≥2 gŒ± )
1‚àí|gÃáŒ∏ /rn |2 ‚àíŒ≤00 RŒ≥2 gŒ± /rn

!
Œ∂Ãá
Œ≤0 + Œ∑, w‚àíx dŒ∂Ãád$,
rn



and converges to
Z  h

i
Œ∑ 0 hÃáŒ≤ ‚àí gÃáŒ≤ + R (hŒ± 1 {t > Œ≥1 } ‚àí gŒ± 1 {t > Œ≥2 })

+

1 {Œ∑ 0 Œ≤0 = 0} pW (Œ∑, w‚àíx ) d$,

where (x)+ = x1 {x > 0} and $ denote the Lebesque measure on {w : x0 Œ≤0 = 0} . The
convergence follows from the dominated convergence theorem.
Then, after sorting out notation, the limit function of A1 with Œæ1 = hn and Œæ2 = gn can
be represented by

ZZ

 0

wŒ≥ hŒ∏ ‚àí wŒ≥0 gŒ∏  1 {x0 Œ≤0 = 0} pW (w) d$,
1
2

where hŒ∏ and gŒ∏ take values on the space orthogonal to Œ∏0 . By the same reasoning, that of
A2 is given by

ZZ

|x0 [(hb ‚àí gb )]| 1 {x0 Œ≤0 = 0} pW (w) d$,

<-----Page 37----->TESTING FOR THRESHOLD EFFECTS

37

where hb and gb orthogonal to Œ≤0 .
Note that the limit of A1 (and A2 ) is an integral of the length of the interval between
two points indexed by (hŒ∏ , Œ≥1 ) and (gŒ∏ , Œ≥2 ) (and by hb and gb ) and that the limit of A3 is a
composite of union and intersection of the two intervals. Then, using the notation in the
text, we can write
2

E (G1 (h, Œ≥1 ) ‚àí G1 (g, Œ≥2)) =

Z

` (w; h, g, Œ≥1, Œ≥2 ) 1 {x0 Œ≤0 = 0} pW (w) d$,

for h and g in the null space of Œæ0 . It can also be seen that the condition (5.2) in Assumption





5.3 is satisfied, observing (A.4) is bounded by hÃáŒ≤ ‚àí gÃáŒ≤  + |hŒ± ‚àí gŒ± | (1 + o (1)) .

Next, turn to G2 (h, Œ≥) or rn2 Pmhn ,Œ≥ = rn2 P (qhŒ∏ ,Œ≥ ‚àí qÃÉhb ) . We analyze rn2 PqhŒ∏ ,Œ≥ , then the

limit of rn2 PqÃÉhb can be derived in the same way. Write rn2 PqhŒ∏ ,Œ≥ = B1n + B2n , recalling
(A.2) , where
B1n = rn2 E (Œ∫ (W) 1 {X0 Œ≤0 < 0 ‚â§ g (W, hn , Œ≥)})
B2n = ‚àírn2 E (Œ∫ (W) 1 {X0 Œ≤0 ‚â• 0 > g (W, hn , Œ≥)}) .
The first term B1n can be written as, using the decomposition of x in (A.3) and keeping
the relevant notation there,
(A.5a)

B1n = rn

ZZ

1



Œ∑0 (hÃáŒ≤ +RŒ≥ hŒ± )
‚àí

q

√ó1 {Œ∑ 0 Œ≤0 = 0} Œ∫

(A.5b)

2

1‚àí|hÃáŒ∏ /rn | ‚àíŒ≤00 RŒ≥ hŒ± /rn

‚â§ Œ∂Ãá < 0

!
Œ∂Ãá
Œ≤0 + Œ∑, w‚àíx pW
rn



!
Œ∂Ãá
Œ≤0 + Œ∑, w‚àíx dŒ∂Ãád$,
rn

which, using the fact that Œ∫ (w) = 0 for w such that x0 Œ≤0 = 0 and an expansion for Œ∫ with
a mean value Œ∂ÃÉ,
Œ∫

Œ∂Ãá
Œ≤0 + Œ∑, w‚àíx
rn

!

‚àÇ
= Œ∫ (Œ∑, w‚àíx ) + 0 Œ∫
‚àÇx

Œ∂ÃÉ
Œ≤0 + Œ∑, w‚àíx
rn

!

Œ∂Ãá
Œ≤0
rn

!

,

<-----Page 38----->38

LEE, SEO, AND SHIN

converges by the dominated convergence theorem to
Z

n


o
0
Œ∂Ãá1 ‚àíx hÃáŒ≤ + RŒ≥ hŒ± ‚â§ Œ∂Ãá < 0 1 {x0 Œ≤0 = 0} [(‚àÇ/‚àÇx0 ) Œ∫ (w) Œ≤0 ] pW (w) dŒ∂Ãád$
Z
2
1  0
x hÃáŒ≤ + RŒ≥ hŒ±
1 {x0 Œ≤0 = 0} [(‚àÇ/‚àÇx0 ) Œ∫ (w) Œ≤0 ] pW (w) d$.
= ‚àí
2
Similarly, we can see that B2n ‚àí (‚àíB1n ) ‚Üí 0. And the limit of rn2 PqÃÉhb is also obvious.
Since this result also implies (5.8) , we verified all the conditions of Theorem 5.1.
Appendix B. Estimation Based on U-Processes
In this section, we provide asymptotic theory for the case with objective functions based
on U-processes. To do so, let Un denote the random discrete measure putting mass 2/n(n‚àí
1) for each of the points {(Yi , Wi , Yj , Wj ) : 1 ‚â§ i < j ‚â§ n}. Since we assume that œá in
(2.2) depends on (Œ∏, Œ≥) only through the regression function g (W, Œ∏, Œ≥) in this case as well,
arguments identical to those in Section 5.1 yields
QLRn =
=

rn2
rn2




sup Qn (Œ∏, Œ≥) ‚àí sup Qn (Œ≤)
Œ∏,Œ≥

sup
Œ≥



Œ≤



sup Un ¬µŒæ,Œ≥ ‚àí sup (‚àíUn ¬µŒæ,Œ≥ ) ,

Œæ:b=Œ≤0

Œæ:Œ∏=Œ∏0

where
¬µŒæ,Œ≥ (yi , wi , yj , wj ) := œáŒ∏,Œ≥ (yi , wi , yj , wj ) ‚àí œáÃÉb (yi , wi , yj , wj )
and œáÃÉb := œá(b0 ,0)0 ,Œ≥ . Therefore, QLRn is a continuous transformation of rn2 Un mŒæ,Œ≥ . General
theory on U-processes provides a method for approximating rn2 Un mŒæ,Œ≥ by its projection
uniformly in Œæ and Œ≥ (e.g. see Ghosal et al., 2000, Appendix). Therefore, the derivation
of the asymptotic null distribution is similar to that of Section 5.1.
In this section, we consider the case with rn = n1/2 since all the estimators, which we
are aware of, based on U-Processes are n‚àí1/2 consistent. To state an additional regularity
condition for this section, consider a class of functions
MŒ¥ = {œáŒ∏,Œ≥ ‚àí œáŒ∏0 ,Œ≥ : |Œ∏ ‚àí Œ∏0 | < Œ¥, Œ≥ ‚àà Œì}

<-----Page 39----->TESTING FOR THRESHOLD EFFECTS

39

with an envelope function MŒ¥ .

Assumption B.1 (Envelope Function and Entropy Condition). (1) Let Q denote the
2
product measure P ‚äó P. Then, QMK/n
1/2 ‚Üí 0 for any positive K < ‚àû. (2) For some

Œ¥0 > 0, we have that
Z

1



sup sup log N Œµ kMŒ¥ kQ,2 , MŒ¥ , L2 (Q) dŒµ < ‚àû.

0 Œ¥<Œ¥0

Q

The first condition in Assumption B.1 is reasonable given that MŒ¥ is defined only for
a local neighborhood around Œ∏0 . The entropy condition here is more stringent than that
of Assumption 5.4. However, VC classes of functions have the covering numbers that are
bounded by a polynomial in Œµ‚àí1 , thus still satisfying condition (2) of Assumption B.1 as
long as the VC indexes are bounded in n.
Consider a class of functions FÃÑŒ¥ that is the same as in (5.1) with q = Œ†œá, where
Œ†œáŒ∏,Œ≥ (y, w) = 2 [EœáŒ∏,Œ≥ (Y, W, y, w) ‚àí QœáŒ∏,Œ≥ ] .
An envelope function for FÃÑŒ¥ is denoted by FÃÑŒ¥ . In addition, define
Œ†¬µŒæ,Œ≥ (y, w) = 2 [E¬µŒæ,Œ≥ (Y, W, y, w) ‚àí Q¬µŒæ,Œ≥ ] .
The following theorem establishes the asymptotic null distribution when an estimator is a
maximizer of a U-Process.

Theorem B.1. Let Assumptions 5.1 and 5.2 hold with rn = n1/2 . Let Assumption 5.3
hold with FŒ¥ = FÃÑŒ¥ and q = Œ†œá, and Assumption 5.5 hold with m = Œ†¬µ. In addition, let
Assumption B.1 hold. Then
QLRn ‚áí sup
Œ≥





sup G (h, Œ≥) ‚àí sup (‚àíG (h, Œ≥)) ,

h:hb =0

h:hŒ∏ =0

where G = G1 + G2 is redefined suitably with m = Œ†¬µ.

<-----Page 40----->40

LEE, SEO, AND SHIN

Proof of Theorem B.1. Define
bn ¬µŒæ,Œ≥ := Q¬µŒæ,Œ≥ + Pn Œ†¬µŒæ,Œ≥ .
U

Then by Theorem A.1 of Ghosal et al. (2000) and comments following this theorem, there
exists a universal constant C < ‚àû such that
!
bn ¬µŒæ,Œ≥ |
E
sup
|Un ¬µŒæ,Œ≥ ‚àí U
¬µŒæ,Œ≥ ‚ààMK/n1/2
‚àí1

‚â§ Cn

2
1/2
(QMK/n
1/2 )

‚àí1

= o(n ),

Z

1

0


 

sup log N Œµ MK/n1/2 Q,2 , MK/n1/2 , L2 (Q) dŒµ
Q

where the last equality follows from Assumption B.1. Then since PŒ†¬µŒæ,Œ≥ = 0 and rn = n1/2 ,
we have that
r2
rn2 Un ¬µŒæ,Œ≥ = rn2 Q¬µŒæ,Œ≥ + ‚àön Gn Œ†¬µŒæ,Œ≥ + op (1),
n
uniformly over MŒ¥ . All regularity conditions of Theorem 5.1 are assumed directly except for Assumption 5.4. By Lemma A2 of Ghosal et al. (2000), the entropy condition
of Assumption B.1 is sufficient for Assumption 5.4. Therefore, Theorem 5.1 proves this
theorem.

Since the asymptotic distribution is identical to the M-estimation case with the projected
function Œ†¬µŒæ,Œ≥ , a corollary similar to Corollary 5.5 can be established. The discussion
following the corollary is also valid. Therefore, if QœáŒ∏,Œ≥ is twice differentiable at Œ∏0 with
relevant rank conditions satisfied and if G1 is linear in h, then the asymptotic representation
in (5.10) would be obtained.

<-----Page 41----->TESTING FOR THRESHOLD EFFECTS

41

B.1. Maximum Rank Correlation Estimation. The objective function of the maximum rank correlation (MRC) estimator is a second-order U-process with kernel
œá (y1 , w1 , y2 , w2 ; Œ∏, Œ≥)
:= 1 {y1 > y2 } 1 {g (w1 , Œ∏, Œ≥) > g (w2 , Œ∏, Œ≥)} + 1 {y1 < y2 } 1 {g (w1 , Œ∏, Œ≥) < g (w2 , Œ∏, Œ≥)} .
Recall that the MRC estimator can be applied to a general regression model defined as
Y = H ‚ó¶ F (g (W, Œ∏0 , Œ≥0 ) , U) ,
where H is a non-degenerate monotone function and F is a strictly monotone function
for both arguments. To provide its asymptotic null distribution, we need to check the
separability condition, Assumptions 5.3, 5.5, and B.1. We assume the following conditions
which are slight modification of the standard regularity conditions of the MRC estimator
in Sherman (1993) to reflect the threshold effects.

Assumption B.2. (i) The first element of Œ∏, say Œ∏1 , is normalized to be 1.
(ii) The first component of W has an everywhere positive Lebesgue density conditional on
f=w
e for all w.
e
the remaining components W

(iii) W is independent of U, and the support of WŒ≥ is not contained in any proper linear
subspace of Rdim(X)+dim(Z) for any Œ≥.

(iv) T is continuously distributed.
(v) Let N be a neighborhood of Œ∏0 . Then, the following conditions hold: (a) all mixed second
partial derivatives of Œ†œáŒ∏,Œ≥ with respect to Œ∏ exist on N for all Œ≥ ‚àà Œì; (b) There exists an
integrable function M (y, w) such that
sup |‚àáŒ∏Œ∏0 Œ†œáŒ∏,Œ≥ (Y, W) ‚àí ‚àáŒ∏Œ∏0 Œ†œáŒ∏0 ,Œ≥ (Y, W)| ‚â§ M (Y, W) |Œ∏ ‚àí Œ∏0 | ;
Œ≥


P  ‚àÇ 2

(c) supŒ≥ P |‚àáŒ∏ Œ†œáŒ∏0 ,Œ≥ | < ‚àû; (d) supŒ≥ P i,j  ‚àÇŒ∏i ‚àÇŒ∏j Œ†œáŒ∏0 ,Œ≥  < ‚àû; and (e) P‚àáŒ∏Œ∏0 Œ†œáŒ∏0 ,Œ≥ is
2

negative definite for all Œ≥ ‚àà Œì.

<-----Page 42----->42

LEE, SEO, AND SHIN

Since the functions H and F are monotone, the support condition of W implies that
Pr (Y1 > Y2 |W1 , W2 ) > Pr (Y1 < Y2 |W1 , W2 ) ‚áî g (W1 , Œ∏0 , Œ≥) > g (W2 , Œ∏0 , Œ≥)
for any Œ≥. This condition combined with the identification arguments in Han (1987) completes the separability condition. We next turn our attention to Assumption B.1. Consider
the class of functions

	
MK/n1/2 = œáŒ∏,Œ≥ ‚àí œáŒ∏0 ,Œ≥ : |Œ∏ ‚àí Œ∏0 | < K/n1/2 , Œ≥ ‚àà Œì .
From the arguments in Section 5 of Sherman (1993) and in the example of maximum score
estimation, we can show that MK/n1/2 is a VC-class of functions and that MK/n1/2 has an

 	
envelope function MK/n1/2 = 1 |x0 Œ≤0 | ‚â§ C K/n1/2 |x| for a constant C. Therefore, it

satisfies the conditions in Assumption B.1. To verify Assumption 5.3, consider the following
class of projected functions

	
FÃÑK/n1/2 = Œ†œáŒ∏,Œ≥ ‚àí Œ†œáŒ∏0 ,Œ≥ : |Œ∏ ‚àí Œ∏0 | < K/n1/2 , Œ≥ ‚àà Œì .

Then, Assumptions 5.3 follows from the finite envelope and the smoothness condition of
Œ†œáŒ∏,Œ≥ . It remains to show Assumption 5.5. However, it follows from the differentiability of
Œ†œáŒ∏,Œ≥ that the asymptotic representation in (5.10) applies. In particular, the covariance


kernel of G (Œ≥) is given by P (‚àáŒ∏ Œ†œáŒ∏0 ,Œ≥1 ) (‚àáŒ∏ Œ†œáŒ∏0 ,Œ≥2 )0 and V (Œ≥) = P‚àáŒ∏Œ∏0 Œ†œáŒ∏0 ,Œ≥ .
Appendix C. Consistency and Local Power
In this section, we present asymptotic properties of our test statistic when the null
hypothesis is false. We first consider a fixed alternative g (w) such that
g (w) 6= x0 Œ≤,
for any Œ≤. Let P1 denote the common probability measure under this alternative.

<-----Page 43----->TESTING FOR THRESHOLD EFFECTS

43

Theorem C.1. Let F be a class of functions qŒ∏,Œ≥ with envelope F such that P1 F < ‚àû. Assume either of the following two conditions: (i) N[ ] (Œµ, F , L1 (P1 )) < ‚àû for every Œµ > 0; (ii)
For FM defined as the class of functions f 1 {F ‚â§ M} for f ‚àà F , log N (Œµ, FM , L1 (Pn )) =
op (n) for every Œµ and M > 0. Let Q1 (Œ∏, Œ≥) = P1 qŒ∏,Œ≥ and assume that there exists (Œ∏, Œ≥) such
that Q1 (Œ∏, Œ≥) > supŒ∏:Œ±=0 Q (Œ∏, Œ≥) . Then, the test QLRn is consistent against the alternative
g, that is, the rejection probability of our test goes to one under P1 .
This theorem states conditions under which our test is consistent. This theorem might
not be very constructive to convey some meaningful insight into what alternatives our test
can detect as it is difficult to determine the functional form of Q1 without a specific q and
P1 . Roughly speaking, however, it implies that the test can detect an alternative which is
better approximated by a piecewise linear structural form than linear one. Clearly, if
g (w) = x0 Œ≤0 + z0 Œ±0 1 {t > Œ≥0 }
for some Œ±0 6= 0, the test is consistent under the other conditions of the above theorem.
Furthermore, Theorem C.1 suggests that the test be powerful against some other nonlinear
alternatives, as we demonstrate via Monte Carlos experiments in Section D.
Next, we investigate the asymptotic power property of our tests under sequences of local
alternatives:
0
gn (w) = x0 Œ≤0 + œÅ‚àí1
n ¬∑ x Œ± (t) ,

where Œ± is a vector-valued integrable function defined on the support of T and œÅn ‚Üí ‚àû.
This alternative is a natural generalization of the threshold model to encompass smooth
transition models and varying coefficient models. Let Pn denote the probability measure
for each n under the local alternatives. As above, general statement is less informative
than examination of specific examples since local power depends largely on whether or not
the limit of rn Pn mhn ,Œ≥ is different from that of rn Pmhn ,Œ≥ .
When œÅn = rn , the local asymptotic distribution of QLRn under Pn can be obtained
under minor modification of previous assumptions. We discuss this. We keep Assumption 1

<-----Page 44----->44

LEE, SEO, AND SHIN

and 2. Assumptions 3-5 need to be restated in terms of Pn . The uniform entropy condition
(5.3) in Assumption 4 remains the same since it does not depend on the true measure (see
e.g. section 2.11.1 of van der Vaart and Wellner (1996)). Lemmas 1 and 2 are valid under
these modifications on Assumption 3 and 4 and thus Assumptions 1 and 2 can be verified
in the same way as under the null. The limit quantities in Assumption 5 would not the
same as those under P. Either of the covariance kernel of G1 or the functional form of G2
or both change under Pn , yielding the local power. The methods to verify Assumptions
1-5 are similar as under P. When PmŒæ,Œ≥ is twice differentiable, its first derivative is zero
at Œæ = Œæ0 , where Œæ0 := (Œ≤00 , 00 , Œ≤00 )0 , and G2 is quadratic in its second derivative. On the
other hand, the first derivative of Pn mŒæ,Œ≥ is not zero at Œæ = Œæ0 but rn (‚àÇ/‚àÇŒæ) Pn mŒæ0 ,Œ≥ has
a non-vanishing limit. This is usually called the ‚Äúnoncentrality parameter‚Äù, which is the
source of the local power and yields the consistency when œÅn = o (rn ) . All of our examples
have nontrivial noncentrality parameters.
We now present two of previous examples to illustrate power properties of our test, focusing on the noncentrality parameter. First, consider the maximum score estimation of
the binary response model. We begin with rn2 Pn mhn ,Œ≥ . As shown in section 6.1, rn2 Pmhn ,Œ≥
converges to a quadratic function in h without a linear term as the first term in the expansion vanishes under P. We show that the linear term does not vanish under Pn . In
particular, note that Œ∫ (w) in (6.2) need to be replaced by
Œ∫n (w) = 1 ‚àí 2FU |W ‚àíx0 Œ≤0 ‚àí rn‚àí1 x0 Œ± (t) |w



 ‚àí1 0
0
= Œ∫ (w) + 2fU |W ‚àíx0 Œ≤0 ‚àí œÅ‚àí1
¬∑
x
Œ±ÃÉ
(t)
|w
œÅn x Œ± (t) ,
n

where Œ±ÃÉ is the mean value. Then, following the steps to derive the limit of rn2 Pmhn ,Œ≥ in
the proof of Theorem 6.1 with Œ∫ (w) replaced by Œ∫n (w) , we can see that the difference
rn2 Pn mhn ,Œ≥ ‚àí rn2 Pmhn ,Œ≥ , that is, the noncentrality parameter is given by
2

Z Z


 rn
Œ± (t)0 (xx0 (hŒ≤ ‚àí hb ) + xx0 1 {t > Œ≥} hŒ± )
1 {x0 Œ≤0 = 0} fU |W (0|w) pW (w) d$.
œÅn

<-----Page 45----->TESTING FOR THRESHOLD EFFECTS

45

If Œ± (T ) is nonzero with positive probability, then the noncentrality parameter is nonzero
for some Œ≥, regardless of h unless hŒ± = 0. On the other hand, we can easily see from the
proof of Theorem 6.1 that the covariance kernel of G1 does not change. Therefore, our test
has local power with œÅn = rn and is consistent when œÅn = o (rn ) .
‚àö
Next consider the MLE of the probit model. Let œÅn = rn = n and examine the score
functions for q (y, w; Œ∏, Œ≥) and qÃÉ (y, w; b) under Pn . Their expected values are zero under
P but non-zeros and different from each other under Pn , which yields the noncentrality
parameter. In particular, a direct calculation of the expected value with an expansion of
‚àö
the term Œ¶ (x0 Œ≤0 + x0 Œ± (t) / n) at x0 Œ≤0 yields
‚àö

Ô£Æ

‚Üí EÔ£∞

Ô£´

Ô£∂

Ô£π


œÜ (X Œ≤0 ) Ô£≠
‚àÇ
Ô£∏ œÜ X0 Œ≤0 + X0 Œ±ÃÉ‚àö(T ) X0 Œ± (T )Ô£ª
nPn q (y, w; Œ∏0, Œ≥) = E Ô£∞
0
‚àÇŒ∏
Œ¶ (X Œ≤0 )
n
X1 {T > Œ≥}
Ô£Æ
Ô£∂
Ô£´
Ô£π


0
X
œÜ (X Œ≤0 ) Ô£≠
Ô£∏ œÜ ‚àíX0 Œ≤0 ‚àí X0 Œ±ÃÉ‚àö(T ) X0 Œ± (T )Ô£ª
+E Ô£∞
0
Œ¶ (‚àíX Œ≤0 )
n
X1 {T > Œ≥}
Ô£Æ

0

2

0

X

œÜ (X Œ≤0 )
0
Œ¶ (X Œ≤0 ) Œ¶ (‚àíX0 Œ≤0 )

Ô£´
Ô£≠

0

XX Œ± (T )
XX 01 {T > Œ≥} Œ± (T )

Ô£∂Ô£π

Ô£∏Ô£ª ,

where Œ±ÃÉ lies between Œ± and 0. Similarly,
‚àö



œÜ2 (X0 Œ≤0 )
‚àÇ
0
nPn qÃÉ (y, w; Œ≤0) ‚Üí E
XX Œ± (T ) .
‚àÇb
Œ¶ (X0 Œ≤0 ) Œ¶ (‚àíX0 Œ≤0 )

Then, the noncentrality parameter becomes

œÜ2 (X0 Œ≤0 )
0
XX Œ± (T ) 1 {T > Œ≥} =
6 0
E
Œ¶ (X0 Œ≤0 ) Œ¶ (‚àíX0 Œ≤0 )


for some Œ≥ as long as Œ± (T ) is not zero with positive probability. Therefore, the test has nontrivial local power against local alternatives of the above form as well as of the threshold
‚àö
type. Furthermore, if œÅn = o ( n) , then the noncentrality parameter diverges to infinity
to yield the consistency of our test.

<-----Page 46----->46

LEE, SEO, AND SHIN

Appendix D. Monte Carlo Simulations
In this section we investigate finite sample properties of the proposed test by Monte Carlo
experiments. we report Monte Carlo simulation results for all four examples considered in
the article.

D.1. Binary Response Models: Probit, Logit, and Maximum Score. First, we
report Monte Carlo simulation results when the samples are generated from a simple probit
or logit model. To see whether the test has power against an alternative that is different
from a threshold model, we consider the smooth transition model as well as the threshold
model as alternatives. Therefore, we have 4 different models in total, and the baseline
model has the following form:
Y ‚àó = Œ≤0 + Œ≤1 X + Œ±Zœà (T, Œ≥) + U
Y

= 1 {Y ‚àó > 0} ,

where œà (T, Œ≥) = 1 {T > Œ≥} for the threshold model and œà (T, Œ≥) = 1/ (1 + exp (‚àí (T ‚àí Œ≥)))
for the smooth transition model. The true parameter values are set as Œ≤0 = 0.5, Œ≤1 = 1,
Œ≥ = 0.5 for the threshold model, and Œ≥ = 0 for the smooth transition model. When the null
hypothesis is true, the parameter Œ± is equal to zero. Under the alternatives, Œ± has various
non-zero values from 0.2 to 1. The covariates X and Z are generated independently from
N (0, 1) and N (0, 2), respectively. The covariate T follows the uniform distribution on the
interval [0, 1] for the threshold model and N (0, 1) for the smooth transition model. The
error term U is generated from either N (0, 1) or the logistic distribution.
Parameters other than Œ≥ are estimated by the Newton-Raphson‚Äôs method, and the threshold parameter Œ≥ is estimated by the grid search. For the grid, we used the data points of T
after trimming at lower and upper 10th percentiles. We considered three different sample
sizes, n = 50, 100, and 200, and replicated each simulation design 1000 times. For the
simulation number of the score functions, we set J = 2000.

<-----Page 47----->TESTING FOR THRESHOLD EFFECTS

47

Figure 2. Power Functions of Threshold Models
Threshold Probit

Threshold Logit

1

1

n=200

n=200

n=100
n
100

n=100
n
100
n=50

n=50
0.8

0.8

size: 5%

size: 5%

0.6

Power

Power

0.6

04
0.4

04
0.4

0.2

0.2

0

0
0

0.2

0.4

0.6

0.8

0

1

0.2

0.4

0.6

0.8

1

Slope Variable

Slope Variable

Figure 3. Power Functions of Smooth Transition Models
Smooth Transition Probit

Smooth Transition Logit

1

1

n=200

n=200

n=100
n
100

n=100
n=50

n=50
0.8

0.8

size: 5%

0.6

size: 5%

Power

Power

0.6

04
0.4

0.4

0.2

0.2

0

0
0

0.2

0.4

0.6

Slope Variable

0.8

1

0

0.2

0.4

0.6

0.8

1

Slope Variable

Figures 2‚Äì3 summarize the result of the simulation study. Overall, the test performs well
as expected from the theory. First, under the null hypothesis (Œ± = 0), the rejection rates of
the test are close to the nominal level in most cases. Second, Figures 2‚Äì3 show the power
of the test when Œ± increases from 0 to 1. The result indicates that, in all cases, the power
increases fast as the parameter value of Œ± is farther away from zero. The test shows good
performance even with a relatively small sample size, say n = 100.
We now report simulation results for testing the null hypothesis that Œ±0 = 0 for the
probit threshold model above with the maximum score objective function. This amounts

<-----Page 48----->48

LEE, SEO, AND SHIN

Figure 4. Power Functions of the Probit Threshold Model with Maximum
Score Estimation
Threshold MSE
1.0

n=200
n=100
n=50
0.8

size: 5%

Power

0.6

0.4

0.2

0.0
0

0.2

0.4

0.6

0.8

1

Slope Variable

to the case when a researcher only relies on the assumption that U has conditional median
zero without knowing that U follows the standard normal distribution. The critical values
are obtained via subsampling. The subsample sizes (m) and original sample sizes (n) were
(m, n) = (20, 50), (30, 100), (35, 200), respectively.
Figure 4 shows the power functions with the 5% level test. Not surprisingly, relative to
the left panel of Figure 2, the power does not increase rapidly as Œ± gets large or n increases.
Note that this is consistent with the theoretical result that the test with the maximum score
estimation has local power at a rate of n‚àí1/3 .
D.2. Quantile Regression. In this section we investigate finite sample properties of the
proposed test for the quantile regression model. In particular, we consider the median
regression model (œÑ = 0.5):
Y

= Œ≤0 + Œ≤1 X + Œ±Zœà (T, Œ≥) + U,

where œà (T, Œ≥) = 1 {T > Œ≥}. The true parameter values are set as Œ≤0 = 0.5, Œ≤1 = 1,
Œ≥ = 0.5. When the null hypothesis is true, the parameter Œ± is equal to zero. Under the
alternatives, Œ± has various non-zero values from 0.2 to 1. The covariates X and Z are
generated independently from N (0, 1) and N (0, 2), respectively. The covariate T follows

<-----Page 49----->TESTING FOR THRESHOLD EFFECTS

49

the uniform distribution on the interval [0, 1] for the threshold model. The error term U is
generated from the standard normal distribution.
Parameters other than Œ≥ are estimated by the linear programming method for the standard linear quantile regression model, and the threshold parameter Œ≥ is estimated by the
grid search. For the grid, we use the data points of T after trimming at lower and upper
10th percentiles. We consider three different sample sizes, n = 50, 100, and 200, and replicate each simulation design 1000 times. For the simulation number of the score functions,
we set J = 2000.
In addition, we estimate Vb (Œ≥) and Ve by (3.9) since regression errors are independent of

regressors. Finally, we use the standard normal density as the the kernel function K and
Silverman‚Äôs rule of thumb for h = 1.06 √ó œÉÃÉn‚àí1/5 , where œÉÃÉ is the sample standard deviation
of UÃÉ := Yi ‚àí X0i Œ≤ÃÉ.

Figure 5. Power Functions of Threshold Quantile Regression Models
Threshold Quantile
1.0

n=200
n=100
n=50
0.8

size: 5%

Power

0.6

0.4

0.2

0.0
0

0.2

0.4

0.6

0.8

1

Slope Variable

Figure 5 shows the power functions for the 5 % level test. Under the null of Œ± = 0, the
rejection rates of the test are about 2% lower than the nominal level. The figure shows the
power of the test increases fast as Œ± or n gets large.

<-----Page 50----->50

LEE, SEO, AND SHIN

D.3. Maximum Rank Correlation Estimation. For the simulation study of the MRC
estimator, we use the following data generating procedure:
T (Y ) = Œ≤1 X1 + Œ≤2 X2 + Œ±Z ¬∑ 1 (T > Œ≥) + U
where covariates, X1 , X2 , Z and T, are generated independently from N (0, 4) , N (0, 1) , N (0, 1) ,
and the uniform distribution on the interval [0, 1] , respectively. The error term U is generated from N (0, 1) . We set the transformation function T (y) log y. The parameter Œ≤1 is
normalized as 1, and other parameters are set as Œ≤ = 1 and Œ≥ = 0.5. The parameter Œ± is
equal to zero under the null hypothesis, and varies from 0.2 to 1 under the alternatives.
Note that the constant term is not identified in the unknown transformation model, so we
drop it from the model.
We estimate all parameters using the grid search. The girds used for each parameter
are as follows: the 51 points equally spaced on the interval [‚àí1, 3] are used for estimating
Œ≤2 , the 51 points on [‚àí1, 2] for Œ±, and the 36 points on [0.1, 0.9] for Œ≥. We consider three
sample sizes, n = 50, 100, and 200, and replicate each design 1,000 times. We calculate the
simulated p-value with J = 1, 000.

Figure 6. Power Functions of Threshold Models with Maximum Rank Correlation Estimation
Transformation Model (MRC)
1.0

n=200
n=100
n=50
0.8

size: 5%

Power

0.6

0.4

0.2

0.0
0

0.2

0.4

0.6

Slope Variable

0.8

1

<-----Page 51----->TESTING FOR THRESHOLD EFFECTS

51

Simulated critical values can be obtained using numerical derivatives as in Section 7 of
Sherman (1993). Specifically, we use the smooth objective function in the simulation step
by substituting the standard normal cdf for the indicator function with an appropriate
bandwidth. Figure 6 shows the power functions for the 5 % level test. Overall, test seems
to perform well as in previous examples.
We now explain how to obtain critical values in detail below:
(1) Given the data, estimate the parameter under the null and the alternative, Œ≤e and
 
Œ∏ÃÇ, Œ≥ÃÇ , respectively. Construct the test statistic QLRn using the estimates.

(2) Recall some notation here:

Qn (Œ∏, Œ≥) = Un œáŒ∏,Œ≥ (Yi , Yj , WŒ≥,i , WŒ≥,j )
X

1
0
0
1 (Yi > Yj ) 1 WŒ≥,i
Œ∏ > WŒ≥,j
Œ∏
=
n (n ‚àí 1) i6=j
and
¬µŒæ,Œ≥ (Yi , Yj , Wi , Wj ) = œá(Yi , Yj , WŒ≥,i , WŒ≥,j ) ‚àí œá
eb (Yi , Yj , Xi , Xj )




0
0
= 1 (Yi > Yj ) 1 WŒ≥,i
Œ∏ > WŒ≥,j
Œ∏ ‚àí 1 X0i b > X0j b .

Replace indicator functions in the objective function with the standard normal cdf.
Now, ¬µŒæ,Œ≥ is twice differentiable with respect to Œæ (slightly abuse notation and use
the same ¬µ, œá etc.) The first order derivative of ¬µŒæ,Œ≥ is
Ô£Æ

where

‚àÇ
œá
‚àÇŒ∏ Œ∏,Œ≥

Ô£π

‚àÇ
Ô£ª,
¬µŒæ,Œ≥ = Ô£∞
‚àÇŒæ
‚àÇ
‚àí ‚àÇb œá
eb
 


‚àÇ
(WŒ≥,i ‚àí WŒ≥,j )0 Œ∏ WŒ≥,i ‚àí WŒ≥,j
Yi ‚àí Yj
œÜ
œáŒ∏,Œ≥ = Œ¶
‚àÇŒ∏
a
a
a
 

0 
(Xi ‚àí Xj ) b Xi ‚àí Xj
Yi ‚àí Yj
‚àÇ
œÜ
œá
eb = Œ¶
.
‚àÇb
a
a
a

<-----Page 52----->52

LEE, SEO, AND SHIN

The bandwidth a is set as a = 2œÉÃÇn(‚àí3/5) where œÉÃÇ is the sample standard deviation
of the argument in the function, i.e. Yi ‚àí Yj , (WŒ≥,i ‚àí WŒ≥,j )0 Œ∏ etc. The second
derivative is

Ô£Æ

‚àÇ
¬µŒæ,Œ≥ = Ô£∞
‚àÇŒæ‚àÇŒæ 0

‚àÇ2
œá
‚àÇŒ∏‚àÇŒ∏ 0 Œ∏,Œ≥

0

0

‚àÇ2
eb
‚àí ‚àÇb‚àÇb
0œá

where diagonal elements can be computed easily.

Ô£π

Ô£ª,

b n , for each (i, j), we mul(3) To generate the simulated empirical U-process, say U

tiply Vij = Vi + Vj to ¬µŒæ,Œ≥ (Yi , Yj , Wi , Wj ), where Vi and Vj are generated from

Gamma(0.25, 0.5), independently.
(4) Then the simulated test statistic is
0 
‚àí1  

 
 ‚àÇ
 ‚àÇ
2
1
‚àÇ
bn ‚àí Un
bn ‚àí Un
sup
‚àíUn
rn U
.
rn U
¬µ
¬µ
¬µ
‚àÇŒæ ŒæÃÉ,Œ≥
‚àÇŒæ‚àÇŒæ 0 ŒæÃÉ,Œ≥
‚àÇŒæ ŒæÃÉ,Œ≥
Œ≥ 2

(5) Simulate the same statistic J times for a large J, and calculate the simulated pvalue as in the main text (that is, the proportion of simulated test statistics that
are greater than the original test statistic).
References
Abrevaya, J. (1999). Leapfrog estimation of a fixed-effects model with unknown transformation of the dependent variable. Journal of Econometrics 93 (2), 203‚Äì228.
Andrews, D. W. K. (1993). Tests for parameter instability and structural change with
unknown change point. Econometrica 61 (4), 821‚Äì856.
Andrews, D. W. K. (2001). Testing when a parameter is on the boundary of the maintained
hypothesis. Econometrica 69 (3), 683‚Äì734.
Andrews, D. W. K. and W. Ploberger (1994). Optimal tests when a nuisance parameter is
present only under the alternative. Econometrica 62 (6), 1383‚Äì1414.
Andrews, D. W. K. and W. Ploberger (1995). Admissibility of the likelihood ratio test
when a nuisance parameter is present only under the alternative. The Annals of Statistics 23 (5), 1609‚Äì1629.

<-----Page 53----->TESTING FOR THRESHOLD EFFECTS

53

Card, D., A. Mas, and J. Rothstein (2008). Tipping and the dynamics of segregation.
Quarterly Journal of Economics 123 (1), 177‚Äì218.
Cavanagh, C. and R. Sherman (1998). Rank estimation for monotonic index models. Journal of Econometrics 84 (2), 351‚Äì381.
Chan, K. S. (1993). Consistency and limiting distribution of the least squares estimator of
a threshold autoregressive model. Annals of Statistics 21, 520‚Äì533.
Cho, J. S. and H. White (2007). Testing for regime switching. Econometrica 75 (6), 1671‚Äì
1720.
Cox, C. (1987). Threshold dose-response models in toxicology. Biometrics 43 (3), 511‚Äì523.
Cox, D. (1972). Regression models and life tables. Journal of the Royal Statistical Society
Series B 34, 187‚Äì220.
Cox, D. (1975). Partial likelihood. Biometrika 62, 269‚Äì276.
Davies, R. B. (1977). Hypothesis testing when a nuisance parameter is present only under
the alternative. Biometrika 64, 247‚Äì254.
Davies, R. B. (1987). Hypothesis testing when a nuisance parameter is present only under
the alternative. Biometrika 74 (1), 33‚Äì43.
Delgado, M. A. and J. Hidalgo (2000). Nonparametric inference on structural breaks.
Journal of Econometrics 96 (1), 113‚Äì144.
Delgado, M. A., J. M. Rodriguez-Poo, and M. Wolf (2001). Subsampling inference in cube
root asymptotics with an application to Manski‚Äôs maximum score estimator. Economics
Letters 73 (2), 241‚Äì250.
Durlauf, S. N. and P. A. Johnson (1995). Multiple regimes and cross-country growth
behavior. Journal of Applied Econometrics 10 (4), 365‚Äì384.
Fan, J., H.-N. Hung, and W.-H. Wong (2000). Geometric understanding of likelihood ratio
statistics. Journal of the American Statistical Association 95 (451), pp. 836‚Äì841.
Fan, J., C. Zhang, and J. Zhang (2001). Generalized likelihood ratio statistics and wilks
phenomenon. The Annals of Statistics 29 (1), pp. 153‚Äì193.

<-----Page 54----->54

LEE, SEO, AND SHIN

Forbes, K. J. and R. Rigobon (2002). No contagion, only interdependence: Measuring stock
market co-movements. Journal of Finance 57 (5), 2223‚Äì2261.
Ghosal, S., A. Sen, and A. W. van der Vaart (2000). Testing monotonicity of regression.
Annals of Statistics 28 (4), 1054‚Äì1082.
Han, A. K. (1987). Non-parametric analysis of a generalized regression model : The maximum rank correlation estimator. Journal of Econometrics 35 (2-3), 303‚Äì316.
Hansen, B. E. (1996). Inference when a nuisance parameter is not identified under the null
hypothesis. Econometrica 64 (2), 413‚Äì430.
Hansen, B. E. (1999). Threshold effects in non-dynamic panels: Estimation, testing, and
inference. Journal of Econometrics 93 (2), 345‚Äì368.
Khan, M. S. and A. S. Senhadji (2001). Threshold effects in the relationship between
inflation and growth. IMF Staff Papers 48 (1), 1‚Äì21.
Kim, J. and D. Pollard (1990). Cube root asymptotics. Annals of Statistics 18 (1), 191‚Äì219.
Koenker, R. (2005). Quantile Regression, Volume 38 of Econometric Society monographs.
Cambridge University Press.
Kosorok, M. R. and R. Song (2007). Inference under right censoring for transformation
models with a change-point based on a covariate threshold. Annals of Statistics 35 (3),
957‚Äì989.
Lee, S. and M. H. Seo (2008). Semiparametric estimation of a binary response model with
a change-point due to a covariate threshold. Journal of Econometrics 144 (2), 492‚Äì499.
Liu, X. and Y. Shao (2003). Asymptotics for likelihood ratio tests under loss of identifiability. Annals of Statistics 31 (3), 807‚Äì832.
Manski, C. F. (1975). Maximum score estimation of the stochastic utility model of choice.
Journal of Econometrics 3 (3), 205‚Äì228.
Manski, C. F. (1985). Semiparametric analysis of discrete response. Asymptotic properties
of the maximum score estimator. Journal of Econometrics 27 (3), 313‚Äì333.
Manski, C. F. (1988). Identification of binary response models. Journal of the American
Statistical Association 83 (403), 729‚Äì738.

<-----Page 55----->TESTING FOR THRESHOLD EFFECTS

55

Pastor, R. and E. Guallar (1998). Use of tow-segmented logistic regression to estimate
change-points in epidemiologic studies. American Journal of Epidemiology 148 (7), 631‚Äì
642.
Pastor-Barriuso, R., E. Guallar, and J. Coresh (2003). Transition models for change-point
estimation in logistic regression. Statistics in Medicine 22, 1141‚Äì1162.
Pesaran, M. H. and A. Pick (2007). Econometric issues in the analysis of contagion. Journal
of Economic Dynamics and Control 31 (4), 1245‚Äì1277.
Pons, O. (2003). Estimation in a Cox regression model with a change-point according to a
threshold in a covariate. Annals of Statistics 31 (2), 442‚Äì463.
Roy, S. (1953). On a heuristic method of test construction and its use in multivariate
analysis. Ann. Math. Stat. 24, 220‚Äì238.
Schwartz, P. F., C. Gennings, and V. M. Chinchilli (1995). Threshold models for combination data from reproductive and development experiments. Journal of the American
Statistical Association 90 (431), 862‚Äì870.
Sherman, R. (1993). The limiting distribution of the maximum rank correlation estimator.
Econometrica 61 (1), 123‚Äì137.
Song, R., M. Kosorok, and J. Fine (2009). On asymptotically optimal tests under loss of
identifiability in semiparametric models. Annals of Statistics 37, 2409‚Äì2444.
Tong, H. (1990). Non-linear Time Series: A Dynamical System Approach. New York:
Oxford University Press.
van der Vaart, A. W. and J. A. Wellner (1996). Weak Convergence and Empirical Process.
Springer, New York.
Zhang, J. and P. Cheng (1989). The asymptotic powers of some pp tests. Jour. Sys. Sci.
and Math. Sci. 9, pp. 370‚Äì382.
Zhang, J. and G. Li (1993). A new approach to asymptotic distributions of maximum
likelihood ratio statistics. In K. Matusita, M. L. Puri, and T. Hayakawa (Eds.), Statistical
Science and Data Analysis: Proceedings of the third Pacific Area Statistical Conference,
the Netherlands, pp. 325‚Äì336. International Science Publishers.

<-----Page 56----->56

LEE, SEO, AND SHIN

Zhu, H. and H. Zhang (2006). Asymptotics for estimation and testing procedures under
loss of identifiability. Journal of Multivariate Analysis 97 (1), 19‚Äì45.
Department of Economics, Seoul National University, 599 Gwanak-ro, Gwanak-gu, Seoul,
151-742, Republic of Korea, and Centre for Microdata Methods and Practice, Institute
for Fiscal Studies, 7 Ridgmount Street, London, WC1E 7AE, UK.
E-mail address: sokbae@gmail.com
URL: http://www.ifs.org.uk/people/profile?id=46.
Department of Economics, London School of Economics, Houghton Street, London,
WC2A 2AE, UK.
E-mail address: m.seo@lse.ac.uk
URL: http://personal.lse.ac.uk/SEO.
Department of Economics, University of Western Ontario, 1151 Richmond Street N,
London, ON N6A 5C2, Canada.
E-mail address: yshin29@uwo.ca
URL: http://publish.uwo.ca/~yshin29.

