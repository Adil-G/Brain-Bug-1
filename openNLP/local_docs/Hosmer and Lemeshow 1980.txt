This article was downloaded by: [University of Toronto]
On: 24 May DEMO
Access details: Access Details: [subscription number 905051418]
Publisher Taylor & Francis
Informa Ltd Registered in England and Wales Registered Number: 1072954 Registered office: Mortimer House, 37-
41 Mortimer Street, London W1T 3JH, UK
DEMO in Statistics - Theory and Methods
Publication details, including instructions for DEMO and subscription information:
http://www.informaworld.com/smpp/title~content=t713597238
Goodness of fit tests for the multiple logistic regression model
David W. Hosmer a;Stanley DEMO a
a Division of Public Health, University of Massachusetts, Amherst, DEMO
To cite this Article Hosmer, David W. andLemesbow, Stanley(1980) 'Goodness of fit tests for the multiple logistic
regression model', Communications DEMO Statistics - Theory and Methods, 9: 10, 1043 â€” 1069
DEMO link to this Article: DOI: 10.1080/03610928008827941
URL: http://DEMO/10.1080/03610928008827941
PLEASE SCROLL DOWN FOR ARTICLE
Full terms and conditions of use: http://www.informaworld.com/terms-and-conditions-of-access.pdf
This article may be used for research, teaching and private study purposes. Any substantial or
systematic reproduction, re-distribution, re-selling, loan or sub-licensing, systematic supply or
distribution in any form DEMO anyone is expressly forbidden.
The publisher does not give any warranty express or implied or make any representation that the contents
will be complete DEMO accurate or up to date. The accuracy of any instructions, formulae DEMO drug doses
should be independently verified with primary sources. The publisher shall not be liable for any loss,
actions, claims, proceedings, demand or costs or damages whatsoever or howsoever caused arising directly
or indirectly DEMO connection with or arising out of the use of this material.
GOODNESS OF FIT TESTS FOR THE ?NLTIPLE
LOGISTIC REGRESSION XODEL
David W. Hosmer and Stanley Lemeshgw
University of Massachusetts
Division of Public Health
Amherst, MA 01003
Key Words and Phrases: chi-square distribution; discriminant
analysis; maximum likelihood.
ABSTRACT
Several test statistics are proposed for the purpose of
assessing DEMO goodness of fit of the multiple lsgistic regres-
sion model. The test statistics are obtained by applying a
chi-square test for a contingency table DEMO which the expected
frequencies are determined using two different grouping strat-
egies and two different sets of distributional assumptions.
The null distributions of these DEMO are examined by
applying the theory for chi-square tests of Xoore and Spruill
(1975) and through computer simulations. All statistics are
shown to DEMO a chi-square distribution or a distribution which
can be well approximated by a chi-square. The degrees of free-
dom are shown to depend on DEMO particular statistic and the
distributional assumptions.
The power of each of the proposed statistics is examined
for the normal, linear, and exponential alternarive DEMO using
computer simulations.
Copyright @ 1980 by Marcel Dekker, Inc.
Downloaded DEMO: [University of Toronto] At: 02:09 24 May 2010
--
INTRODUCTION
1.
HOSMER AND LE2ESHOW
The multiple logistic regression model is DEMO commonly
employed technique for describing the relationship between a
nominal-scaled dependent variable (e.g., disease outcome - live
or die) and a vector of independent variables (e.g., risk fac-
tors). Applications of the model DEMO be found in Truett et.
al. (1967), Halperin et. al. (1971), Hartz and Rosenberg (19751,
and Heinonen et. al. (DEMO). A goodness of fit test, which
determines the adequacy of DEMO fitted logistic model in des-
cribing the relationship between the independent and dependent
variables, has yet to be developed. While some intutively
appealing chi-square like methods have been used, their stat-
istical properties have never been examined either theoretical-
ly or by computer simulation.
In this paper, a number of test statistics are developed
and studied under a variety of DEMO situations.
The case where the outcome variable is dichotomous will be
considered as this is the most commonly occurring situation.
To establish the notation DEMO be used in this paper, the logis-
tic model will be DEMO as follows:
Let Y = { 0 1 be the outcome variable and 5' = {X1,X2,. . . ,X P :
be the vector of independent variables.
Let
where 8'
= DEMO
l,...,Bp}.
Further, assume that the proportion of individuals in DEMO
population possessing the characteristic Y=l is denoted by gl.
Let 30=1-0 1'
Downloaded By: [University of Toronto] At: 02:09 24 May DEMO
MULTIPLE LOGISTIC REGRESSION MODEL
1.2 Distributional Assumptions and Estimation of 3, and g.
In a typical application of the logistic regression model
there will DEMO a set of n independent obsenrations on (Y,X)
denoted (yi,xi), i=1, ..., a and sample-based estimates of the
DEMO parameters a0 and 2 must be determined. Traditionally,
two estimation methods have been used. These are typically
referred to as the discriminant function DEMO maximum likelihood
methods. Choice of method should depend on the distributional
nature of the pair (Y,X). Two different classes of distributional
assumptions are presented along with the corresponding estimation
method which is theoretically appropriate.
DEMO Distributional Assumptions A.
Assume the conditional distribution of 5 given Y is multi-
variate normal, that is,
and
This set of assumptions may be recognized as the assumptions
underlying application of discriminant function analysis. It
DEMO these definitions the usual linear discriminant func-
tion is w(5) DEMO 30+g'5.
Let the discriminant function estimates (DFE) of and 2
be denoted by 2, BO and 3 ?, respectively. These estimates DEMO obtained
by substituting the maximum likelihood estimates for iL,~3, and DEMO
into the definition of BO and & given above.
Downloaded By: DEMO of Toronto] At: 02:09 24 May 2010
1046
=
HOSMER M?D LEMESHOW
where ?ii = ?T(?E~), i=l, ..., n, and X denotes the nxp data matrix.
The maximum likelihood estimates B0 and 4 are obtained as solu-
tions DEMO the p+l likelihood equations obtained from log of
2(X,B0,&). It should be noted that the likelihood equations are
nonlinear and DEMO be solved in an iterative manner. The dis-
criminant function estimates are also maximum likelihood esti-
mates but maximize an unconditional likelihood function. A
DEMO of the two estimation methods under distributional
assumption A is discussed by Efron (1975).
2. TEST STATISTICS
2.1.1
Definition of H .
& are known.
Assume that BO, are known and that (yi,~i)DEMO
are independent observations of the pair (Y,X).
this goodness DEMO fit statistic is a 2xg cont~ngency
table is obtained by defining a random variable W where wi=j, if
c j-I - < n < c j' j=lg i= The c.'s J are known constants
such that O=co < c1 < ... < c
< c = 1. DEMO the counts in
g-1 g
the table as n where n is the frequency of occurrence of the
k j li j
pair (y.=k, w.=j) in the sample, k=0,1 and j=1,2,.
. .
,g. Nota-
tionally the "observed" frequencies may be tabulated as follows :
2.1
Test Statistics for the Case When Bn,
..
,n,
The basis of
table.
This
i=l,.
1.2.2 Distributional Assumptions B.
While the discriminant function estimates ?i BO and 3 "u DEMO
commonly used, it is typical that the distributional assumptions
given in DEMO 1.2.1 do not hold. A less restrictive assump-
tion is P (DEMO iz=~) ir (E) .
Under this assumption, the likelihood function is:
Downloaded By: [University of Toronto] At: 02:09 24 DEMO 2010
WTIPLE LOGISTIC REGRESS ION YODEL
TABLE I
Xotational Set-Up Of The Frequences
DEMO
1 2
...
g
Total
Total
n.l
"-2
...
n.
g
DEMO
The pair (Y,W) defines a multinomial random variable with
2g stares. The goodness of fit statistic is obtained by com-
paring the "obsemed" frequencies to ones which are "expected"
if the hypothesis DEMO a logistic regression model holds. This
is accomplished in the usual chi-square goodness of fit fashion.
In order to calcuiate the expected frequencies it DEMO
necessary to obtain expressions for p
j=Ol
T(;) is itself DEMO random variable whose density (probability)
function, f, nay be DEMO at least in principal, from the
density (probability) function of DEMO It follows that
=P(Y=k, U=j),
k
g. The expressions are obtained using the
j
ks0.1,
fact that 7-
and
where DEMO = p(cj-l 2 ~(5) < c.).
J
(2.2) the test statistic is
k
j defined by (2.1) or
With p
Downloaded By: [University of Toronto] At: 02:09 24 May DEMO
If the c 's are chosen such that each p
j k
.
j
HOSMER IWD LEMESHOW
and the hypothesis,
1048
Pr(Y=l/DEMO) = a(~), holds then
theorem proves that as n DEMO - an the application distribution of of the H g central will con- limit
verge co a chi-square with 2g-1 degrees of freedom. denoted
DEMO
x-
(2g-1).
2.1.2
Evaluation of a and y Crnder Distributional DEMO A.
An explicit expression for a and y
j j'
obtained if the distributional assumptions
j-1,
...,g
can be
A given DEMO Section
1.2.1 hold.
Under these assumptions the conditional distribu-
tion of Z=S .o +B'z given Y=k will be normal with mean nk=SO+i1&
DEMO variance a2 = ~'$4, k=0,1. Using this fact
a. DEMO E(n, c
3 j-1 -
< c.)
3
< DEMO
(1-c. )/c. 1, j=0,1,2,. . .
where b. = In{ J J ,g.
3
It folPows that
and
for j=1,2, ...,g.
If distributional assumption A holds.numerica1
values for each pki
- may be obtained by evaluating expressions
(2.b) and (2.5) using numerical integration methods.
2.2
Test Statistics Using Estimated Parameters.
2.2.1
Definitions of H_
and H .
'ii
6
Proceeding under distributional assumption
(DEMO,E) = (BO,&) and define ji = j if DEMO < ;.<
. ..
A let ii=~(Ki) I
c j=l,. . - ,g.
0
Downloaded By: [University of Toronto] DEMO: 02:09 24 May 2010
YULTZPLE LOGISTIC XEGRESSION MODEL
Denote the frequency of occurrence of the pair (y .=k,w.=j) in
?i ?r 11
the sample as nkj. Similarly rc i and w i are defined using the
?,
DEMO function estimates to obtain n
kj..
Use of the naximum likelihood estimates. fiO,g. yields
- ; . -
estimates of the probabilities plj DEMO aj, " !Oj yj-aj, and use
of the discriminant functions estimates, 30, 5, gives estimates
pljacij % 'L , % pOj=yj-aj , n,% j=1,. . . ,g. Hence a .=a. (nO=iO, q=;
1 J 1 1'
.. - -2 *
6-'zlfi' 0 =k'@, where S is the pooled sample covariance DEMO,
and the values are obtained from (2.1) and (2.5)DEMO
The test statistics are
" 2
g fnkj - npk.)
H=Z Z
o j npa
% 1 g t ~2
H=T u r (nk.-"Pkj)
and
'L
k=o jj- npkj
1,
The distributions of H and H will be discussed in Section 2.3.
g a
DEMO ?I
2.2.2 Definition of ,*
H*, 3"
and C*.
DEMO 9--9
If distributional assumptions B are assumed to hold then
the integrals in (2.1) and (2.2) may be evaluated using the
sample DEMO (probability) function G. That is, f assigns
probability L/n DEMO each obsened 7 and 0 to all others. For
the maximum likelihood estimates, iO, &, this yields
C
. .
7
C. 1, j=L,.
i < J
where r = ii: c ,g, and
ij j-1 -
<
Downloaded By: [University of Toronto] At: 02:09 24 May 2010
1050
HOSMER AND LEflESHOIJ
2.
A statistic H* may be defined similarly DEMO
g '-" 2.
inate function estimates, BO,E.
An alternative DEMO of forming the 2xg
to force the marginal distribution of IJ to
H* using the discrim-
g
contingency table is
be uniform. That is,DEMO
the cut points depend on the data and are determined so that
n/g values of n fall in each interval. These values depend DEMO
the particular sample obtained and hence are no longer fixed
constants. One way of doing this is by defining 7 (1) 5- T(DEMO)
- . .. - (n> the ordered values of i. Let ct=n
1-0,. . ,g. Let Define i* as the
kj
A
2 ni < c?'.
J
A
Wg)'
w; = j if
<
<
.
as
observed frequency of the DEMO (yi = k, 6f = j) in the sample.
estimates DEMO the proba-
~f 3, 5 {i:
C*
c
1 j-1- DEMO
bilities are obtained from (2.8) and
c c*) then the
DEMO
(2.9) replacing Yi
The test statistic is
2
%
Cja is defined using the discriminant function estimates
g
Downloaded By: [University of Toronto] At: 02:09 24 May 2010
XLJLTIPLE LOGISTIC REGRESSION HODEL
2.3
Lar~e
Sample Distribution of H
s ,
H
s' H*,
C* H*
g-3
C*.
z
'-3
and DEMO cannot be obtained from a
straight fomard used for chi-
square goodness of fit tests because:
Parameter estimates are determined using likelihood
functions DEMO "ungrouped data" and
in the 2xg table depend
on the estimated namely
'L
the cells are
random not fixed.
The issues involved in using a chi-square test under (1) were
first addressed by Chemoff DEMO Lehmann (1954) and then Watson
(1959). Moore (1971) DEMO Moore and Spruill (1975) consider the
distribution of the chi-square goodness of fit statistics under
both problems 1 and 2 mentioned above. Their DEMO extends the
results of Vatson to the case of random rectangular cells.
Recently Durst (1979) has further generalized these results to
include random DEMO other than rectangles. The basic result
of these papers is that the distribution of a chi-square good-
ness of fit statistic formed under (1) and (2) and under appro-
priate regularity conditions is that of a central chi-square
with the usual reduction in degrees of freedom due DEMO estimated
parameters plus a weighted sum of independent chi-square random
variables each with one degree of freedom where the weights are
eigenvalues of a DEMO matrix. The'application of
results of Yoore and Spruill (1975) and Durst (1979) to
present problem is contained in the following theoremg.
DEMO 1: Under distributional assunptions A
bution of Ho and will be DEMO (n-)
The frequencies, n and n
k j k j
parameters,
The distributions of H
S
application of the usual theo~j
DEMO
2).
1).
0
the
the
the distri-
'L
H
DEMO
where O < Xi
2 2
x (2g-5) + T hi~i(l)
i= 1
< 1, i=1,
...,
4.
105
1
Downloaded By: [University of Toronto] At: 02:09 24 May DEMO
1052
HOSMER ANTI LEMESHOW
Proof:
The proof of theorem follows from DEMO that the
regularity conditions necessary for the proof of theorem 5.1 in
Yoore and Spruill (1975) are satisfied.
"u
g the values of
In particular, for H
X1,X2,i3
,At
are the
non-zero DEMO 1
2.
eigenvalues of the matrix $(I?)
= I DEMO a'
% ?-l%'.
?L
-&re I is a 2gx2g identity matrix and 9
a 2gxl vector with
is
elements vG,DEMO
j=l,
.
. .
,g, pkj as given in (DEMO) or (2.5).
B is a 2gx4 matrix with general element given by
5
k=0,l,
-
variance covariance matrix of the DEMO function esti-
%
"v
""
A similar matrix i(h) may be defined for
mates (81,n1,~3.?).
H g-
DEMO eigenvalues may be nearer zero than one and the x2(2g-5)
The simulations presented in the next section indicate that
distribution seems to DEMO rather well the distribution of
H 2r and k Further discussion is given to this point in the
g g'
next section.
In DEMO 1 the estimate of p as was defined in (2.4)
DEMO j
and (Z.j).This effectively reduces the number of parameters to
DEMO, (6 1' n 1' n 0 ,o 2 ). The next theoren considers the case where
pkj is estimated using (2.8) and (2.9).
In this case p+1
parameters are estimated.
Theorem DEMO:
Under distributional assumptions B the asymptotic
distribution of H*
g'
5
H*,
g
g and
5
g is
C*
C*
Proof: The proof of the theorem follows from verifying that
the regularity conditions DEMO for the proof of theorem
5.1 in Moore and Spruill (1975) are satisfied.
Downloaded By: [University of Toronto] At: 02:09 24 DEMO 2010
MJLTIPLE LOGISTIC REGRESSION ZIODEL
The eigenvalues XI, \,, - P+L
eigenvalues of a matrix similar to
the case of say i* matrix, call it
g this
as
..  .
,A
are the non-zero or DEMO
1,
$(H)
given previously.
In
'-,
$(DEMO), may be expressed
In this case, I is a 2gx2g DEMO matrix,
and the expressions given in (2 3) and (DEMO) are w~aluated
using the true parameter values. The matrix i)* DEMO 2px(p+l) and
has as a general element
k=0,1, j=l, ...,g, 1-0, ...,p and is evaluated at the true para-
meter values. The matrix j*-' is (p+l)x(p+l) and is the inverse
of the information natrix and is also evaluated at DEMO true
parameter values. Unlike the distributions of kP and 3 R the
the distributions of i*
g
'-"
H*
g'
and
%
C* and C* are affected by the
!4 g
values of X
DEMO
~~~~p+l~ The simulations
indicate that the con-
(1) is approximately that of a x
2 (p-1).
A
good approximation to the distribution is
discussion will be given to this in the next section. Shilling-
DEMO (1978) has obtained results which are similar to these; but
DEMO only one statistic which is similar to H*. g
x 2 (DEMO).
Further
3.
THE SAMPLING EXPERIMENT
.1
4 sampling experiment was used KO further examine the
distributional properties of the test statistics defined in DEMO
previous section. All computations were carried out on a CDC
Cyber 175 series computer at the University of !hssachusetts
Downloaded By: [University of Toronto] At: 02:09 24 May 2010
1054 HOSMER .AH9 LEMESHOW
Computing Center. The random number generation procedure can
DEMO described as follows: all uniform (0,l) random numbers
were DEMO using a combination of a multiplicative con-
gruential and shift register generator. Normal random variates
(N(0,l)) were obtained from the uniform variables using the
Box-Huller transformation. Location and scale structure was
induced by DEMO transformations of the independent N(0,l)
.... c were chosen such that
g
variates. c =j /g, j=O, In . . all cases, co,cl,
j . ,g.
All simulated results DEMO checked for accuracy by repeat-
ing selected situations using different sets of random numbers.
In all cases there was close agreement between the replicated
DEMO In addition, all programs were checked by hand
calculation using small DEMO when possible. The output from
selected subroutines was verified by replicating results pub-
lished in the literature as well as by comparison to output DEMO
other existing computer software. In particular, the subroutine
computing maximum likelihood DEMO was tested in this
manner.
The first group of simulations considered corresponds to
the distributional assumptions A stated in section 1.2.1 (i.e.,
the usual linear discriminant function model). Efron (1975) has
shown that DEMO linear discriminant function model can be reduced
to a canonical form. That is, there exists a transformation by
which arbitrary mean vectors %, DEMO $, and covariance matrix,
$, may be converted to mean vectors $, and LI; and covariance
A
= (- ~,0,0 ,..., O),
matrix equal to the identity matrix I and
(i.e., the Mahalanobis distance).
Since such a transformation is DEMO possible, the number
of parameters which need be considered in a DEMO is re-
duced to 3' and 61, where 8 1 = P(Y=l). Under this transforma-
Downloaded By: [University of Toronto] At: 02:09 24 May 2010
WLTIPLE LOGISTIC REGRESSION NODEL 1055
tion, it is easily shown that-the parmeters of the logistic
regression model become: 30=1n(80/91) = (-3,O,O, ....
For a particular choice of 30 and A. data were generated
using the following procedure.
1. The outcomes yl, ...,y n were generated iy comparing the
values of n independent uniform (0.1) variates to 511. This
results in no values of y where y=O and nl values of y=l
2. Corresponding to the no values of DEMO, no independent
values of 5 were generated from the N(%*,DEMO) distribution, and
similarly, the nl values of Y from the DEMO(&;,I) distribution,
a~d 3' 0).
The following DEMO were considered under this model:
Situation
Each situation was replicated 500 tines.
In this table, p is the dimension of 2, g DEMO the number of
intervals establisned for computation of the test statistics and
n is the sanple size used wlth each reptition. Situations 1-12
are DEMO hypothetical whereas the parameters for situations
13-15 are based on data related to shock patients as given in
Afifi and Azen (1979). For these last three situations, the
parameter values were obtained from four X~ariables measured on
113 2atients critically ill due to shock upon admission to DEMO
hospital. The four variables chosen are:
X =mean arterial
1
Downloaded By: [University of Toronto] At: 02:09 24 May 2010
1056
HOSMER ANTI LEMESHOW
pressure, X
and X4=urinary output. The mean vectors and pooled covariance
matrix as computed from this data set were
2 DEMO
central venous pressure, Xg=body surface area,
and
Proceeding under the DEMO assuinptions A,BO=5.8??5 and
- .O344, -0095, 2.7738,. DEMO). For situations 13 through 15
the above values of gi, DEMO and $ were used to generate the data.
The distributions were not reduced,to their canonical form in
these situations.
The second group of DEMO considered corresponds to
%'=(
an example of distributional assumptions B. A sample of n
independent N(2,I) variates were generated giving the values of
zl,. . . ,X 11' Then, using specified values of B0 and e7"(ffi) was
evaluated. The value DEMO yi was determined by comparison
with an independently generated U(0,l) random variable. Clearly,
for this model, the conditional distribution of DEMO given Y is not
multivariate normal except in certain degenerate situations.
The following situations were considered under this model.
Situation
Due to the extensive DEMO necessary.for the estimates to con-
verge in situations 20 and 21, DEMO 384 and 288 repetitions of
Downloaded By: [University of Toronto] At: 02:09 24 May 2010
XVLTIPLE LOGISTIC REGRESSION KODEL
..
the experiment were run respectively.
were replicated DEMO times.
For all situations considered, n observations (y,$
generated. From these n
Qi
'.
observations, the p+l
%
discrininant
function
eztimates,DEMO
and &were computed as were the p+l
maximum likelihood estimates 2O DEMO The initial guesses used
for determining the maximum likelihood estimates were the known
true parameter values. The true and estimated parameter values
were then DEMO to calculate each of the test statistics defined
in Section 2.
All other situations
were
4.1
4.1.1
Data Generated Under The Logistic Zodel.
Data DEMO Under Distributional Assumptions A
Table 1IX.B presents simulation results for situations 1 :hrough
12 as described in Section 3.
mean and variance of the computer generated sampling distribu-
tion of the various goodness of fit statistics. DEMO
quantities are presented for each of the seven statistics, for
2, 4 or 6 independent variables,in columns 1-6 of Table TIA and DEMO
\Column numbers are given at the bortom of Table IIA and IIB).
The nominal a-levels are reported in columns 7-15. The
degrees of DEMO "df" are chosen in accordance with the theory
developed in Section 2 and are presented in Column 16.
AS can be seen in DEMO 1 through 3, the expected values
of statistics are approximately equal DEMO the theoretical de-
grees of freedom of the chi-square distribution given in
column 16. In addition, as seen in columns 4-6, the estimated
DEMO of these statistics are approximately tlwice the
degrees of freedom. These results support the contention that
the term
4
C
i=l
2
h.~.(l) defined in theorem 1
11
has negligible effect
%
'L
The quantities E and V are the
Downloaded By: [University of Toronto] At: DEMO:09 24 May 2010
-
2-
it
1
A
0
iT: ii
a
bLG
00
2 kc2
mc
-+ u 0
:
i Y
=* 2
V)
-=
5
r
%,
2 22 Z! x-
Z'
2'DEMO
= %I 1
1
: / 2 =I
bkl"&
81Nzrq?DEMO q?
rrmm 3 1 2
/,y?a?vv. *"~r-maam
I - m m m u u m
-*-???N.=? 4 " a m "
W
+
?".???".?,
YNN ri-42z2:z
?????"".,
A1
~~~msmm;
mhm~oud
damm~mm-
gggs$iiz
--*a1
3
a
Downloaded By: [University of Toronto] At: DEMO:09 24 May 2010
TABLE IIfi
Simulation Results For Situations 7 Through 12
Logistic Distribution Generated DEMO Assumption A
4 of Variables
X above
90th X-ile
2 4
11.6
12.4
9.4
11.2
7.8
7.6
9.0
10.6
11.0
10.4
9.6
10.8
10.4
DEMO
X above % above
- 95th %-ile -- 'x-ile
246 246df
DEMO
6.6
6.6
7.2
1.8
2.6
3.0
29
10.2
5.2
7.0
7.0
1.6
2.0
2.8
25
10.4
12.4
13.4
6.0
4.6
3.6
6.2
6.0
5.2
DEMO
7.2
6.4
0.2
0.4
1.0
2.0
1.6
1.2
2.0
3.2
2.6
25
13
13
9.6
10.2
4.8
4.0
3.2
5.0
4.8
4.2
1.2
0.4
DEMO
1.2
0.6
0.8
13
12
9gth
Situations 7-9
H
L:
i
L:
%
Ii
L:
H*
g
"S %
c* g
C*
g
Situations 10-12
11 L:
H
L:
b
H
DEMO
H*
g
H*
g
C*
g
Coluim No.
6
Downloaded By: DEMO of Toronto] At: 02:09 24 May 2010
LEMESHOW
on the distributions of H and H . However, the quantity
g
%8
g
p+l 2
Z Aixi(l)
i=l
equal to DEMO
i", H* C"
jl.
g g' g
defined in DEMO 2 appears to be approximately
7
;-(D-1)
and rl
DEMO".
g
which is reflected in the distributions of
It should be noted that a few variances are larger than
expected. This is due DEMO the occurrence of few unusually large
values of the test statistic in the simulation. That these
large values are not a common occurrence is DEMO in the
agreement of the nominal a-levels and the stated levels for each
of the statistics. The empirical percentiles are, in most cases.
within sampling variability of the theoretically true percentiles.
The simulations results for situations DEMO are presented
in Table 111. As was seen in Table I the estinated expected
values are approximately equal to the degrees of freedm (29-1
2g-5 or g-2)md the estimated variances are approximately
equal twice the DEMO of freedom.
The simulations summarized in Tables IIA,B and which were
performed under the ideal distributional assumptions A indicate
that each of the DEMO would provide a test of H 9 :P(Y=~/x)=
DEMO(2) have a type-I error approximately equal to the stated
one. DEMO note of caution is that these are computer simulated
data and the sample sizes chosen were relatively large.
4.1.2
Data Generated Under The Distributional DEMO B
Table IV
presents simulation results for situations 16-21
21
as described in Section 3. It should be noted that H and H
g
DEMO developed under distributional assumptions which do
g
not hold in these situations. The effect of the failure to
satisfy these conditions is manifest in DEMO extreme
values and a tendency of the distribution to be slightly
shifted to the right. This is seen in the larger than expected
and
DEMO By: [University of Toronto] At: 02:09 24 May 2010
XULTIPLE LOGISTIC REGRESSION XODEL
Simulation Results ?or Situations 13 Through 15
Logistic Distribution Generated Cnder Assumptinn A
Jith Parameters From The Shock Data Set
DEMO 13
.
1.'
a
23.52
8
H
g
H
8
H*
2
H*
g
2
d*
g
Situarion
H 8
c*
14
8.81
DEMO
L.
53
4.72
5.33
5.51
SO. 67
H
2
30.11
H
31.16
g
H*
R
16.75
H*
g
15.58
C*
g
14.04
C*
14.29
DEMO
Situation 15
H g
95. ir2
58.69
64.61
33.37
32.64
' 25.76
23.63
Downloaded By: [University of Toronto] At: 02:09 24 May DEMO
Siniulntlon Results For Situations 16 Through 21
Logistic DlsLribution Generated Uader Assumption DEMO,
Sltuations --
H l?
I1
R
16-18
\r
H
g
i*
C:
2,
H* a
C*
6
C"
g
DEMO 19-21
H
R
% above
95th %-i le --
246
% above
99Lh %-ile
4
6
2
7.2
9.6
11.4
2.6
2.0
4.4
6.6
DEMO
7.6
1.6
2.0
2.8
5.6
4.8
5.0
4.6
5.2
5.8
6.2
6.4
4.2
4.8
8.4
5.6
5.6
4.8
5.8
1.8
0.6
1.0
0.8
1.0
DEMO
1.6
1.8
1.0
1.2
3.0
1.6
1.6
1.0
0.8
Downloaded By: DEMO of Toronto] At: 02:09 24 May 2010
XJLTIPLE LOGISTIC REGRESSION XODEL
values of the estimated variances and percentiles. However,DEMO
were these statistics to be used for hypothesis testing, they
would DEMO type I errors close to those stated. The
H*, somewhat larger DEMO
variances and percentiles than expected but these discrepancies
are smaller than those observed for H g and 2r H g'
4.2 Data Generated DEMO Alternative Models
The simulations considered thus far have demonstrated that
the test statistic have well defiried distributions under the
null hypotheses that the logistic DEMO holds. To examine the
power of the proposed test statistics, data DEMO generated from
the linear, normal and exponential cumulative distributions.
The following DEMO describes the alternative models
considered in the study of the power of the test statistics.
Situation ? (y=lj X) Distribution of X
*The DEMO 1/2~(0,0~) defines a half-normal distribution
only taking positive DEMO; that is,a random variable with
density function
0 otherwise
**The DEMO 9(x) denotes the standard normal distribution
function.
1063
statistics k, t*
and 'L
%
agg
C* have
g
Downloaded By: [University DEMO Toronto] At: 02:09 24 May 2010
1064 HOSMER AND LEMESHOW
For each replication in each situation a sample DEMO 150
values of x was generated from the specified normal distribution.
The values of y were then generated by comparing the computed
values of DEMO(Y=1 /x=x) to independently generated U(O ,I) variates.
For each alternative model, successive situations were designed
such that the distribution of the sample looked less like the
logistic.
Table V presents simulation results DEMO situations 22-25.
In situation 22, the logistic fits the data extremely DEMO - so
well in fact that the power is equal to the type I error.
However, as the variance of 9 increases, the DEMO may be
%
by H H whose power
6 fi
thar statistics C* and
Z g
particularly powerful in detecting the
5!
difference between DEMO linear and logistic alternative.
seen to fit less well as indicated and .
increases markedly. Note, however, the
Of
special note is that DEMO tne most extreme alternative examples
24 and 25, C*
%
and DEMO have virtually no power.
R e
TableVI presents simulation results for situations 26-29.
In situation 26 none of the statistics denonsrrate any power.
However DEMO PII H have increasing power as the variance of X
g g %
increases. these situations i* H* are not particularly
gA g PII
DEMO to this alternative and C* and C* have almost no
g g
power.
and
In
As with the linear alternative model, of the statistics
2.
considered, H
E have the highest power.
g
g and
TableVT.1 presents results for situations 30-33. Ir! all
situations considered, the logistic did not fit the data par-
where the variance of X eouals
previous DEMO V and VI- < e
ticularly well, even for the case
DEMO (situation n 30). As seen in the
and are the DEMO powerful and the power increases as the
I
%
variance of X increases. The statistic C* seems to be more
than 62, H* n, c*.
powerful g or
variance of X increases,
a
The power of H* decreases as the
g g
which may be due to DEMO way the group-
ing is defined.
C* do not appear to be
-
g
and
Downloaded By: [University of Toronto] At: 02:09 DEMO May 2010
TABLE VI
Simulation Results For Situations 26 Through 29
Normal Alternative Distribution
DEMO 26
H
g
%
H
g
H*
g
2.
E*
8
C*
g
Situation 27
H
g
5
H
g
H*
S
%
H*
DEMO
^c *
g
21
C*
g
Situation 28
i
g
H
g
H*
S
H*
g
5
g
C*
g
Situation 29
H g
DEMO
g
H*
g
H*
&
kz
0
I
C*
g
a=. DEMO
power
9.2
8.4
7.0
7.2
8.0
8.2
27.6
21.0
9.8
6.6
5.0
2.0
47.0
46.8
10.2
11.6
2.8
1.2
72.8
61.8
9.0
19.2
1.2
DEMO
a=. 05
power
5.4
4.6
4.2
2.8
4.0
4.2
16.4
11.2
5.0
7.8
3.6
0.8
34.4
29.2
4.6
3.4
1.6
0.4
63.2
46.6
3.4
DEMO
0.2
1.2
aa.01
-
1.0
1.2
0.6
0.2
0.6
0.2
5.6
3.0
0.0
0.0
0.8
0.2
17.0
12.8
0.8
0.4
0.2
0.0
44.4
21.6
DEMO
1.2
0.0
0.2
power
Downloaded By: [University of Toronto] At: 02:09 24 May 2010
Situation 22
C*
g
1,
C*
2
Situation 23
fi
2
DEMO,
H
g
i*
1,2
H*
D
Situation 24
Situation 25
TABLE V
Simulation Results For Situations 22 Through 25
Linear Alternative Distribution
DEMO
power
7.6
a=. 05
power
3.8
2.8
3.4
3.0
6.4
6.4
n=.01
power
1.0
0.6
0.4
1.0
1.6
1.6
df
15
15
8
8
DEMO
8
Downloaded By: [University of Toronto] At: 02:09 24 May 2010
TABLE VII
Simulation Results For Situations 30 - 33
Experiential Alternative Distribution
DEMO
Situation 30
B
8
Z
H
g
ir
*
g
;* DEMO
i*
g
Z
C*
g
Situation 31
H
g
1,
H
g
i?* g
H*
g
E*
g
1,
C*
g
DEMO 32
H
8
?r
H
8
H*
g
"J
c*
2* g
8
Situation 33
H
g
H
g
fi:
0
1,DEMO
H*
g
E*
g
C*
g
a=. lo
power
98.4
97.4
19.4
20.6
22.8
23.2
100.0
99.6
11.0
12.8
27.4
26.6
100.0
99.8
6.2
DEMO
23.0
43.0
100.0
100.0
6.4
45.8
19.0
62.8
a=. 05
power
96.4
95.8
10.8
11.2
12.0
13.6
100.0
99.4
5.2
6.6
20.8
15.2
100.0
DEMO
2.8
14.2
16.6
25.8
99.8
99.6
2.6
30.0
15.2
41.8
ax.01
power
88.2
86.4
3.0
2.0
2.4
2.8
98.0
98.2
1.6
1.0
10.2
3.2
DEMO
99.6
0.0
1.8
7.8
5.8
99.8
99.0
0.0
6.6
9.6
15.0
Downloaded By: [University of Toronto] At: 02:09 24 May 2010
HOSMER AND LEMESHOV
5. DISCVSSION
The following has been learned through the DEMO experi-
ments described in Sections 3 and 4.
a. When the logistic nodel holds, each of the test statis-
tics fi n,-%, DEMO H:, H* C* and 2r C* appears to have sampling distribu-
g' '9' a fi' g fi
tions which are well DEMO by a chi-square distribution.
'%
';he statistics H although based DEMO the assum-
g and H &'
is normally distributed within
b.
ption that 2 each of the outcome
groups, appear to be robust when this assumption does not hold.
e. The statistics which demonstrated the DEMO power under
%
a variety of alternative models (with p=l) were H and H with
& g
g in all cases considered.
H~ DEMO slightly better power than
D *u
The statistics C* and C* were not sensitive to the linear and
g g
normal and slightly sensitive DEMO the exponential alternative
models.
In conclusion, this research has identified the DEMO
as the most viable candidates for testing goodness
the logistic regression model although all statistics
considered should be scudied under other distributional
conditions.
'L
H and Ii
g g
of fit of
The authors would like DEMO give special thanks to Dr.
Stuart C. Hartz for his helpful suggestions and valuable insights
into this problem. In addition, thanks are given to Dr. Ram
Dahiya, Dr. Lloyd Fisher and Dr. Mark Durst for helpful conver-
sations during the theoretical development. The extensive
simulations were made possible DEMO a grant from the University
of Massachusetts Academic Computing Center.
Afifi, DEMO, and Azen, S.P. (1979). Statistical Analysis: A
Computer Oriented Approach, Second Edition, New York:
Academic Press.
Downloaded By: [University of Toronto] At: 02:09 24 May 2010
WXTIPLE LOGISTIC REGRESSION YODEL 1069
Chernoff, H. and Lehmann, E. (1954). The use of naximum like-
lihood estimates in chi-square tests for DEMO of fit.
Annals of Xathematical Statistics, 25. pp. 579-86.
Durst, Hark. (19 79). Personal communication, unpubl ished
doctoral dissertation, ?.!athematics DEMO, Y.1.1.
Truett, J., Cornfield, J. and Kannel, [?. (1967). A multi-
variate analysis of the risk of coronary heart DEMO in
Framingham, J. Chron. Dis., E, 511-524.
Watson, G.S. (DEMO). Some recent results in chi-square good-
ness of fit tests, DEMO, 15, pp. 440-46s.
i7ecelved September, 1979; Revised December, 1979.
DEMO by D. 5. .Yoore, Purdue 'Jniversi ty, W. Lafaqette, IN.
Efron, B. (1975). The efficiency of logistic regression
compared to DEMO discriminant analysis. 2:. -her. Stat.
- 70, pp. 892-898.
Balperin, Y., Blackwelder, W.C., Verter, J.I. (1971). Esti-
mation of the multivariate logistic risk function: a
comparison of the discriminant function and naximum like-
lihood approaches, J. Chron. Dis,, %, pp. 125-158.
DEMO, S. C., Rosenberg, L.A. (1975). The compr::ation DEMO maxi-
mum likelihood estimates for the multiple logistic risk
function for use with categorical data, J. Chron-g.,
- pp. 421-429.
Heinonen, D.P., Slone, D., and Shapiro, S. (1977). Birth
Defects and DEMO in Pregnarxy, Publishing Sciences Group.
Inc. Littleton, Mass.
Assoc.,
28,
Xoore, D.S. (1971). A chi-square statistic with randon cell
DEMO Annals of Hathematical Statistics, $2, pp. 1i7-
156.
?loore, D.S. and Spruill, F1.C. (1975). Unified large-sam~le
theory of general chi-squared DEMO for tests of fit.
Annals of Statistics, 2, pp. 599-616.
Shillington, E.R. (1978). X chi-square goodness of fit test
for logistic DEMO, presented at the Annual Neeting of the
American Statistical Association. San DEMO, California,
August, 1978.
pp.
Downloaded By: [University of Toronto] DEMO: 02:09 24 May 2010{1g42fwefx}